var Em=Object.defineProperty;var Sm=(t,e,n)=>e in t?Em(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var xn=(t,e,n)=>(Sm(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function lc(t,e){const n=new Set(t.split(","));return e?r=>n.has(r.toLowerCase()):r=>n.has(r)}const Ae={},Lr=[],St=()=>{},Am=()=>!1,no=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),dc=t=>t.startsWith("onUpdate:"),Ze=Object.assign,fc=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},xm=Object.prototype.hasOwnProperty,ce=(t,e)=>xm.call(t,e),J=Array.isArray,Mr=t=>ro(t)==="[object Map]",Sf=t=>ro(t)==="[object Set]",Q=t=>typeof t=="function",Le=t=>typeof t=="string",wr=t=>typeof t=="symbol",Re=t=>t!==null&&typeof t=="object",Af=t=>(Re(t)||Q(t))&&Q(t.then)&&Q(t.catch),xf=Object.prototype.toString,ro=t=>xf.call(t),Om=t=>ro(t).slice(8,-1),Of=t=>ro(t)==="[object Object]",hc=t=>Le(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Os=lc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),so=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Pm=/-(\w)/g,sn=so(t=>t.replace(Pm,(e,n)=>n?n.toUpperCase():"")),Rm=/\B([A-Z])/g,rs=so(t=>t.replace(Rm,"-$1").toLowerCase()),io=so(t=>t.charAt(0).toUpperCase()+t.slice(1)),Fo=so(t=>t?`on${io(t)}`:""),qn=(t,e)=>!Object.is(t,e),ji=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Pf=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},gu=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let El;const Rf=()=>El||(El=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pc(t){if(J(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=Le(r)?Im(r):pc(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(Le(t)||Re(t))return t}const Cm=/;(?![^(]*\))/g,Tm=/:([^]+)/,km=/\/\*[^]*?\*\//g;function Im(t){const e={};return t.replace(km,"").split(Cm).forEach(n=>{if(n){const r=n.split(Tm);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Kr(t){let e="";if(Le(t))e=t;else if(J(t))for(let n=0;n<t.length;n++){const r=Kr(t[n]);r&&(e+=r+" ")}else if(Re(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Nm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",$m=lc(Nm);function Cf(t){return!!t||t===""}const Ne=t=>Le(t)?t:t==null?"":J(t)||Re(t)&&(t.toString===xf||!Q(t.toString))?JSON.stringify(t,Tf,2):String(t),Tf=(t,e)=>e&&e.__v_isRef?Tf(t,e.value):Mr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s],i)=>(n[Bo(r,i)+" =>"]=s,n),{})}:Sf(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Bo(n))}:wr(e)?Bo(e):Re(e)&&!J(e)&&!Of(e)?String(e):e,Bo=(t,e="")=>{var n;return wr(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let _t;class kf{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=_t,!e&&_t&&(this.index=(_t.scopes||(_t.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=_t;try{return _t=this,e()}finally{_t=n}}}on(){_t=this}off(){_t=this.parent}stop(e){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function If(t){return new kf(t)}function jm(t,e=_t){e&&e.active&&e.effects.push(t)}function Nf(){return _t}function Lm(t){_t&&_t.cleanups.push(t)}let ur;class mc{constructor(e,n,r,s){this.fn=e,this.trigger=n,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,jm(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Wn();for(let e=0;e<this._depsLength;e++){const n=this.deps[e];if(n.computed&&(Mm(n.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Jn()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Fn,n=ur;try{return Fn=!0,ur=this,this._runnings++,Sl(this),this.fn()}finally{Al(this),this._runnings--,ur=n,Fn=e}}stop(){var e;this.active&&(Sl(this),Al(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function Mm(t){return t.value}function Sl(t){t._trackId++,t._depsLength=0}function Al(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)$f(t.deps[e],t);t.deps.length=t._depsLength}}function $f(t,e){const n=t.get(e);n!==void 0&&e._trackId!==n&&(t.delete(e),t.size===0&&t.cleanup())}let Fn=!0,yu=0;const jf=[];function Wn(){jf.push(Fn),Fn=!1}function Jn(){const t=jf.pop();Fn=t===void 0?!0:t}function gc(){yu++}function yc(){for(yu--;!yu&&_u.length;)_u.shift()()}function Lf(t,e,n){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const r=t.deps[t._depsLength];r!==e?(r&&$f(r,t),t.deps[t._depsLength++]=e):t._depsLength++}}const _u=[];function Mf(t,e,n){gc();for(const r of t.keys()){let s;r._dirtyLevel<e&&(s??(s=t.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=e),r._shouldSchedule&&(s??(s=t.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&_u.push(r.scheduler)))}yc()}const Df=(t,e)=>{const n=new Map;return n.cleanup=t,n.computed=e,n},ia=new WeakMap,cr=Symbol(""),bu=Symbol("");function ft(t,e,n){if(Fn&&ur){let r=ia.get(t);r||ia.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=Df(()=>r.delete(n))),Lf(ur,s)}}function gn(t,e,n,r,s,i){const a=ia.get(t);if(!a)return;let o=[];if(e==="clear")o=[...a.values()];else if(n==="length"&&J(t)){const u=Number(r);a.forEach((c,l)=>{(l==="length"||!wr(l)&&l>=u)&&o.push(c)})}else switch(n!==void 0&&o.push(a.get(n)),e){case"add":J(t)?hc(n)&&o.push(a.get("length")):(o.push(a.get(cr)),Mr(t)&&o.push(a.get(bu)));break;case"delete":J(t)||(o.push(a.get(cr)),Mr(t)&&o.push(a.get(bu)));break;case"set":Mr(t)&&o.push(a.get(cr));break}gc();for(const u of o)u&&Mf(u,4);yc()}function Dm(t,e){var n;return(n=ia.get(t))==null?void 0:n.get(e)}const Fm=lc("__proto__,__v_isRef,__isVue"),Ff=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(wr)),xl=Bm();function Bm(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=le(this);for(let i=0,a=this.length;i<a;i++)ft(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(le)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Wn(),gc();const r=le(this)[e].apply(this,n);return yc(),Jn(),r}}),t}function Um(t){wr(t)||(t=String(t));const e=le(this);return ft(e,"has",t),e.hasOwnProperty(t)}class Bf{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?eg:zf:i?Hf:qf).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const a=J(e);if(!s){if(a&&ce(xl,n))return Reflect.get(xl,n,r);if(n==="hasOwnProperty")return Um}const o=Reflect.get(e,n,r);return(wr(n)?Ff.has(n):Fm(n))||(s||ft(e,"get",n),i)?o:Me(o)?a&&hc(n)?o:o.value:Re(o)?s?Zf(o):ui(o):o}}class Uf extends Bf{constructor(e=!1){super(!1,e)}set(e,n,r,s){let i=e[n];if(!this._isShallow){const u=Ms(i);if(!aa(r)&&!Ms(r)&&(i=le(i),r=le(r)),!J(e)&&Me(i)&&!Me(r))return u?!1:(i.value=r,!0)}const a=J(e)&&hc(n)?Number(n)<e.length:ce(e,n),o=Reflect.set(e,n,r,s);return e===le(s)&&(a?qn(r,i)&&gn(e,"set",n,r):gn(e,"add",n,r)),o}deleteProperty(e,n){const r=ce(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&gn(e,"delete",n,void 0),s}has(e,n){const r=Reflect.has(e,n);return(!wr(n)||!Ff.has(n))&&ft(e,"has",n),r}ownKeys(e){return ft(e,"iterate",J(e)?"length":cr),Reflect.ownKeys(e)}}class qm extends Bf{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Hm=new Uf,zm=new qm,Vm=new Uf(!0),_c=t=>t,ao=t=>Reflect.getPrototypeOf(t);function Ei(t,e,n=!1,r=!1){t=t.__v_raw;const s=le(t),i=le(e);n||(qn(e,i)&&ft(s,"get",e),ft(s,"get",i));const{has:a}=ao(s),o=r?_c:n?Ec:Ds;if(a.call(s,e))return o(t.get(e));if(a.call(s,i))return o(t.get(i));t!==s&&t.get(e)}function Si(t,e=!1){const n=this.__v_raw,r=le(n),s=le(t);return e||(qn(t,s)&&ft(r,"has",t),ft(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Ai(t,e=!1){return t=t.__v_raw,!e&&ft(le(t),"iterate",cr),Reflect.get(t,"size",t)}function Ol(t){t=le(t);const e=le(this);return ao(e).has.call(e,t)||(e.add(t),gn(e,"add",t,t)),this}function Pl(t,e){e=le(e);const n=le(this),{has:r,get:s}=ao(n);let i=r.call(n,t);i||(t=le(t),i=r.call(n,t));const a=s.call(n,t);return n.set(t,e),i?qn(e,a)&&gn(n,"set",t,e):gn(n,"add",t,e),this}function Rl(t){const e=le(this),{has:n,get:r}=ao(e);let s=n.call(e,t);s||(t=le(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&gn(e,"delete",t,void 0),i}function Cl(){const t=le(this),e=t.size!==0,n=t.clear();return e&&gn(t,"clear",void 0,void 0),n}function xi(t,e){return function(r,s){const i=this,a=i.__v_raw,o=le(a),u=e?_c:t?Ec:Ds;return!t&&ft(o,"iterate",cr),a.forEach((c,l)=>r.call(s,u(c),u(l),i))}}function Oi(t,e,n){return function(...r){const s=this.__v_raw,i=le(s),a=Mr(i),o=t==="entries"||t===Symbol.iterator&&a,u=t==="keys"&&a,c=s[t](...r),l=n?_c:e?Ec:Ds;return!e&&ft(i,"iterate",u?bu:cr),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:o?[l(d[0]),l(d[1])]:l(d),done:f}},[Symbol.iterator](){return this}}}}function On(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Zm(){const t={get(i){return Ei(this,i)},get size(){return Ai(this)},has:Si,add:Ol,set:Pl,delete:Rl,clear:Cl,forEach:xi(!1,!1)},e={get(i){return Ei(this,i,!1,!0)},get size(){return Ai(this)},has:Si,add:Ol,set:Pl,delete:Rl,clear:Cl,forEach:xi(!1,!0)},n={get(i){return Ei(this,i,!0)},get size(){return Ai(this,!0)},has(i){return Si.call(this,i,!0)},add:On("add"),set:On("set"),delete:On("delete"),clear:On("clear"),forEach:xi(!0,!1)},r={get(i){return Ei(this,i,!0,!0)},get size(){return Ai(this,!0)},has(i){return Si.call(this,i,!0)},add:On("add"),set:On("set"),delete:On("delete"),clear:On("clear"),forEach:xi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Oi(i,!1,!1),n[i]=Oi(i,!0,!1),e[i]=Oi(i,!1,!0),r[i]=Oi(i,!0,!0)}),[t,n,e,r]}const[Wm,Jm,Km,Gm]=Zm();function bc(t,e){const n=e?t?Gm:Km:t?Jm:Wm;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(ce(n,s)&&s in r?n:r,s,i)}const Xm={get:bc(!1,!1)},Ym={get:bc(!1,!0)},Qm={get:bc(!0,!1)},qf=new WeakMap,Hf=new WeakMap,zf=new WeakMap,eg=new WeakMap;function tg(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ng(t){return t.__v_skip||!Object.isExtensible(t)?0:tg(Om(t))}function ui(t){return Ms(t)?t:wc(t,!1,Hm,Xm,qf)}function Vf(t){return wc(t,!1,Vm,Ym,Hf)}function Zf(t){return wc(t,!0,zm,Qm,zf)}function wc(t,e,n,r,s){if(!Re(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const a=ng(t);if(a===0)return t;const o=new Proxy(t,a===2?r:n);return s.set(t,o),o}function lr(t){return Ms(t)?lr(t.__v_raw):!!(t&&t.__v_isReactive)}function Ms(t){return!!(t&&t.__v_isReadonly)}function aa(t){return!!(t&&t.__v_isShallow)}function Wf(t){return t?!!t.__v_raw:!1}function le(t){const e=t&&t.__v_raw;return e?le(e):t}function vc(t){return Object.isExtensible(t)&&Pf(t,"__v_skip",!0),t}const Ds=t=>Re(t)?ui(t):t,Ec=t=>Re(t)?Zf(t):t;class Jf{constructor(e,n,r,s){this.getter=e,this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new mc(()=>e(this._value),()=>Li(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=le(this);return(!e._cacheable||e.effect.dirty)&&qn(e._value,e._value=e.effect.run())&&Li(e,4),Kf(e),e.effect._dirtyLevel>=2&&Li(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function rg(t,e,n=!1){let r,s;const i=Q(t);return i?(r=t,s=St):(r=t.get,s=t.set),new Jf(r,s,i||!s,n)}function Kf(t){var e;Fn&&ur&&(t=le(t),Lf(ur,(e=t.dep)!=null?e:t.dep=Df(()=>t.dep=void 0,t instanceof Jf?t:void 0)))}function Li(t,e=4,n){t=le(t);const r=t.dep;r&&Mf(r,e)}function Me(t){return!!(t&&t.__v_isRef===!0)}function Sc(t){return Gf(t,!1)}function sg(t){return Gf(t,!0)}function Gf(t,e){return Me(t)?t:new ig(t,e)}class ig{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:le(e),this._value=n?e:Ds(e)}get value(){return Kf(this),this._value}set value(e){const n=this.__v_isShallow||aa(e)||Ms(e);e=n?e:le(e),qn(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:Ds(e),Li(this,4))}}function Dr(t){return Me(t)?t.value:t}const ag={get:(t,e,n)=>Dr(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return Me(s)&&!Me(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function Xf(t){return lr(t)?t:new Proxy(t,ag)}function og(t){const e=J(t)?new Array(t.length):{};for(const n in t)e[n]=cg(t,n);return e}class ug{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Dm(le(this._object),this._key)}}function cg(t,e,n){const r=t[e];return Me(r)?r:new ug(t,e,n)}/**
* @vue/runtime-core v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Bn(t,e,n,r){try{return r?t(...r):t()}catch(s){oo(s,e,n)}}function Mt(t,e,n,r){if(Q(t)){const s=Bn(t,e,n,r);return s&&Af(s)&&s.catch(i=>{oo(i,e,n)}),s}if(J(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Mt(t[i],e,n,r));return s}}function oo(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const a=e.proxy,o=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const c=i.ec;if(c){for(let l=0;l<c.length;l++)if(c[l](t,a,o)===!1)return}i=i.parent}const u=e.appContext.config.errorHandler;if(u){Wn(),Bn(u,null,10,[t,a,o]),Jn();return}}lg(t,n,s,r)}function lg(t,e,n,r=!0){console.error(t)}let Fs=!1,wu=!1;const Xe=[];let Xt=0;const Fr=[];let Nn=null,er=0;const Yf=Promise.resolve();let Ac=null;function xc(t){const e=Ac||Yf;return t?e.then(this?t.bind(this):t):e}function dg(t){let e=Xt+1,n=Xe.length;for(;e<n;){const r=e+n>>>1,s=Xe[r],i=Bs(s);i<t||i===t&&s.pre?e=r+1:n=r}return e}function Oc(t){(!Xe.length||!Xe.includes(t,Fs&&t.allowRecurse?Xt+1:Xt))&&(t.id==null?Xe.push(t):Xe.splice(dg(t.id),0,t),Qf())}function Qf(){!Fs&&!wu&&(wu=!0,Ac=Yf.then(th))}function fg(t){const e=Xe.indexOf(t);e>Xt&&Xe.splice(e,1)}function hg(t){J(t)?Fr.push(...t):(!Nn||!Nn.includes(t,t.allowRecurse?er+1:er))&&Fr.push(t),Qf()}function Tl(t,e,n=Fs?Xt+1:0){for(;n<Xe.length;n++){const r=Xe[n];if(r&&r.pre){if(t&&r.id!==t.uid)continue;Xe.splice(n,1),n--,r()}}}function eh(t){if(Fr.length){const e=[...new Set(Fr)].sort((n,r)=>Bs(n)-Bs(r));if(Fr.length=0,Nn){Nn.push(...e);return}for(Nn=e,er=0;er<Nn.length;er++)Nn[er]();Nn=null,er=0}}const Bs=t=>t.id==null?1/0:t.id,pg=(t,e)=>{const n=Bs(t)-Bs(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function th(t){wu=!1,Fs=!0,Xe.sort(pg);try{for(Xt=0;Xt<Xe.length;Xt++){const e=Xe[Xt];e&&e.active!==!1&&Bn(e,null,14)}}finally{Xt=0,Xe.length=0,eh(),Fs=!1,Ac=null,(Xe.length||Fr.length)&&th()}}function mg(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Ae;let s=n;const i=e.startsWith("update:"),a=i&&e.slice(7);if(a&&a in r){const l=`${a==="modelValue"?"model":a}Modifiers`,{number:d,trim:f}=r[l]||Ae;f&&(s=n.map(h=>Le(h)?h.trim():h)),d&&(s=n.map(gu))}let o,u=r[o=Fo(e)]||r[o=Fo(sn(e))];!u&&i&&(u=r[o=Fo(rs(e))]),u&&Mt(u,t,6,s);const c=r[o+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Mt(c,t,6,s)}}function nh(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let a={},o=!1;if(!Q(t)){const u=c=>{const l=nh(c,e,!0);l&&(o=!0,Ze(a,l))};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!i&&!o?(Re(t)&&r.set(t,null),null):(J(i)?i.forEach(u=>a[u]=null):Ze(a,i),Re(t)&&r.set(t,a),a)}function uo(t,e){return!t||!no(e)?!1:(e=e.slice(2).replace(/Once$/,""),ce(t,e[0].toLowerCase()+e.slice(1))||ce(t,rs(e))||ce(t,e))}let nt=null,co=null;function oa(t){const e=nt;return nt=t,co=t&&t.type.__scopeId||null,e}function ci(t){co=t}function li(){co=null}function nn(t,e=nt,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&Ul(-1);const i=oa(e);let a;try{a=t(...s)}finally{oa(i),r._d&&Ul(1)}return a};return r._n=!0,r._c=!0,r._d=!0,r}function Uo(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[a],slots:o,attrs:u,emit:c,render:l,renderCache:d,data:f,setupState:h,ctx:p,inheritAttrs:y}=t;let _,w;const v=oa(t);try{if(n.shapeFlag&4){const U=s||r,j=U;_=Kt(l.call(j,U,d,i,h,f,p)),w=u}else{const U=e;_=Kt(U.length>1?U(i,{attrs:u,slots:o,emit:c}):U(i,null)),w=e.props?u:gg(u)}}catch(U){Cs.length=0,oo(U,t,1),_=Ve(pr)}let O=_;if(w&&y!==!1){const U=Object.keys(w),{shapeFlag:j}=O;U.length&&j&7&&(a&&U.some(dc)&&(w=yg(w,a)),O=Gr(O,w))}return n.dirs&&(O=Gr(O),O.dirs=O.dirs?O.dirs.concat(n.dirs):n.dirs),n.transition&&(O.transition=n.transition),_=O,oa(v),_}const gg=t=>{let e;for(const n in t)(n==="class"||n==="style"||no(n))&&((e||(e={}))[n]=t[n]);return e},yg=(t,e)=>{const n={};for(const r in t)(!dc(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function _g(t,e,n){const{props:r,children:s,component:i}=t,{props:a,children:o,patchFlag:u}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return r?kl(r,a,c):!!a;if(u&8){const l=e.dynamicProps;for(let d=0;d<l.length;d++){const f=l[d];if(a[f]!==r[f]&&!uo(c,f))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:r===a?!1:r?a?kl(r,a,c):!0:!!a;return!1}function kl(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!uo(n,i))return!0}return!1}function bg({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const rh="components";function Hn(t,e){return vg(rh,t,!0,e)||t}const wg=Symbol.for("v-ndc");function vg(t,e,n=!0,r=!1){const s=nt||He;if(s){const i=s.type;if(t===rh){const o=my(i,!1);if(o&&(o===e||o===sn(e)||o===io(sn(e))))return i}const a=Il(s[t]||i[t],e)||Il(s.appContext[t],e);return!a&&r?i:a}}function Il(t,e){return t&&(t[e]||t[sn(e)]||t[io(sn(e))])}const Eg=t=>t.__isSuspense;function Sg(t,e){e&&e.pendingBranch?J(t)?e.effects.push(...t):e.effects.push(t):hg(t)}const Ag=Symbol.for("v-scx"),xg=()=>rn(Ag),Pi={};function Ps(t,e,n){return sh(t,e,n)}function sh(t,e,{immediate:n,deep:r,flush:s,once:i,onTrack:a,onTrigger:o}=Ae){if(e&&i){const B=e;e=(...te)=>{B(...te),j()}}const u=He,c=B=>r===!0?B:sr(B,r===!1?1:void 0);let l,d=!1,f=!1;if(Me(t)?(l=()=>t.value,d=aa(t)):lr(t)?(l=()=>c(t),d=!0):J(t)?(f=!0,d=t.some(B=>lr(B)||aa(B)),l=()=>t.map(B=>{if(Me(B))return B.value;if(lr(B))return c(B);if(Q(B))return Bn(B,u,2)})):Q(t)?e?l=()=>Bn(t,u,2):l=()=>(h&&h(),Mt(t,u,3,[p])):l=St,e&&r){const B=l;l=()=>sr(B())}let h,p=B=>{h=O.onStop=()=>{Bn(B,u,4),h=O.onStop=void 0}},y;if(ho)if(p=St,e?n&&Mt(e,u,3,[l(),f?[]:void 0,p]):l(),s==="sync"){const B=xg();y=B.__watcherHandles||(B.__watcherHandles=[])}else return St;let _=f?new Array(t.length).fill(Pi):Pi;const w=()=>{if(!(!O.active||!O.dirty))if(e){const B=O.run();(r||d||(f?B.some((te,K)=>qn(te,_[K])):qn(B,_)))&&(h&&h(),Mt(e,u,3,[B,_===Pi?void 0:f&&_[0]===Pi?[]:_,p]),_=B)}else O.run()};w.allowRecurse=!!e;let v;s==="sync"?v=w:s==="post"?v=()=>ot(w,u&&u.suspense):(w.pre=!0,u&&(w.id=u.uid),v=()=>Oc(w));const O=new mc(l,St,v),U=Nf(),j=()=>{O.stop(),U&&fc(U.effects,O)};return e?n?w():_=O.run():s==="post"?ot(O.run.bind(O),u&&u.suspense):O.run(),y&&y.push(j),j}function Og(t,e,n){const r=this.proxy,s=Le(t)?t.includes(".")?ih(r,t):()=>r[t]:t.bind(r,r);let i;Q(e)?i=e:(i=e.handler,n=e);const a=di(this),o=sh(s,i.bind(r),n);return a(),o}function ih(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function sr(t,e,n=0,r){if(!Re(t)||t.__v_skip)return t;if(e&&e>0){if(n>=e)return t;n++}if(r=r||new Set,r.has(t))return t;if(r.add(t),Me(t))sr(t.value,e,n,r);else if(J(t))for(let s=0;s<t.length;s++)sr(t[s],e,n,r);else if(Sf(t)||Mr(t))t.forEach(s=>{sr(s,e,n,r)});else if(Of(t))for(const s in t)sr(t[s],e,n,r);return t}function Br(t,e){if(nt===null)return t;const n=po(nt)||nt.proxy,r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,o,u=Ae]=e[s];i&&(Q(i)&&(i={mounted:i,updated:i}),i.deep&&sr(a),r.push({dir:i,instance:n,value:a,oldValue:void 0,arg:o,modifiers:u}))}return t}function Xn(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let u=o.dir[r];u&&(Wn(),Mt(u,n,8,[t.el,o,t,e]),Jn())}}/*! #__NO_SIDE_EFFECTS__ */function En(t,e){return Q(t)?Ze({name:t.name},e,{setup:t}):t}const Mi=t=>!!t.type.__asyncLoader,ah=t=>t.type.__isKeepAlive;function Pg(t,e){oh(t,"a",e)}function Rg(t,e){oh(t,"da",e)}function oh(t,e,n=He){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(lo(e,r,n),n){let s=n.parent;for(;s&&s.parent;)ah(s.parent.vnode)&&Cg(r,e,n,s),s=s.parent}}function Cg(t,e,n,r){const s=lo(e,t,r,!0);uh(()=>{fc(r[e],s)},n)}function lo(t,e,n=He,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...a)=>{if(n.isUnmounted)return;Wn();const o=di(n),u=Mt(e,n,t,a);return o(),Jn(),u});return r?s.unshift(i):s.push(i),i}}const Sn=t=>(e,n=He)=>(!ho||t==="sp")&&lo(t,(...r)=>e(...r),n),Tg=Sn("bm"),kg=Sn("m"),Ig=Sn("bu"),Ng=Sn("u"),$g=Sn("bum"),uh=Sn("um"),jg=Sn("sp"),Lg=Sn("rtg"),Mg=Sn("rtc");function Dg(t,e=He){lo("ec",t,e)}function mn(t,e,n,r){let s;const i=n&&n[r];if(J(t)||Le(t)){s=new Array(t.length);for(let a=0,o=t.length;a<o;a++)s[a]=e(t[a],a,void 0,i&&i[a])}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,i&&i[a])}else if(Re(t))if(t[Symbol.iterator])s=Array.from(t,(a,o)=>e(a,o,void 0,i&&i[o]));else{const a=Object.keys(t);s=new Array(a.length);for(let o=0,u=a.length;o<u;o++){const c=a[o];s[o]=e(t[c],c,o,i&&i[o])}}else s=[];return n&&(n[r]=s),s}const vu=t=>t?Eh(t)?po(t)||t.proxy:vu(t.parent):null,Rs=Ze(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>vu(t.parent),$root:t=>vu(t.root),$emit:t=>t.emit,$options:t=>Pc(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,Oc(t.update)}),$nextTick:t=>t.n||(t.n=xc.bind(t.proxy)),$watch:t=>Og.bind(t)}),qo=(t,e)=>t!==Ae&&!t.__isScriptSetup&&ce(t,e),Fg={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:a,type:o,appContext:u}=t;let c;if(e[0]!=="$"){const h=a[e];if(h!==void 0)switch(h){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(qo(r,e))return a[e]=1,r[e];if(s!==Ae&&ce(s,e))return a[e]=2,s[e];if((c=t.propsOptions[0])&&ce(c,e))return a[e]=3,i[e];if(n!==Ae&&ce(n,e))return a[e]=4,n[e];Eu&&(a[e]=0)}}const l=Rs[e];let d,f;if(l)return e==="$attrs"&&ft(t.attrs,"get",""),l(t);if((d=o.__cssModules)&&(d=d[e]))return d;if(n!==Ae&&ce(n,e))return a[e]=4,n[e];if(f=u.config.globalProperties,ce(f,e))return f[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return qo(s,e)?(s[e]=n,!0):r!==Ae&&ce(r,e)?(r[e]=n,!0):ce(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},a){let o;return!!n[a]||t!==Ae&&ce(t,a)||qo(e,a)||(o=i[0])&&ce(o,a)||ce(r,a)||ce(Rs,a)||ce(s.config.globalProperties,a)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ce(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Nl(t){return J(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Eu=!0;function Bg(t){const e=Pc(t),n=t.proxy,r=t.ctx;Eu=!1,e.beforeCreate&&$l(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:a,watch:o,provide:u,inject:c,created:l,beforeMount:d,mounted:f,beforeUpdate:h,updated:p,activated:y,deactivated:_,beforeDestroy:w,beforeUnmount:v,destroyed:O,unmounted:U,render:j,renderTracked:B,renderTriggered:te,errorCaptured:K,serverPrefetch:z,expose:Se,inheritAttrs:We,components:pt,directives:wt,filters:Gn}=e;if(c&&Ug(c,r,null),a)for(const _e in a){const pe=a[_e];Q(pe)&&(r[_e]=pe.bind(n))}if(s){const _e=s.call(n,n);Re(_e)&&(t.data=ui(_e))}if(Eu=!0,i)for(const _e in i){const pe=i[_e],cn=Q(pe)?pe.bind(n,n):Q(pe.get)?pe.get.bind(n,n):St,An=!Q(pe)&&Q(pe.set)?pe.set.bind(n):St,zt=xe({get:cn,set:An});Object.defineProperty(r,_e,{enumerable:!0,configurable:!0,get:()=>zt.value,set:it=>zt.value=it})}if(o)for(const _e in o)ch(o[_e],r,n,_e);if(u){const _e=Q(u)?u.call(n):u;Reflect.ownKeys(_e).forEach(pe=>{Di(pe,_e[pe])})}l&&$l(l,t,"c");function he(_e,pe){J(pe)?pe.forEach(cn=>_e(cn.bind(n))):pe&&_e(pe.bind(n))}if(he(Tg,d),he(kg,f),he(Ig,h),he(Ng,p),he(Pg,y),he(Rg,_),he(Dg,K),he(Mg,B),he(Lg,te),he($g,v),he(uh,U),he(jg,z),J(Se))if(Se.length){const _e=t.exposed||(t.exposed={});Se.forEach(pe=>{Object.defineProperty(_e,pe,{get:()=>n[pe],set:cn=>n[pe]=cn})})}else t.exposed||(t.exposed={});j&&t.render===St&&(t.render=j),We!=null&&(t.inheritAttrs=We),pt&&(t.components=pt),wt&&(t.directives=wt)}function Ug(t,e,n=St){J(t)&&(t=Su(t));for(const r in t){const s=t[r];let i;Re(s)?"default"in s?i=rn(s.from||r,s.default,!0):i=rn(s.from||r):i=rn(s),Me(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[r]=i}}function $l(t,e,n){Mt(J(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function ch(t,e,n,r){const s=r.includes(".")?ih(n,r):()=>n[r];if(Le(t)){const i=e[t];Q(i)&&Ps(s,i)}else if(Q(t))Ps(s,t.bind(n));else if(Re(t))if(J(t))t.forEach(i=>ch(i,e,n,r));else{const i=Q(t.handler)?t.handler.bind(n):e[t.handler];Q(i)&&Ps(s,i,t)}}function Pc(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=t.appContext,o=i.get(e);let u;return o?u=o:!s.length&&!n&&!r?u=e:(u={},s.length&&s.forEach(c=>ua(u,c,a,!0)),ua(u,e,a)),Re(e)&&i.set(e,u),u}function ua(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&ua(t,i,n,!0),s&&s.forEach(a=>ua(t,a,n,!0));for(const a in e)if(!(r&&a==="expose")){const o=qg[a]||n&&n[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const qg={data:jl,props:Ll,emits:Ll,methods:ps,computed:ps,beforeCreate:tt,created:tt,beforeMount:tt,mounted:tt,beforeUpdate:tt,updated:tt,beforeDestroy:tt,beforeUnmount:tt,destroyed:tt,unmounted:tt,activated:tt,deactivated:tt,errorCaptured:tt,serverPrefetch:tt,components:ps,directives:ps,watch:zg,provide:jl,inject:Hg};function jl(t,e){return e?t?function(){return Ze(Q(t)?t.call(this,this):t,Q(e)?e.call(this,this):e)}:e:t}function Hg(t,e){return ps(Su(t),Su(e))}function Su(t){if(J(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function tt(t,e){return t?[...new Set([].concat(t,e))]:e}function ps(t,e){return t?Ze(Object.create(null),t,e):e}function Ll(t,e){return t?J(t)&&J(e)?[...new Set([...t,...e])]:Ze(Object.create(null),Nl(t),Nl(e??{})):e}function zg(t,e){if(!t)return e;if(!e)return t;const n=Ze(Object.create(null),t);for(const r in e)n[r]=tt(t[r],e[r]);return n}function lh(){return{app:null,config:{isNativeTag:Am,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vg=0;function Zg(t,e){return function(r,s=null){Q(r)||(r=Ze({},r)),s!=null&&!Re(s)&&(s=null);const i=lh(),a=new WeakSet;let o=!1;const u=i.app={_uid:Vg++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:yy,get config(){return i.config},set config(c){},use(c,...l){return a.has(c)||(c&&Q(c.install)?(a.add(c),c.install(u,...l)):Q(c)&&(a.add(c),c(u,...l))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,l){return l?(i.components[c]=l,u):i.components[c]},directive(c,l){return l?(i.directives[c]=l,u):i.directives[c]},mount(c,l,d){if(!o){const f=Ve(r,s);return f.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),l&&e?e(f,c):t(f,c,d),o=!0,u._container=c,c.__vue_app__=u,po(f.component)||f.component.proxy}},unmount(){o&&(t(null,u._container),delete u._container.__vue_app__)},provide(c,l){return i.provides[c]=l,u},runWithContext(c){const l=Ur;Ur=u;try{return c()}finally{Ur=l}}};return u}}let Ur=null;function Di(t,e){if(He){let n=He.provides;const r=He.parent&&He.parent.provides;r===n&&(n=He.provides=Object.create(r)),n[t]=e}}function rn(t,e,n=!1){const r=He||nt;if(r||Ur){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Ur._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&Q(e)?e.call(r&&r.proxy):e}}function Wg(){return!!(He||nt||Ur)}const dh=Object.create(null),Au=()=>Object.create(dh),fh=t=>Object.getPrototypeOf(t)===dh;function Jg(t,e,n,r=!1){const s={},i=Au();t.propsDefaults=Object.create(null),hh(t,e,s,i);for(const a in t.propsOptions[0])a in s||(s[a]=void 0);n?t.props=r?s:Vf(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function Kg(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:a}}=t,o=le(s),[u]=t.propsOptions;let c=!1;if((r||a>0)&&!(a&16)){if(a&8){const l=t.vnode.dynamicProps;for(let d=0;d<l.length;d++){let f=l[d];if(uo(t.emitsOptions,f))continue;const h=e[f];if(u)if(ce(i,f))h!==i[f]&&(i[f]=h,c=!0);else{const p=sn(f);s[p]=xu(u,o,p,h,t,!1)}else h!==i[f]&&(i[f]=h,c=!0)}}}else{hh(t,e,s,i)&&(c=!0);let l;for(const d in o)(!e||!ce(e,d)&&((l=rs(d))===d||!ce(e,l)))&&(u?n&&(n[d]!==void 0||n[l]!==void 0)&&(s[d]=xu(u,o,d,void 0,t,!0)):delete s[d]);if(i!==o)for(const d in i)(!e||!ce(e,d))&&(delete i[d],c=!0)}c&&gn(t.attrs,"set","")}function hh(t,e,n,r){const[s,i]=t.propsOptions;let a=!1,o;if(e)for(let u in e){if(Os(u))continue;const c=e[u];let l;s&&ce(s,l=sn(u))?!i||!i.includes(l)?n[l]=c:(o||(o={}))[l]=c:uo(t.emitsOptions,u)||(!(u in r)||c!==r[u])&&(r[u]=c,a=!0)}if(i){const u=le(n),c=o||Ae;for(let l=0;l<i.length;l++){const d=i[l];n[d]=xu(s,u,d,c[d],t,!ce(c,d))}}return a}function xu(t,e,n,r,s,i){const a=t[n];if(a!=null){const o=ce(a,"default");if(o&&r===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&Q(u)){const{propsDefaults:c}=s;if(n in c)r=c[n];else{const l=di(s);r=c[n]=u.call(null,e),l()}}else r=u}a[0]&&(i&&!o?r=!1:a[1]&&(r===""||r===rs(n))&&(r=!0))}return r}function ph(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,a={},o=[];let u=!1;if(!Q(t)){const l=d=>{u=!0;const[f,h]=ph(d,e,!0);Ze(a,f),h&&o.push(...h)};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!u)return Re(t)&&r.set(t,Lr),Lr;if(J(i))for(let l=0;l<i.length;l++){const d=sn(i[l]);Ml(d)&&(a[d]=Ae)}else if(i)for(const l in i){const d=sn(l);if(Ml(d)){const f=i[l],h=a[d]=J(f)||Q(f)?{type:f}:Ze({},f);if(h){const p=Bl(Boolean,h.type),y=Bl(String,h.type);h[0]=p>-1,h[1]=y<0||p<y,(p>-1||ce(h,"default"))&&o.push(d)}}}const c=[a,o];return Re(t)&&r.set(t,c),c}function Ml(t){return t[0]!=="$"&&!Os(t)}function Dl(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function Fl(t,e){return Dl(t)===Dl(e)}function Bl(t,e){return J(e)?e.findIndex(n=>Fl(n,t)):Q(e)&&Fl(e,t)?0:-1}const mh=t=>t[0]==="_"||t==="$stable",Rc=t=>J(t)?t.map(Kt):[Kt(t)],Gg=(t,e,n)=>{if(e._n)return e;const r=nn((...s)=>Rc(e(...s)),n);return r._c=!1,r},gh=(t,e,n)=>{const r=t._ctx;for(const s in t){if(mh(s))continue;const i=t[s];if(Q(i))e[s]=Gg(s,i,r);else if(i!=null){const a=Rc(i);e[s]=()=>a}}},yh=(t,e)=>{const n=Rc(e);t.slots.default=()=>n},Xg=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=le(e),Pf(t.slots,"_",n)):gh(e,t.slots=Au())}else t.slots=Au(),e&&yh(t,e)},Yg=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,a=Ae;if(r.shapeFlag&32){const o=e._;o?n&&o===1?i=!1:(Ze(s,e),!n&&o===1&&delete s._):(i=!e.$stable,gh(e,s)),a=e}else e&&(yh(t,e),a={default:1});if(i)for(const o in s)!mh(o)&&a[o]==null&&delete s[o]};function Ou(t,e,n,r,s=!1){if(J(t)){t.forEach((f,h)=>Ou(f,e&&(J(e)?e[h]:e),n,r,s));return}if(Mi(r)&&!s)return;const i=r.shapeFlag&4?po(r.component)||r.component.proxy:r.el,a=s?null:i,{i:o,r:u}=t,c=e&&e.r,l=o.refs===Ae?o.refs={}:o.refs,d=o.setupState;if(c!=null&&c!==u&&(Le(c)?(l[c]=null,ce(d,c)&&(d[c]=null)):Me(c)&&(c.value=null)),Q(u))Bn(u,o,12,[a,l]);else{const f=Le(u),h=Me(u);if(f||h){const p=()=>{if(t.f){const y=f?ce(d,u)?d[u]:l[u]:u.value;s?J(y)&&fc(y,i):J(y)?y.includes(i)||y.push(i):f?(l[u]=[i],ce(d,u)&&(d[u]=l[u])):(u.value=[i],t.k&&(l[t.k]=u.value))}else f?(l[u]=a,ce(d,u)&&(d[u]=a)):h&&(u.value=a,t.k&&(l[t.k]=a))};a?(p.id=-1,ot(p,n)):p()}}}const ot=Sg;function Qg(t){return ey(t)}function ey(t,e){const n=Rf();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:a,createText:o,createComment:u,setText:c,setElementText:l,parentNode:d,nextSibling:f,setScopeId:h=St,insertStaticContent:p}=t,y=(m,g,b,x=null,E=null,k=null,$=void 0,T=null,I=!!g.dynamicChildren)=>{if(m===g)return;m&&!ls(m,g)&&(x=A(m),it(m,E,k,!0),m=null),g.patchFlag===-2&&(I=!1,g.dynamicChildren=null);const{type:P,ref:F,shapeFlag:W}=g;switch(P){case fo:_(m,g,b,x);break;case pr:w(m,g,b,x);break;case zo:m==null&&v(g,b,x,$);break;case je:pt(m,g,b,x,E,k,$,T,I);break;default:W&1?j(m,g,b,x,E,k,$,T,I):W&6?wt(m,g,b,x,E,k,$,T,I):(W&64||W&128)&&P.process(m,g,b,x,E,k,$,T,I,q)}F!=null&&E&&Ou(F,m&&m.ref,k,g||m,!g)},_=(m,g,b,x)=>{if(m==null)r(g.el=o(g.children),b,x);else{const E=g.el=m.el;g.children!==m.children&&c(E,g.children)}},w=(m,g,b,x)=>{m==null?r(g.el=u(g.children||""),b,x):g.el=m.el},v=(m,g,b,x)=>{[m.el,m.anchor]=p(m.children,g,b,x,m.el,m.anchor)},O=({el:m,anchor:g},b,x)=>{let E;for(;m&&m!==g;)E=f(m),r(m,b,x),m=E;r(g,b,x)},U=({el:m,anchor:g})=>{let b;for(;m&&m!==g;)b=f(m),s(m),m=b;s(g)},j=(m,g,b,x,E,k,$,T,I)=>{g.type==="svg"?$="svg":g.type==="math"&&($="mathml"),m==null?B(g,b,x,E,k,$,T,I):z(m,g,E,k,$,T,I)},B=(m,g,b,x,E,k,$,T)=>{let I,P;const{props:F,shapeFlag:W,transition:V,dirs:G}=m;if(I=m.el=a(m.type,k,F&&F.is,F),W&8?l(I,m.children):W&16&&K(m.children,I,null,x,E,Ho(m,k),$,T),G&&Xn(m,null,x,"created"),te(I,m,m.scopeId,$,x),F){for(const be in F)be!=="value"&&!Os(be)&&i(I,be,null,F[be],k,m.children,x,E,Je);"value"in F&&i(I,"value",null,F.value,k),(P=F.onVnodeBeforeMount)&&Zt(P,x,m)}G&&Xn(m,null,x,"beforeMount");const ae=ty(E,V);ae&&V.beforeEnter(I),r(I,g,b),((P=F&&F.onVnodeMounted)||ae||G)&&ot(()=>{P&&Zt(P,x,m),ae&&V.enter(I),G&&Xn(m,null,x,"mounted")},E)},te=(m,g,b,x,E)=>{if(b&&h(m,b),x)for(let k=0;k<x.length;k++)h(m,x[k]);if(E){let k=E.subTree;if(g===k){const $=E.vnode;te(m,$,$.scopeId,$.slotScopeIds,E.parent)}}},K=(m,g,b,x,E,k,$,T,I=0)=>{for(let P=I;P<m.length;P++){const F=m[P]=T?$n(m[P]):Kt(m[P]);y(null,F,g,b,x,E,k,$,T)}},z=(m,g,b,x,E,k,$)=>{const T=g.el=m.el;let{patchFlag:I,dynamicChildren:P,dirs:F}=g;I|=m.patchFlag&16;const W=m.props||Ae,V=g.props||Ae;let G;if(b&&Yn(b,!1),(G=V.onVnodeBeforeUpdate)&&Zt(G,b,g,m),F&&Xn(g,m,b,"beforeUpdate"),b&&Yn(b,!0),P?Se(m.dynamicChildren,P,T,b,x,Ho(g,E),k):$||pe(m,g,T,null,b,x,Ho(g,E),k,!1),I>0){if(I&16)We(T,g,W,V,b,x,E);else if(I&2&&W.class!==V.class&&i(T,"class",null,V.class,E),I&4&&i(T,"style",W.style,V.style,E),I&8){const ae=g.dynamicProps;for(let be=0;be<ae.length;be++){const Pe=ae[be],De=W[Pe],Pt=V[Pe];(Pt!==De||Pe==="value")&&i(T,Pe,De,Pt,E,m.children,b,x,Je)}}I&1&&m.children!==g.children&&l(T,g.children)}else!$&&P==null&&We(T,g,W,V,b,x,E);((G=V.onVnodeUpdated)||F)&&ot(()=>{G&&Zt(G,b,g,m),F&&Xn(g,m,b,"updated")},x)},Se=(m,g,b,x,E,k,$)=>{for(let T=0;T<g.length;T++){const I=m[T],P=g[T],F=I.el&&(I.type===je||!ls(I,P)||I.shapeFlag&70)?d(I.el):b;y(I,P,F,null,x,E,k,$,!0)}},We=(m,g,b,x,E,k,$)=>{if(b!==x){if(b!==Ae)for(const T in b)!Os(T)&&!(T in x)&&i(m,T,b[T],null,$,g.children,E,k,Je);for(const T in x){if(Os(T))continue;const I=x[T],P=b[T];I!==P&&T!=="value"&&i(m,T,P,I,$,g.children,E,k,Je)}"value"in x&&i(m,"value",b.value,x.value,$)}},pt=(m,g,b,x,E,k,$,T,I)=>{const P=g.el=m?m.el:o(""),F=g.anchor=m?m.anchor:o("");let{patchFlag:W,dynamicChildren:V,slotScopeIds:G}=g;G&&(T=T?T.concat(G):G),m==null?(r(P,b,x),r(F,b,x),K(g.children||[],b,F,E,k,$,T,I)):W>0&&W&64&&V&&m.dynamicChildren?(Se(m.dynamicChildren,V,b,E,k,$,T),(g.key!=null||E&&g===E.subTree)&&_h(m,g,!0)):pe(m,g,b,F,E,k,$,T,I)},wt=(m,g,b,x,E,k,$,T,I)=>{g.slotScopeIds=T,m==null?g.shapeFlag&512?E.ctx.activate(g,b,x,$,I):Gn(g,b,x,E,k,$,I):vt(m,g,I)},Gn=(m,g,b,x,E,k,$)=>{const T=m.component=ly(m,x,E);if(ah(m)&&(T.ctx.renderer=q),dy(T),T.asyncDep){if(E&&E.registerDep(T,he),!m.el){const I=T.subTree=Ve(pr);w(null,I,g,b)}}else he(T,m,g,b,E,k,$)},vt=(m,g,b)=>{const x=g.component=m.component;if(_g(m,g,b))if(x.asyncDep&&!x.asyncResolved){_e(x,g,b);return}else x.next=g,fg(x.update),x.effect.dirty=!0,x.update();else g.el=m.el,x.vnode=g},he=(m,g,b,x,E,k,$)=>{const T=()=>{if(m.isMounted){let{next:F,bu:W,u:V,parent:G,vnode:ae}=m;{const Ar=bh(m);if(Ar){F&&(F.el=ae.el,_e(m,F,$)),Ar.asyncDep.then(()=>{m.isUnmounted||T()});return}}let be=F,Pe;Yn(m,!1),F?(F.el=ae.el,_e(m,F,$)):F=ae,W&&ji(W),(Pe=F.props&&F.props.onVnodeBeforeUpdate)&&Zt(Pe,G,F,ae),Yn(m,!0);const De=Uo(m),Pt=m.subTree;m.subTree=De,y(Pt,De,d(Pt.el),A(Pt),m,E,k),F.el=De.el,be===null&&bg(m,De.el),V&&ot(V,E),(Pe=F.props&&F.props.onVnodeUpdated)&&ot(()=>Zt(Pe,G,F,ae),E)}else{let F;const{el:W,props:V}=g,{bm:G,m:ae,parent:be}=m,Pe=Mi(g);if(Yn(m,!1),G&&ji(G),!Pe&&(F=V&&V.onVnodeBeforeMount)&&Zt(F,be,g),Yn(m,!0),W&&Oe){const De=()=>{m.subTree=Uo(m),Oe(W,m.subTree,m,E,null)};Pe?g.type.__asyncLoader().then(()=>!m.isUnmounted&&De()):De()}else{const De=m.subTree=Uo(m);y(null,De,b,x,m,E,k),g.el=De.el}if(ae&&ot(ae,E),!Pe&&(F=V&&V.onVnodeMounted)){const De=g;ot(()=>Zt(F,be,De),E)}(g.shapeFlag&256||be&&Mi(be.vnode)&&be.vnode.shapeFlag&256)&&m.a&&ot(m.a,E),m.isMounted=!0,g=b=x=null}},I=m.effect=new mc(T,St,()=>Oc(P),m.scope),P=m.update=()=>{I.dirty&&I.run()};P.id=m.uid,Yn(m,!0),P()},_e=(m,g,b)=>{g.component=m;const x=m.vnode.props;m.vnode=g,m.next=null,Kg(m,g.props,x,b),Yg(m,g.children,b),Wn(),Tl(m),Jn()},pe=(m,g,b,x,E,k,$,T,I=!1)=>{const P=m&&m.children,F=m?m.shapeFlag:0,W=g.children,{patchFlag:V,shapeFlag:G}=g;if(V>0){if(V&128){An(P,W,b,x,E,k,$,T,I);return}else if(V&256){cn(P,W,b,x,E,k,$,T,I);return}}G&8?(F&16&&Je(P,E,k),W!==P&&l(b,W)):F&16?G&16?An(P,W,b,x,E,k,$,T,I):Je(P,E,k,!0):(F&8&&l(b,""),G&16&&K(W,b,x,E,k,$,T,I))},cn=(m,g,b,x,E,k,$,T,I)=>{m=m||Lr,g=g||Lr;const P=m.length,F=g.length,W=Math.min(P,F);let V;for(V=0;V<W;V++){const G=g[V]=I?$n(g[V]):Kt(g[V]);y(m[V],G,b,null,E,k,$,T,I)}P>F?Je(m,E,k,!0,!1,W):K(g,b,x,E,k,$,T,I,W)},An=(m,g,b,x,E,k,$,T,I)=>{let P=0;const F=g.length;let W=m.length-1,V=F-1;for(;P<=W&&P<=V;){const G=m[P],ae=g[P]=I?$n(g[P]):Kt(g[P]);if(ls(G,ae))y(G,ae,b,null,E,k,$,T,I);else break;P++}for(;P<=W&&P<=V;){const G=m[W],ae=g[V]=I?$n(g[V]):Kt(g[V]);if(ls(G,ae))y(G,ae,b,null,E,k,$,T,I);else break;W--,V--}if(P>W){if(P<=V){const G=V+1,ae=G<F?g[G].el:x;for(;P<=V;)y(null,g[P]=I?$n(g[P]):Kt(g[P]),b,ae,E,k,$,T,I),P++}}else if(P>V)for(;P<=W;)it(m[P],E,k,!0),P++;else{const G=P,ae=P,be=new Map;for(P=ae;P<=V;P++){const mt=g[P]=I?$n(g[P]):Kt(g[P]);mt.key!=null&&be.set(mt.key,P)}let Pe,De=0;const Pt=V-ae+1;let Ar=!1,bl=0;const cs=new Array(Pt);for(P=0;P<Pt;P++)cs[P]=0;for(P=G;P<=W;P++){const mt=m[P];if(De>=Pt){it(mt,E,k,!0);continue}let Vt;if(mt.key!=null)Vt=be.get(mt.key);else for(Pe=ae;Pe<=V;Pe++)if(cs[Pe-ae]===0&&ls(mt,g[Pe])){Vt=Pe;break}Vt===void 0?it(mt,E,k,!0):(cs[Vt-ae]=P+1,Vt>=bl?bl=Vt:Ar=!0,y(mt,g[Vt],b,null,E,k,$,T,I),De++)}const wl=Ar?ny(cs):Lr;for(Pe=wl.length-1,P=Pt-1;P>=0;P--){const mt=ae+P,Vt=g[mt],vl=mt+1<F?g[mt+1].el:x;cs[P]===0?y(null,Vt,b,vl,E,k,$,T,I):Ar&&(Pe<0||P!==wl[Pe]?zt(Vt,b,vl,2):Pe--)}}},zt=(m,g,b,x,E=null)=>{const{el:k,type:$,transition:T,children:I,shapeFlag:P}=m;if(P&6){zt(m.component.subTree,g,b,x);return}if(P&128){m.suspense.move(g,b,x);return}if(P&64){$.move(m,g,b,q);return}if($===je){r(k,g,b);for(let W=0;W<I.length;W++)zt(I[W],g,b,x);r(m.anchor,g,b);return}if($===zo){O(m,g,b);return}if(x!==2&&P&1&&T)if(x===0)T.beforeEnter(k),r(k,g,b),ot(()=>T.enter(k),E);else{const{leave:W,delayLeave:V,afterLeave:G}=T,ae=()=>r(k,g,b),be=()=>{W(k,()=>{ae(),G&&G()})};V?V(k,ae,be):be()}else r(k,g,b)},it=(m,g,b,x=!1,E=!1)=>{const{type:k,props:$,ref:T,children:I,dynamicChildren:P,shapeFlag:F,patchFlag:W,dirs:V}=m;if(T!=null&&Ou(T,null,b,m,!0),F&256){g.ctx.deactivate(m);return}const G=F&1&&V,ae=!Mi(m);let be;if(ae&&(be=$&&$.onVnodeBeforeUnmount)&&Zt(be,g,m),F&6)vi(m.component,b,x);else{if(F&128){m.suspense.unmount(b,x);return}G&&Xn(m,null,g,"beforeUnmount"),F&64?m.type.remove(m,g,b,E,q,x):P&&(k!==je||W>0&&W&64)?Je(P,g,b,!1,!0):(k===je&&W&384||!E&&F&16)&&Je(I,g,b),x&&Er(m)}(ae&&(be=$&&$.onVnodeUnmounted)||G)&&ot(()=>{be&&Zt(be,g,m),G&&Xn(m,null,g,"unmounted")},b)},Er=m=>{const{type:g,el:b,anchor:x,transition:E}=m;if(g===je){Sr(b,x);return}if(g===zo){U(m);return}const k=()=>{s(b),E&&!E.persisted&&E.afterLeave&&E.afterLeave()};if(m.shapeFlag&1&&E&&!E.persisted){const{leave:$,delayLeave:T}=E,I=()=>$(b,k);T?T(m.el,k,I):I()}else k()},Sr=(m,g)=>{let b;for(;m!==g;)b=f(m),s(m),m=b;s(g)},vi=(m,g,b)=>{const{bum:x,scope:E,update:k,subTree:$,um:T}=m;x&&ji(x),E.stop(),k&&(k.active=!1,it($,m,g,b)),T&&ot(T,g),ot(()=>{m.isUnmounted=!0},g),g&&g.pendingBranch&&!g.isUnmounted&&m.asyncDep&&!m.asyncResolved&&m.suspenseId===g.pendingId&&(g.deps--,g.deps===0&&g.resolve())},Je=(m,g,b,x=!1,E=!1,k=0)=>{for(let $=k;$<m.length;$++)it(m[$],g,b,x,E)},A=m=>m.shapeFlag&6?A(m.component.subTree):m.shapeFlag&128?m.suspense.next():f(m.anchor||m.el);let D=!1;const N=(m,g,b)=>{m==null?g._vnode&&it(g._vnode,null,null,!0):y(g._vnode||null,m,g,null,null,null,b),D||(D=!0,Tl(),eh(),D=!1),g._vnode=m},q={p:y,um:it,m:zt,r:Er,mt:Gn,mc:K,pc:pe,pbc:Se,n:A,o:t};let me,Oe;return e&&([me,Oe]=e(q)),{render:N,hydrate:me,createApp:Zg(N,me)}}function Ho({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Yn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function ty(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function _h(t,e,n=!1){const r=t.children,s=e.children;if(J(r)&&J(s))for(let i=0;i<r.length;i++){const a=r[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=$n(s[i]),o.el=a.el),n||_h(a,o)),o.type===fo&&(o.el=a.el)}}function ny(t){const e=t.slice(),n=[0];let r,s,i,a,o;const u=t.length;for(r=0;r<u;r++){const c=t[r];if(c!==0){if(s=n[n.length-1],t[s]<c){e[r]=s,n.push(r);continue}for(i=0,a=n.length-1;i<a;)o=i+a>>1,t[n[o]]<c?i=o+1:a=o;c<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,a=n[i-1];i-- >0;)n[i]=a,a=e[a];return n}function bh(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:bh(e)}const ry=t=>t.__isTeleport,je=Symbol.for("v-fgt"),fo=Symbol.for("v-txt"),pr=Symbol.for("v-cmt"),zo=Symbol.for("v-stc"),Cs=[];let $t=null;function ie(t=!1){Cs.push($t=t?null:[])}function sy(){Cs.pop(),$t=Cs[Cs.length-1]||null}let Us=1;function Ul(t){Us+=t}function wh(t){return t.dynamicChildren=Us>0?$t||Lr:null,sy(),Us>0&&$t&&$t.push(t),t}function ye(t,e,n,r,s,i){return wh(Y(t,e,n,r,s,i,!0))}function Un(t,e,n,r,s){return wh(Ve(t,e,n,r,s,!0))}function Pu(t){return t?t.__v_isVNode===!0:!1}function ls(t,e){return t.type===e.type&&t.key===e.key}const vh=({key:t})=>t??null,Fi=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Le(t)||Me(t)||Q(t)?{i:nt,r:t,k:e,f:!!n}:t:null);function Y(t,e=null,n=null,r=0,s=null,i=t===je?0:1,a=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&vh(e),ref:e&&Fi(e),scopeId:co,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:nt};return o?(Cc(u,n),i&128&&t.normalize(u)):n&&(u.shapeFlag|=Le(n)?8:16),Us>0&&!a&&$t&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&$t.push(u),u}const Ve=iy;function iy(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===wg)&&(t=pr),Pu(t)){const o=Gr(t,e,!0);return n&&Cc(o,n),Us>0&&!i&&$t&&(o.shapeFlag&6?$t[$t.indexOf(t)]=o:$t.push(o)),o.patchFlag|=-2,o}if(gy(t)&&(t=t.__vccOpts),e){e=ay(e);let{class:o,style:u}=e;o&&!Le(o)&&(e.class=Kr(o)),Re(u)&&(Wf(u)&&!J(u)&&(u=Ze({},u)),e.style=pc(u))}const a=Le(t)?1:Eg(t)?128:ry(t)?64:Re(t)?4:Q(t)?2:0;return Y(t,e,n,r,s,a,i,!0)}function ay(t){return t?Wf(t)||fh(t)?Ze({},t):t:null}function Gr(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:a}=t,o=e?oy(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:o,key:o&&vh(o),ref:e&&e.ref?n&&s?J(s)?s.concat(Fi(e)):[s,Fi(e)]:Fi(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==je?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Gr(t.ssContent),ssFallback:t.ssFallback&&Gr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function Bi(t=" ",e=0){return Ve(fo,null,t,e)}function At(t="",e=!1){return e?(ie(),Un(pr,null,t)):Ve(pr,null,t)}function Kt(t){return t==null||typeof t=="boolean"?Ve(pr):J(t)?Ve(je,null,t.slice()):typeof t=="object"?$n(t):Ve(fo,null,String(t))}function $n(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Gr(t)}function Cc(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(J(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Cc(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!fh(e)?e._ctx=nt:s===3&&nt&&(nt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Q(e)?(e={default:e,_ctx:nt},n=32):(e=String(e),r&64?(n=16,e=[Bi(e)]):n=8);t.children=e,t.shapeFlag|=n}function oy(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Kr([e.class,r.class]));else if(s==="style")e.style=pc([e.style,r.style]);else if(no(s)){const i=e[s],a=r[s];a&&i!==a&&!(J(i)&&i.includes(a))&&(e[s]=i?[].concat(i,a):a)}else s!==""&&(e[s]=r[s])}return e}function Zt(t,e,n,r=null){Mt(t,e,7,[n,r])}const uy=lh();let cy=0;function ly(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||uy,i={uid:cy++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new kf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ph(r,s),emitsOptions:nh(r,s),emit:null,emitted:null,propsDefaults:Ae,inheritAttrs:r.inheritAttrs,ctx:Ae,data:Ae,props:Ae,attrs:Ae,slots:Ae,refs:Ae,setupState:Ae,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=mg.bind(null,i),t.ce&&t.ce(i),i}let He=null,ca,Ru;{const t=Rf(),e=(n,r)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(r),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};ca=e("__VUE_INSTANCE_SETTERS__",n=>He=n),Ru=e("__VUE_SSR_SETTERS__",n=>ho=n)}const di=t=>{const e=He;return ca(t),t.scope.on(),()=>{t.scope.off(),ca(e)}},ql=()=>{He&&He.scope.off(),ca(null)};function Eh(t){return t.vnode.shapeFlag&4}let ho=!1;function dy(t,e=!1){e&&Ru(e);const{props:n,children:r}=t.vnode,s=Eh(t);Jg(t,n,s,e),Xg(t,r);const i=s?fy(t,e):void 0;return e&&Ru(!1),i}function fy(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Fg);const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?py(t):null,i=di(t);Wn();const a=Bn(r,t,0,[t.props,s]);if(Jn(),i(),Af(a)){if(a.then(ql,ql),e)return a.then(o=>{Hl(t,o,e)}).catch(o=>{oo(o,t,0)});t.asyncDep=a}else Hl(t,a,e)}else Sh(t,e)}function Hl(t,e,n){Q(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Re(e)&&(t.setupState=Xf(e)),Sh(t,n)}let zl;function Sh(t,e,n){const r=t.type;if(!t.render){if(!e&&zl&&!r.render){const s=r.template||Pc(t).template;if(s){const{isCustomElement:i,compilerOptions:a}=t.appContext.config,{delimiters:o,compilerOptions:u}=r,c=Ze(Ze({isCustomElement:i,delimiters:o},a),u);r.render=zl(s,c)}}t.render=r.render||St}{const s=di(t);Wn();try{Bg(t)}finally{Jn(),s()}}}const hy={get(t,e){return ft(t,"get",""),t[e]}};function py(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,hy),slots:t.slots,emit:t.emit,expose:e}}function po(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Xf(vc(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Rs)return Rs[n](t)},has(e,n){return n in e||n in Rs}}))}function my(t,e=!0){return Q(t)?t.displayName||t.name:t.name||e&&t.__name}function gy(t){return Q(t)&&"__vccOpts"in t}const xe=(t,e)=>rg(t,e,ho);function Ah(t,e,n){const r=arguments.length;return r===2?Re(e)&&!J(e)?Pu(e)?Ve(t,null,[e]):Ve(t,e):Ve(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Pu(n)&&(n=[n]),Ve(t,e,n))}const yy="3.4.23";/**
* @vue/runtime-dom v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const _y="http://www.w3.org/2000/svg",by="http://www.w3.org/1998/Math/MathML",jn=typeof document<"u"?document:null,Vl=jn&&jn.createElement("template"),wy={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e==="svg"?jn.createElementNS(_y,t):e==="mathml"?jn.createElementNS(by,t):jn.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>jn.createTextNode(t),createComment:t=>jn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>jn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const a=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{Vl.innerHTML=r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t;const o=Vl.content;if(r==="svg"||r==="mathml"){const u=o.firstChild;for(;u.firstChild;)o.appendChild(u.firstChild);o.removeChild(u)}e.insertBefore(o,n)}return[a?a.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},vy=Symbol("_vtc");function Ey(t,e,n){const r=t[vy];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Zl=Symbol("_vod"),Sy=Symbol("_vsh"),Ay=Symbol(""),xy=/(^|;)\s*display\s*:/;function Oy(t,e,n){const r=t.style,s=Le(n);let i=!1;if(n&&!s){if(e)if(Le(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();n[o]==null&&Ui(r,o,"")}else for(const a in e)n[a]==null&&Ui(r,a,"");for(const a in n)a==="display"&&(i=!0),Ui(r,a,n[a])}else if(s){if(e!==n){const a=r[Ay];a&&(n+=";"+a),r.cssText=n,i=xy.test(n)}}else e&&t.removeAttribute("style");Zl in t&&(t[Zl]=i?r.display:"",t[Sy]&&(r.display="none"))}const Wl=/\s*!important$/;function Ui(t,e,n){if(J(n))n.forEach(r=>Ui(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=Py(t,e);Wl.test(n)?t.setProperty(rs(r),n.replace(Wl,""),"important"):t[r]=n}}const Jl=["Webkit","Moz","ms"],Vo={};function Py(t,e){const n=Vo[e];if(n)return n;let r=sn(e);if(r!=="filter"&&r in t)return Vo[e]=r;r=io(r);for(let s=0;s<Jl.length;s++){const i=Jl[s]+r;if(i in t)return Vo[e]=i}return e}const Kl="http://www.w3.org/1999/xlink";function Ry(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Kl,e.slice(6,e.length)):t.setAttributeNS(Kl,e,n);else{const i=$m(e);n==null||i&&!Cf(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function Cy(t,e,n,r,s,i,a){if(e==="innerHTML"||e==="textContent"){r&&a(r,s,i),t[e]=n??"";return}const o=t.tagName;if(e==="value"&&o!=="PROGRESS"&&!o.includes("-")){const c=o==="OPTION"?t.getAttribute("value")||"":t.value,l=n??"";(c!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let u=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=Cf(n):n==null&&c==="string"?(n="",u=!0):c==="number"&&(n=0,u=!0)}try{t[e]=n}catch{}u&&t.removeAttribute(e)}function Rr(t,e,n,r){t.addEventListener(e,n,r)}function Ty(t,e,n,r){t.removeEventListener(e,n,r)}const Gl=Symbol("_vei");function ky(t,e,n,r,s=null){const i=t[Gl]||(t[Gl]={}),a=i[e];if(r&&a)a.value=r;else{const[o,u]=Iy(e);if(r){const c=i[e]=jy(r,s);Rr(t,o,c,u)}else a&&(Ty(t,o,a,u),i[e]=void 0)}}const Xl=/(?:Once|Passive|Capture)$/;function Iy(t){let e;if(Xl.test(t)){e={};let r;for(;r=t.match(Xl);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):rs(t.slice(2)),e]}let Zo=0;const Ny=Promise.resolve(),$y=()=>Zo||(Ny.then(()=>Zo=0),Zo=Date.now());function jy(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Mt(Ly(r,n.value),e,5,[r])};return n.value=t,n.attached=$y(),n}function Ly(t,e){if(J(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Yl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,My=(t,e,n,r,s,i,a,o,u)=>{const c=s==="svg";e==="class"?Ey(t,r,c):e==="style"?Oy(t,n,r):no(e)?dc(e)||ky(t,e,n,r,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Dy(t,e,r,c))?Cy(t,e,r,i,a,o,u):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),Ry(t,e,r,c))};function Dy(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Yl(e)&&Q(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Yl(e)&&Le(n)?!1:e in t}const Ql=t=>{const e=t.props["onUpdate:modelValue"]||!1;return J(e)?n=>ji(e,n):e};function Fy(t){t.target.composing=!0}function ed(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Wo=Symbol("_assign"),qr={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t[Wo]=Ql(s);const i=r||s.props&&s.props.type==="number";Rr(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;n&&(o=o.trim()),i&&(o=gu(o)),t[Wo](o)}),n&&Rr(t,"change",()=>{t.value=t.value.trim()}),e||(Rr(t,"compositionstart",Fy),Rr(t,"compositionend",ed),Rr(t,"change",ed))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:s}},i){if(t[Wo]=Ql(i),t.composing)return;const a=(s||t.type==="number")&&!/^0\d/.test(t.value)?gu(t.value):t.value,o=e??"";a!==o&&(document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===o)||(t.value=o))}},By=Ze({patchProp:My},wy);let td;function Uy(){return td||(td=Qg(By))}const qy=(...t)=>{const e=Uy().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=zy(r);if(!s)return;const i=e._component;!Q(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const a=n(s,!1,Hy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e};function Hy(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function zy(t){return Le(t)?document.querySelector(t):t}var Vy=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let xh;const mo=t=>xh=t,Oh=Symbol();function Cu(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Ts;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Ts||(Ts={}));function Zy(){const t=If(!0),e=t.run(()=>Sc({}));let n=[],r=[];const s=vc({install(i){mo(s),s._a=i,i.provide(Oh,s),i.config.globalProperties.$pinia=s,r.forEach(a=>n.push(a)),r=[]},use(i){return!this._a&&!Vy?r.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return s}const Ph=()=>{};function nd(t,e,n,r=Ph){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!n&&Nf()&&Lm(s),s}function xr(t,...e){t.slice().forEach(n=>{n(...e)})}const Wy=t=>t();function Tu(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,r)=>t.set(r,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],s=t[n];Cu(s)&&Cu(r)&&t.hasOwnProperty(n)&&!Me(r)&&!lr(r)?t[n]=Tu(s,r):t[n]=r}return t}const Jy=Symbol();function Ky(t){return!Cu(t)||!t.hasOwnProperty(Jy)}const{assign:In}=Object;function Gy(t){return!!(Me(t)&&t.effect)}function Xy(t,e,n,r){const{state:s,actions:i,getters:a}=e,o=n.state.value[t];let u;function c(){o||(n.state.value[t]=s?s():{});const l=og(n.state.value[t]);return In(l,i,Object.keys(a||{}).reduce((d,f)=>(d[f]=vc(xe(()=>{mo(n);const h=n._s.get(t);return a[f].call(h,h)})),d),{}))}return u=Rh(t,c,e,n,r,!0),u}function Rh(t,e,n={},r,s,i){let a;const o=In({actions:{}},n),u={deep:!0};let c,l,d=[],f=[],h;const p=r.state.value[t];!i&&!p&&(r.state.value[t]={}),Sc({});let y;function _(K){let z;c=l=!1,typeof K=="function"?(K(r.state.value[t]),z={type:Ts.patchFunction,storeId:t,events:h}):(Tu(r.state.value[t],K),z={type:Ts.patchObject,payload:K,storeId:t,events:h});const Se=y=Symbol();xc().then(()=>{y===Se&&(c=!0)}),l=!0,xr(d,z,r.state.value[t])}const w=i?function(){const{state:z}=n,Se=z?z():{};this.$patch(We=>{In(We,Se)})}:Ph;function v(){a.stop(),d=[],f=[],r._s.delete(t)}function O(K,z){return function(){mo(r);const Se=Array.from(arguments),We=[],pt=[];function wt(he){We.push(he)}function Gn(he){pt.push(he)}xr(f,{args:Se,name:K,store:j,after:wt,onError:Gn});let vt;try{vt=z.apply(this&&this.$id===t?this:j,Se)}catch(he){throw xr(pt,he),he}return vt instanceof Promise?vt.then(he=>(xr(We,he),he)).catch(he=>(xr(pt,he),Promise.reject(he))):(xr(We,vt),vt)}}const U={_p:r,$id:t,$onAction:nd.bind(null,f),$patch:_,$reset:w,$subscribe(K,z={}){const Se=nd(d,K,z.detached,()=>We()),We=a.run(()=>Ps(()=>r.state.value[t],pt=>{(z.flush==="sync"?l:c)&&K({storeId:t,type:Ts.direct,events:h},pt)},In({},u,z)));return Se},$dispose:v},j=ui(U);r._s.set(t,j);const te=(r._a&&r._a.runWithContext||Wy)(()=>r._e.run(()=>(a=If()).run(e)));for(const K in te){const z=te[K];if(Me(z)&&!Gy(z)||lr(z))i||(p&&Ky(z)&&(Me(z)?z.value=p[K]:Tu(z,p[K])),r.state.value[t][K]=z);else if(typeof z=="function"){const Se=O(K,z);te[K]=Se,o.actions[K]=z}}return In(j,te),In(le(j),te),Object.defineProperty(j,"$state",{get:()=>r.state.value[t],set:K=>{_(z=>{In(z,K)})}}),r._p.forEach(K=>{In(j,a.run(()=>K({store:j,app:r._a,pinia:r,options:o})))}),p&&i&&n.hydrate&&n.hydrate(j.$state,p),c=!0,l=!0,j}function Yy(t,e,n){let r,s;const i=typeof e=="function";typeof t=="string"?(r=t,s=i?n:e):(s=t,r=t.id);function a(o,u){const c=Wg();return o=o||(c?rn(Oh,null):null),o&&mo(o),o=xh,o._s.has(r)||(i?Rh(r,e,s,o):Xy(r,s,o)),o._s.get(r)}return a.$id=r,a}const go=[{id:1,name:"Документы"},{id:2,name:"Учеба"},{id:3,name:"Реквизит"},{id:4,name:"Досуг"},{id:5,name:"Мероприятия"},{id:6,name:"Наука"},{id:7,name:"Развлечения"},{id:8,name:"Общежитие"},{id:9,name:"Разное"},{id:10,name:"Срочно"}],Kn=Yy("mainData",{state:()=>({dataHasBeenUploaded:!1,userId:null,token:"",email:"",nameOfPage:"",errorText:"",requestsList:[],myResponsesList:[],tagsList:[]}),actions:{setUserId(t){this.userId=t},setToken(t){this.token=t},setRequestsList(t){this.requestsList=t},setMyResponsesList(t){this.myResponsesList=t},setNameOfPage(t){this.nameOfPage=t},setErrorText(t){this.errorText=t,setTimeout(()=>{this.errorText=""},2e3)},setVerificationText(t){this.errorText=t},removeVerificationText(){this.errorText=""}}});function Ch(t,e){return function(){return t.apply(e,arguments)}}const{toString:Qy}=Object.prototype,{getPrototypeOf:Tc}=Object,yo=(t=>e=>{const n=Qy.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),un=t=>(t=t.toLowerCase(),e=>yo(e)===t),_o=t=>e=>typeof e===t,{isArray:ss}=Array,qs=_o("undefined");function e_(t){return t!==null&&!qs(t)&&t.constructor!==null&&!qs(t.constructor)&&xt(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Th=un("ArrayBuffer");function t_(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Th(t.buffer),e}const n_=_o("string"),xt=_o("function"),kh=_o("number"),bo=t=>t!==null&&typeof t=="object",r_=t=>t===!0||t===!1,qi=t=>{if(yo(t)!=="object")return!1;const e=Tc(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},s_=un("Date"),i_=un("File"),a_=un("Blob"),o_=un("FileList"),u_=t=>bo(t)&&xt(t.pipe),c_=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||xt(t.append)&&((e=yo(t))==="formdata"||e==="object"&&xt(t.toString)&&t.toString()==="[object FormData]"))},l_=un("URLSearchParams"),d_=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fi(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),ss(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,t[o],o,t)}}function Ih(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const Nh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,$h=t=>!qs(t)&&t!==Nh;function ku(){const{caseless:t}=$h(this)&&this||{},e={},n=(r,s)=>{const i=t&&Ih(e,s)||s;qi(e[i])&&qi(r)?e[i]=ku(e[i],r):qi(r)?e[i]=ku({},r):ss(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&fi(arguments[r],n);return e}const f_=(t,e,n,{allOwnKeys:r}={})=>(fi(e,(s,i)=>{n&&xt(s)?t[i]=Ch(s,n):t[i]=s},{allOwnKeys:r}),t),h_=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),p_=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},m_=(t,e,n,r)=>{let s,i,a;const o={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],(!r||r(a,t,e))&&!o[a]&&(e[a]=t[a],o[a]=!0);t=n!==!1&&Tc(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},g_=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},y_=t=>{if(!t)return null;if(ss(t))return t;let e=t.length;if(!kh(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},__=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Tc(Uint8Array)),b_=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},w_=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},v_=un("HTMLFormElement"),E_=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),rd=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),S_=un("RegExp"),jh=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};fi(n,(s,i)=>{let a;(a=e(s,i,t))!==!1&&(r[i]=a||s)}),Object.defineProperties(t,r)},A_=t=>{jh(t,(e,n)=>{if(xt(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(xt(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},x_=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return ss(t)?r(t):r(String(t).split(e)),n},O_=()=>{},P_=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Jo="abcdefghijklmnopqrstuvwxyz",sd="0123456789",Lh={DIGIT:sd,ALPHA:Jo,ALPHA_DIGIT:Jo+Jo.toUpperCase()+sd},R_=(t=16,e=Lh.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function C_(t){return!!(t&&xt(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const T_=t=>{const e=new Array(10),n=(r,s)=>{if(bo(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=ss(r)?[]:{};return fi(r,(a,o)=>{const u=n(a,s+1);!qs(u)&&(i[o]=u)}),e[s]=void 0,i}}return r};return n(t,0)},k_=un("AsyncFunction"),I_=t=>t&&(bo(t)||xt(t))&&xt(t.then)&&xt(t.catch),S={isArray:ss,isArrayBuffer:Th,isBuffer:e_,isFormData:c_,isArrayBufferView:t_,isString:n_,isNumber:kh,isBoolean:r_,isObject:bo,isPlainObject:qi,isUndefined:qs,isDate:s_,isFile:i_,isBlob:a_,isRegExp:S_,isFunction:xt,isStream:u_,isURLSearchParams:l_,isTypedArray:__,isFileList:o_,forEach:fi,merge:ku,extend:f_,trim:d_,stripBOM:h_,inherits:p_,toFlatObject:m_,kindOf:yo,kindOfTest:un,endsWith:g_,toArray:y_,forEachEntry:b_,matchAll:w_,isHTMLForm:v_,hasOwnProperty:rd,hasOwnProp:rd,reduceDescriptors:jh,freezeMethods:A_,toObjectSet:x_,toCamelCase:E_,noop:O_,toFiniteNumber:P_,findKey:Ih,global:Nh,isContextDefined:$h,ALPHABET:Lh,generateString:R_,isSpecCompliantForm:C_,toJSONObject:T_,isAsyncFn:k_,isThenable:I_};function ue(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}S.inherits(ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:S.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Mh=ue.prototype,Dh={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Dh[t]={value:t}});Object.defineProperties(ue,Dh);Object.defineProperty(Mh,"isAxiosError",{value:!0});ue.from=(t,e,n,r,s,i)=>{const a=Object.create(Mh);return S.toFlatObject(t,a,function(u){return u!==Error.prototype},o=>o!=="isAxiosError"),ue.call(a,t.message,e,n,r,s),a.cause=t,a.name=t.name,i&&Object.assign(a,i),a};const N_=null;function Iu(t){return S.isPlainObject(t)||S.isArray(t)}function Fh(t){return S.endsWith(t,"[]")?t.slice(0,-2):t}function id(t,e,n){return t?t.concat(e).map(function(s,i){return s=Fh(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function $_(t){return S.isArray(t)&&!t.some(Iu)}const j_=S.toFlatObject(S,{},null,function(e){return/^is[A-Z]/.test(e)});function wo(t,e,n){if(!S.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=S.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,_){return!S.isUndefined(_[y])});const r=n.metaTokens,s=n.visitor||l,i=n.dots,a=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&S.isSpecCompliantForm(e);if(!S.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(S.isDate(p))return p.toISOString();if(!u&&S.isBlob(p))throw new ue("Blob is not supported. Use a Buffer instead.");return S.isArrayBuffer(p)||S.isTypedArray(p)?u&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function l(p,y,_){let w=p;if(p&&!_&&typeof p=="object"){if(S.endsWith(y,"{}"))y=r?y:y.slice(0,-2),p=JSON.stringify(p);else if(S.isArray(p)&&$_(p)||(S.isFileList(p)||S.endsWith(y,"[]"))&&(w=S.toArray(p)))return y=Fh(y),w.forEach(function(O,U){!(S.isUndefined(O)||O===null)&&e.append(a===!0?id([y],U,i):a===null?y:y+"[]",c(O))}),!1}return Iu(p)?!0:(e.append(id(_,y,i),c(p)),!1)}const d=[],f=Object.assign(j_,{defaultVisitor:l,convertValue:c,isVisitable:Iu});function h(p,y){if(!S.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+y.join("."));d.push(p),S.forEach(p,function(w,v){(!(S.isUndefined(w)||w===null)&&s.call(e,w,S.isString(v)?v.trim():v,y,f))===!0&&h(w,y?y.concat(v):[v])}),d.pop()}}if(!S.isObject(t))throw new TypeError("data must be an object");return h(t),e}function ad(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function kc(t,e){this._pairs=[],t&&wo(t,this,e)}const Bh=kc.prototype;Bh.append=function(e,n){this._pairs.push([e,n])};Bh.toString=function(e){const n=e?function(r){return e.call(this,r,ad)}:ad;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function L_(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Uh(t,e,n){if(!e)return t;const r=n&&n.encode||L_,s=n&&n.serialize;let i;if(s?i=s(e,n):i=S.isURLSearchParams(e)?e.toString():new kc(e,n).toString(r),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class od{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){S.forEach(this.handlers,function(r){r!==null&&e(r)})}}const qh={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},M_=typeof URLSearchParams<"u"?URLSearchParams:kc,D_=typeof FormData<"u"?FormData:null,F_=typeof Blob<"u"?Blob:null,B_={isBrowser:!0,classes:{URLSearchParams:M_,FormData:D_,Blob:F_},protocols:["http","https","file","blob","url","data"]},Hh=typeof window<"u"&&typeof document<"u",U_=(t=>Hh&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),q_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",H_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hh,hasStandardBrowserEnv:U_,hasStandardBrowserWebWorkerEnv:q_},Symbol.toStringTag,{value:"Module"})),Qt={...H_,...B_};function z_(t,e){return wo(t,new Qt.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return Qt.isNode&&S.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function V_(t){return S.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Z_(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function zh(t){function e(n,r,s,i){let a=n[i++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),u=i>=n.length;return a=!a&&S.isArray(s)?s.length:a,u?(S.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!o):((!s[a]||!S.isObject(s[a]))&&(s[a]=[]),e(n,r,s[a],i)&&S.isArray(s[a])&&(s[a]=Z_(s[a])),!o)}if(S.isFormData(t)&&S.isFunction(t.entries)){const n={};return S.forEachEntry(t,(r,s)=>{e(V_(r),s,n,0)}),n}return null}function W_(t,e,n){if(S.isString(t))try{return(e||JSON.parse)(t),S.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Ic={transitional:qh,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=S.isObject(e);if(i&&S.isHTMLForm(e)&&(e=new FormData(e)),S.isFormData(e))return s?JSON.stringify(zh(e)):e;if(S.isArrayBuffer(e)||S.isBuffer(e)||S.isStream(e)||S.isFile(e)||S.isBlob(e))return e;if(S.isArrayBufferView(e))return e.buffer;if(S.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return z_(e,this.formSerializer).toString();if((o=S.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return wo(o?{"files[]":e}:e,u&&new u,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),W_(e)):e}],transformResponse:[function(e){const n=this.transitional||Ic.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(e&&S.isString(e)&&(r&&!this.responseType||s)){const a=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?ue.from(o,ue.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qt.classes.FormData,Blob:Qt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};S.forEach(["delete","get","head","post","put","patch"],t=>{Ic.headers[t]={}});const Nc=Ic,J_=S.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),K_=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),n=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!n||e[n]&&J_[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},ud=Symbol("internals");function ds(t){return t&&String(t).trim().toLowerCase()}function Hi(t){return t===!1||t==null?t:S.isArray(t)?t.map(Hi):String(t)}function G_(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const X_=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ko(t,e,n,r,s){if(S.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!S.isString(e)){if(S.isString(r))return e.indexOf(r)!==-1;if(S.isRegExp(r))return r.test(e)}}function Y_(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function Q_(t,e){const n=S.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class vo{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(o,u,c){const l=ds(u);if(!l)throw new Error("header name must be a non-empty string");const d=S.findKey(s,l);(!d||s[d]===void 0||c===!0||c===void 0&&s[d]!==!1)&&(s[d||u]=Hi(o))}const a=(o,u)=>S.forEach(o,(c,l)=>i(c,l,u));return S.isPlainObject(e)||e instanceof this.constructor?a(e,n):S.isString(e)&&(e=e.trim())&&!X_(e)?a(K_(e),n):e!=null&&i(n,e,r),this}get(e,n){if(e=ds(e),e){const r=S.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return G_(s);if(S.isFunction(n))return n.call(this,s,r);if(S.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=ds(e),e){const r=S.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Ko(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(a){if(a=ds(a),a){const o=S.findKey(r,a);o&&(!n||Ko(r,r[o],o,n))&&(delete r[o],s=!0)}}return S.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||Ko(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return S.forEach(this,(s,i)=>{const a=S.findKey(r,i);if(a){n[a]=Hi(s),delete n[i];return}const o=e?Y_(i):String(i).trim();o!==i&&delete n[i],n[o]=Hi(s),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return S.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&S.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[ud]=this[ud]={accessors:{}}).accessors,s=this.prototype;function i(a){const o=ds(a);r[o]||(Q_(s,a),r[o]=!0)}return S.isArray(e)?e.forEach(i):i(e),this}}vo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);S.reduceDescriptors(vo.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});S.freezeMethods(vo);const yn=vo;function Go(t,e){const n=this||Nc,r=e||n,s=yn.from(r.headers);let i=r.data;return S.forEach(t,function(o){i=o.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Vh(t){return!!(t&&t.__CANCEL__)}function hi(t,e,n){ue.call(this,t??"canceled",ue.ERR_CANCELED,e,n),this.name="CanceledError"}S.inherits(hi,ue,{__CANCEL__:!0});function eb(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new ue("Request failed with status code "+n.status,[ue.ERR_BAD_REQUEST,ue.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const tb=Qt.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const a=[t+"="+encodeURIComponent(e)];S.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),S.isString(r)&&a.push("path="+r),S.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function nb(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function rb(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Zh(t,e){return t&&!nb(e)?rb(t,e):e}const sb=Qt.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function s(i){let a=i;return e&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(a){const o=S.isString(a)?s(a):a;return o.protocol===r.protocol&&o.host===r.host}}():function(){return function(){return!0}}();function ib(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function ab(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(u){const c=Date.now(),l=r[i];a||(a=c),n[s]=u,r[s]=c;let d=i,f=0;for(;d!==s;)f+=n[d++],d=d%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),c-a<e)return;const h=l&&c-l;return h?Math.round(f*1e3/h):void 0}}function cd(t,e){let n=0;const r=ab(50,250);return s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,o=i-n,u=r(o),c=i<=a;n=i;const l={loaded:i,total:a,progress:a?i/a:void 0,bytes:o,rate:u||void 0,estimated:u&&a&&c?(a-i)/u:void 0,event:s};l[e?"download":"upload"]=!0,t(l)}}const ob=typeof XMLHttpRequest<"u",ub=ob&&function(t){return new Promise(function(n,r){let s=t.data;const i=yn.from(t.headers).normalize();let{responseType:a,withXSRFToken:o}=t,u;function c(){t.cancelToken&&t.cancelToken.unsubscribe(u),t.signal&&t.signal.removeEventListener("abort",u)}let l;if(S.isFormData(s)){if(Qt.hasStandardBrowserEnv||Qt.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((l=i.getContentType())!==!1){const[y,..._]=l?l.split(";").map(w=>w.trim()).filter(Boolean):[];i.setContentType([y||"multipart/form-data",..._].join("; "))}}let d=new XMLHttpRequest;if(t.auth){const y=t.auth.username||"",_=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.set("Authorization","Basic "+btoa(y+":"+_))}const f=Zh(t.baseURL,t.url);d.open(t.method.toUpperCase(),Uh(f,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function h(){if(!d)return;const y=yn.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),w={data:!a||a==="text"||a==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:y,config:t,request:d};eb(function(O){n(O),c()},function(O){r(O),c()},w),d=null}if("onloadend"in d?d.onloadend=h:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(h)},d.onabort=function(){d&&(r(new ue("Request aborted",ue.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new ue("Network Error",ue.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let _=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const w=t.transitional||qh;t.timeoutErrorMessage&&(_=t.timeoutErrorMessage),r(new ue(_,w.clarifyTimeoutError?ue.ETIMEDOUT:ue.ECONNABORTED,t,d)),d=null},Qt.hasStandardBrowserEnv&&(o&&S.isFunction(o)&&(o=o(t)),o||o!==!1&&sb(f))){const y=t.xsrfHeaderName&&t.xsrfCookieName&&tb.read(t.xsrfCookieName);y&&i.set(t.xsrfHeaderName,y)}s===void 0&&i.setContentType(null),"setRequestHeader"in d&&S.forEach(i.toJSON(),function(_,w){d.setRequestHeader(w,_)}),S.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),a&&a!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",cd(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",cd(t.onUploadProgress)),(t.cancelToken||t.signal)&&(u=y=>{d&&(r(!y||y.type?new hi(null,t,d):y),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(u),t.signal&&(t.signal.aborted?u():t.signal.addEventListener("abort",u)));const p=ib(f);if(p&&Qt.protocols.indexOf(p)===-1){r(new ue("Unsupported protocol "+p+":",ue.ERR_BAD_REQUEST,t));return}d.send(s||null)})},Nu={http:N_,xhr:ub};S.forEach(Nu,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const ld=t=>`- ${t}`,cb=t=>S.isFunction(t)||t===null||t===!1,Wh={getAdapter:t=>{t=S.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let a;if(r=n,!cb(n)&&(r=Nu[(a=String(n)).toLowerCase()],r===void 0))throw new ue(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([o,u])=>`adapter ${o} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(ld).join(`
`):" "+ld(i[0]):"as no adapter specified";throw new ue("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Nu};function Xo(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new hi(null,t)}function dd(t){return Xo(t),t.headers=yn.from(t.headers),t.data=Go.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Wh.getAdapter(t.adapter||Nc.adapter)(t).then(function(r){return Xo(t),r.data=Go.call(t,t.transformResponse,r),r.headers=yn.from(r.headers),r},function(r){return Vh(r)||(Xo(t),r&&r.response&&(r.response.data=Go.call(t,t.transformResponse,r.response),r.response.headers=yn.from(r.response.headers))),Promise.reject(r)})}const fd=t=>t instanceof yn?{...t}:t;function Xr(t,e){e=e||{};const n={};function r(c,l,d){return S.isPlainObject(c)&&S.isPlainObject(l)?S.merge.call({caseless:d},c,l):S.isPlainObject(l)?S.merge({},l):S.isArray(l)?l.slice():l}function s(c,l,d){if(S.isUndefined(l)){if(!S.isUndefined(c))return r(void 0,c,d)}else return r(c,l,d)}function i(c,l){if(!S.isUndefined(l))return r(void 0,l)}function a(c,l){if(S.isUndefined(l)){if(!S.isUndefined(c))return r(void 0,c)}else return r(void 0,l)}function o(c,l,d){if(d in e)return r(c,l);if(d in t)return r(void 0,c)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,l)=>s(fd(c),fd(l),!0)};return S.forEach(Object.keys(Object.assign({},t,e)),function(l){const d=u[l]||s,f=d(t[l],e[l],l);S.isUndefined(f)&&d!==o||(n[l]=f)}),n}const Jh="1.6.8",$c={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{$c[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const hd={};$c.transitional=function(e,n,r){function s(i,a){return"[Axios v"+Jh+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,o)=>{if(e===!1)throw new ue(s(a," has been removed"+(n?" in "+n:"")),ue.ERR_DEPRECATED);return n&&!hd[a]&&(hd[a]=!0,console.warn(s(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,a,o):!0}};function lb(t,e,n){if(typeof t!="object")throw new ue("options must be an object",ue.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const o=t[i],u=o===void 0||a(o,i,t);if(u!==!0)throw new ue("option "+i+" must be "+u,ue.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ue("Unknown option "+i,ue.ERR_BAD_OPTION)}}const $u={assertOptions:lb,validators:$c},Pn=$u.validators;class la{constructor(e){this.defaults=e,this.interceptors={request:new od,response:new od}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Xr(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&$u.assertOptions(r,{silentJSONParsing:Pn.transitional(Pn.boolean),forcedJSONParsing:Pn.transitional(Pn.boolean),clarifyTimeoutError:Pn.transitional(Pn.boolean)},!1),s!=null&&(S.isFunction(s)?n.paramsSerializer={serialize:s}:$u.assertOptions(s,{encode:Pn.function,serialize:Pn.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&S.merge(i.common,i[n.method]);i&&S.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),n.headers=yn.concat(a,i);const o=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(u=u&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const c=[];this.interceptors.response.forEach(function(y){c.push(y.fulfilled,y.rejected)});let l,d=0,f;if(!u){const p=[dd.bind(this),void 0];for(p.unshift.apply(p,o),p.push.apply(p,c),f=p.length,l=Promise.resolve(n);d<f;)l=l.then(p[d++],p[d++]);return l}f=o.length;let h=n;for(d=0;d<f;){const p=o[d++],y=o[d++];try{h=p(h)}catch(_){y.call(this,_);break}}try{l=dd.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,f=c.length;d<f;)l=l.then(c[d++],c[d++]);return l}getUri(e){e=Xr(this.defaults,e);const n=Zh(e.baseURL,e.url);return Uh(n,e.params,e.paramsSerializer)}}S.forEach(["delete","get","head","options"],function(e){la.prototype[e]=function(n,r){return this.request(Xr(r||{},{method:e,url:n,data:(r||{}).data}))}});S.forEach(["post","put","patch"],function(e){function n(r){return function(i,a,o){return this.request(Xr(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}la.prototype[e]=n(),la.prototype[e+"Form"]=n(!0)});const zi=la;class jc{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(o=>{r.subscribe(o),i=o}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,o){r.reason||(r.reason=new hi(i,a,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new jc(function(s){e=s}),cancel:e}}}const db=jc;function fb(t){return function(n){return t.apply(null,n)}}function hb(t){return S.isObject(t)&&t.isAxiosError===!0}const ju={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ju).forEach(([t,e])=>{ju[e]=t});const pb=ju;function Kh(t){const e=new zi(t),n=Ch(zi.prototype.request,e);return S.extend(n,zi.prototype,e,{allOwnKeys:!0}),S.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return Kh(Xr(t,s))},n}const Ee=Kh(Nc);Ee.Axios=zi;Ee.CanceledError=hi;Ee.CancelToken=db;Ee.isCancel=Vh;Ee.VERSION=Jh;Ee.toFormData=wo;Ee.AxiosError=ue;Ee.Cancel=Ee.CanceledError;Ee.all=function(e){return Promise.all(e)};Ee.spread=fb;Ee.isAxiosError=hb;Ee.mergeConfig=Xr;Ee.AxiosHeaders=yn;Ee.formToJSON=t=>zh(S.isHTMLForm(t)?new FormData(t):t);Ee.getAdapter=Wh.getAdapter;Ee.HttpStatusCode=pb;Ee.default=Ee;const mb=En({setup(){const t=Kn(),e=xe(()=>t.nameOfPage),n=xe(()=>t.token),r=xe(()=>t.userId),s=xe(()=>t.errorText);return{userId:r,mainDataStore:t,nameOfPage:e,errorText:s,token:n}},created(){let e=new URLSearchParams(window.location.search).get("token");e="zoYAlMokyGjIwVbCtfRJwABRmJmqHARIxybgZuDwXgDDTRxguOUnVjFMhkgtwxky",e="VkUDToYDlVTPlppmtYlSoQnRdxfakfwJbmsdcfwBzGlwrVjWNYfcHeVBSnHLQfYY",this.mainDataStore.setToken(e),this.getMainData()},methods:{async getMainData(){let t=await Ee.get("https://api.test.profcomff.com/auth/me?info=groups",{headers:{Authorization:this.token}});const e=t.data.id;this.mainDataStore.email=t.data.email,this.mainDataStore.setUserId(e),t=await Ee.get("https://viribusunitis.ru/api/requests"),console.log(t.data);let n=t.data.map(s=>{let i=s.tags.map(a=>a.id);return{id:s.id,name:s.name,userId:s.userId,comment:s.description.text,time:new Date(s.createdDate),tags:i}});this.mainDataStore.setRequestsList(n),t=await Ee.get("https://viribusunitis.ru/api/responses"),console.log(t.data);let r=t.data.filter(s=>s.userId==this.userId);r=r.map(s=>{let i=new Date(s.request.createdDate),a=s.request.tags.map(o=>o.id);return{id:s.id,phone:s.phone,comment:s.comment,requestId:s.requestId,request:{...s.request,time:i,tags:a}}}),this.mainDataStore.setMyResponsesList(r),this.mainDataStore.dataHasBeenUploaded=!0}}}),vr=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},gb={class:"pageName"},yb={key:1,class:"error"};function _b(t,e,n,r,s,i){const a=Hn("router-link"),o=Hn("router-view");return ie(),ye(je,null,[Y("div",gb,[Bi(Ne(t.mainDataStore.nameOfPage)+" ",1),t.nameOfPage=="Список запросов"?(ie(),Un(a,{key:0,to:"/createRequest",class:"add-request-button"},{default:nn(()=>[Bi(" + ")]),_:1})):At("",!0),t.nameOfPage=="Список запросов"?(ie(),Un(a,{key:1,to:"/myRequestsResponses",class:"my-response-request-button"},{default:nn(()=>[Bi(" Я ")]),_:1})):At("",!0)]),t.mainDataStore.dataHasBeenUploaded==!0?(ie(),Un(o,{key:0,class:"page"})):At("",!0),t.errorText.length>0?(ie(),ye("div",yb,Ne(t.errorText),1)):At("",!0)],64)}const bb=vr(mb,[["render",_b],["__scopeId","data-v-29aed0f6"]]);/*!
  * vue-router v4.3.2
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Cr=typeof document<"u";function wb(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const ge=Object.assign;function Yo(t,e){const n={};for(const r in e){const s=e[r];n[r]=Bt(s)?s.map(t):t(s)}return n}const ks=()=>{},Bt=Array.isArray,Gh=/#/g,vb=/&/g,Eb=/\//g,Sb=/=/g,Ab=/\?/g,Xh=/\+/g,xb=/%5B/g,Ob=/%5D/g,Yh=/%5E/g,Pb=/%60/g,Qh=/%7B/g,Rb=/%7C/g,ep=/%7D/g,Cb=/%20/g;function Lc(t){return encodeURI(""+t).replace(Rb,"|").replace(xb,"[").replace(Ob,"]")}function Tb(t){return Lc(t).replace(Qh,"{").replace(ep,"}").replace(Yh,"^")}function Lu(t){return Lc(t).replace(Xh,"%2B").replace(Cb,"+").replace(Gh,"%23").replace(vb,"%26").replace(Pb,"`").replace(Qh,"{").replace(ep,"}").replace(Yh,"^")}function kb(t){return Lu(t).replace(Sb,"%3D")}function Ib(t){return Lc(t).replace(Gh,"%23").replace(Ab,"%3F")}function Nb(t){return t==null?"":Ib(t).replace(Eb,"%2F")}function Hs(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const $b=/\/$/,jb=t=>t.replace($b,"");function Qo(t,e,n="/"){let r,s={},i="",a="";const o=e.indexOf("#");let u=e.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(r=e.slice(0,u),i=e.slice(u+1,o>-1?o:e.length),s=t(i)),o>-1&&(r=r||e.slice(0,o),a=e.slice(o,e.length)),r=Fb(r??e,n),{fullPath:r+(i&&"?")+i+a,path:r,query:s,hash:Hs(a)}}function Lb(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function pd(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Mb(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&Yr(e.matched[r],n.matched[s])&&tp(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Yr(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function tp(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Db(t[n],e[n]))return!1;return!0}function Db(t,e){return Bt(t)?md(t,e):Bt(e)?md(e,t):t===e}function md(t,e){return Bt(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function Fb(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=n.length-1,a,o;for(a=0;a<r.length;a++)if(o=r[a],o!==".")if(o==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(a).join("/")}var zs;(function(t){t.pop="pop",t.push="push"})(zs||(zs={}));var Is;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Is||(Is={}));function Bb(t){if(!t)if(Cr){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),jb(t)}const Ub=/^[^#]+#/;function qb(t,e){return t.replace(Ub,"#")+e}function Hb(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Eo=()=>({left:window.scrollX,top:window.scrollY});function zb(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=Hb(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function gd(t,e){return(history.state?history.state.position-e:-1)+t}const Mu=new Map;function Vb(t,e){Mu.set(t,e)}function Zb(t){const e=Mu.get(t);return Mu.delete(t),e}let Wb=()=>location.protocol+"//"+location.host;function np(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let o=s.includes(t.slice(i))?t.slice(i).length:1,u=s.slice(o);return u[0]!=="/"&&(u="/"+u),pd(u,"")}return pd(n,t)+r+s}function Jb(t,e,n,r){let s=[],i=[],a=null;const o=({state:f})=>{const h=np(t,location),p=n.value,y=e.value;let _=0;if(f){if(n.value=h,e.value=f,a&&a===p){a=null;return}_=y?f.position-y.position:0}else r(h);s.forEach(w=>{w(n.value,p,{delta:_,type:zs.pop,direction:_?_>0?Is.forward:Is.back:Is.unknown})})};function u(){a=n.value}function c(f){s.push(f);const h=()=>{const p=s.indexOf(f);p>-1&&s.splice(p,1)};return i.push(h),h}function l(){const{history:f}=window;f.state&&f.replaceState(ge({},f.state,{scroll:Eo()}),"")}function d(){for(const f of i)f();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",l)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:u,listen:c,destroy:d}}function yd(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Eo():null}}function Kb(t){const{history:e,location:n}=window,r={value:np(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(u,c,l){const d=t.indexOf("#"),f=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+u:Wb()+t+u;try{e[l?"replaceState":"pushState"](c,"",f),s.value=c}catch(h){console.error(h),n[l?"replace":"assign"](f)}}function a(u,c){const l=ge({},e.state,yd(s.value.back,u,s.value.forward,!0),c,{position:s.value.position});i(u,l,!0),r.value=u}function o(u,c){const l=ge({},s.value,e.state,{forward:u,scroll:Eo()});i(l.current,l,!0);const d=ge({},yd(r.value,u,null),{position:l.position+1},c);i(u,d,!1),r.value=u}return{location:r,state:s,push:o,replace:a}}function Gb(t){t=Bb(t);const e=Kb(t),n=Jb(t,e.state,e.location,e.replace);function r(i,a=!0){a||n.pauseListeners(),history.go(i)}const s=ge({location:"",base:t,go:r,createHref:qb.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function Xb(t){return typeof t=="string"||t&&typeof t=="object"}function rp(t){return typeof t=="string"||typeof t=="symbol"}const Rn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},sp=Symbol("");var _d;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(_d||(_d={}));function Qr(t,e){return ge(new Error,{type:t,[sp]:!0},e)}function ln(t,e){return t instanceof Error&&sp in t&&(e==null||!!(t.type&e))}const bd="[^/]+?",Yb={sensitive:!1,strict:!1,start:!0,end:!0},Qb=/[.+*?^${}()[\]/\\]/g;function ew(t,e){const n=ge({},Yb,e),r=[];let s=n.start?"^":"";const i=[];for(const c of t){const l=c.length?[]:[90];n.strict&&!c.length&&(s+="/");for(let d=0;d<c.length;d++){const f=c[d];let h=40+(n.sensitive?.25:0);if(f.type===0)d||(s+="/"),s+=f.value.replace(Qb,"\\$&"),h+=40;else if(f.type===1){const{value:p,repeatable:y,optional:_,regexp:w}=f;i.push({name:p,repeatable:y,optional:_});const v=w||bd;if(v!==bd){h+=10;try{new RegExp(`(${v})`)}catch(U){throw new Error(`Invalid custom RegExp for param "${p}" (${v}): `+U.message)}}let O=y?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;d||(O=_&&c.length<2?`(?:/${O})`:"/"+O),_&&(O+="?"),s+=O,h+=20,_&&(h+=-8),y&&(h+=-20),v===".*"&&(h+=-50)}l.push(h)}r.push(l)}if(n.strict&&n.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const a=new RegExp(s,n.sensitive?"":"i");function o(c){const l=c.match(a),d={};if(!l)return null;for(let f=1;f<l.length;f++){const h=l[f]||"",p=i[f-1];d[p.name]=h&&p.repeatable?h.split("/"):h}return d}function u(c){let l="",d=!1;for(const f of t){(!d||!l.endsWith("/"))&&(l+="/"),d=!1;for(const h of f)if(h.type===0)l+=h.value;else if(h.type===1){const{value:p,repeatable:y,optional:_}=h,w=p in c?c[p]:"";if(Bt(w)&&!y)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const v=Bt(w)?w.join("/"):w;if(!v)if(_)f.length<2&&(l.endsWith("/")?l=l.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);l+=v}}return l||"/"}return{re:a,score:r,keys:i,parse:o,stringify:u}}function tw(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function nw(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=tw(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(wd(r))return 1;if(wd(s))return-1}return s.length-r.length}function wd(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const rw={type:0,value:""},sw=/[a-zA-Z0-9_]/;function iw(t){if(!t)return[[]];if(t==="/")return[[rw]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(h){throw new Error(`ERR (${n})/"${c}": ${h}`)}let n=0,r=n;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,u,c="",l="";function d(){c&&(n===0?i.push({type:0,value:c}):n===1||n===2||n===3?(i.length>1&&(u==="*"||u==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:l,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=u}for(;o<t.length;){if(u=t[o++],u==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:u==="/"?(c&&d(),a()):u===":"?(d(),n=1):f();break;case 4:f(),n=r;break;case 1:u==="("?n=2:sw.test(u)?f():(d(),n=0,u!=="*"&&u!=="?"&&u!=="+"&&o--);break;case 2:u===")"?l[l.length-1]=="\\"?l=l.slice(0,-1)+u:n=3:l+=u;break;case 3:d(),n=0,u!=="*"&&u!=="?"&&u!=="+"&&o--,l="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),a(),s}function aw(t,e,n){const r=ew(iw(t.path),n),s=ge(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function ow(t,e){const n=[],r=new Map;e=Sd({strict:!1,end:!0,sensitive:!1},e);function s(l){return r.get(l)}function i(l,d,f){const h=!f,p=uw(l);p.aliasOf=f&&f.record;const y=Sd(e,l),_=[p];if("alias"in l){const O=typeof l.alias=="string"?[l.alias]:l.alias;for(const U of O)_.push(ge({},p,{components:f?f.record.components:p.components,path:U,aliasOf:f?f.record:p}))}let w,v;for(const O of _){const{path:U}=O;if(d&&U[0]!=="/"){const j=d.record.path,B=j[j.length-1]==="/"?"":"/";O.path=d.record.path+(U&&B+U)}if(w=aw(O,d,y),f?f.alias.push(w):(v=v||w,v!==w&&v.alias.push(w),h&&l.name&&!Ed(w)&&a(l.name)),p.children){const j=p.children;for(let B=0;B<j.length;B++)i(j[B],w,f&&f.children[B])}f=f||w,(w.record.components&&Object.keys(w.record.components).length||w.record.name||w.record.redirect)&&u(w)}return v?()=>{a(v)}:ks}function a(l){if(rp(l)){const d=r.get(l);d&&(r.delete(l),n.splice(n.indexOf(d),1),d.children.forEach(a),d.alias.forEach(a))}else{const d=n.indexOf(l);d>-1&&(n.splice(d,1),l.record.name&&r.delete(l.record.name),l.children.forEach(a),l.alias.forEach(a))}}function o(){return n}function u(l){let d=0;for(;d<n.length&&nw(l,n[d])>=0&&(l.record.path!==n[d].record.path||!ip(l,n[d]));)d++;n.splice(d,0,l),l.record.name&&!Ed(l)&&r.set(l.record.name,l)}function c(l,d){let f,h={},p,y;if("name"in l&&l.name){if(f=r.get(l.name),!f)throw Qr(1,{location:l});y=f.record.name,h=ge(vd(d.params,f.keys.filter(v=>!v.optional).concat(f.parent?f.parent.keys.filter(v=>v.optional):[]).map(v=>v.name)),l.params&&vd(l.params,f.keys.map(v=>v.name))),p=f.stringify(h)}else if(l.path!=null)p=l.path,f=n.find(v=>v.re.test(p)),f&&(h=f.parse(p),y=f.record.name);else{if(f=d.name?r.get(d.name):n.find(v=>v.re.test(d.path)),!f)throw Qr(1,{location:l,currentLocation:d});y=f.record.name,h=ge({},d.params,l.params),p=f.stringify(h)}const _=[];let w=f;for(;w;)_.unshift(w.record),w=w.parent;return{name:y,path:p,params:h,matched:_,meta:lw(_)}}return t.forEach(l=>i(l)),{addRoute:i,resolve:c,removeRoute:a,getRoutes:o,getRecordMatcher:s}}function vd(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function uw(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:cw(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function cw(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function Ed(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function lw(t){return t.reduce((e,n)=>ge(e,n.meta),{})}function Sd(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function ip(t,e){return e.children.some(n=>n===t||ip(t,n))}function dw(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Xh," "),a=i.indexOf("="),o=Hs(a<0?i:i.slice(0,a)),u=a<0?null:Hs(i.slice(a+1));if(o in e){let c=e[o];Bt(c)||(c=e[o]=[c]),c.push(u)}else e[o]=u}return e}function Ad(t){let e="";for(let n in t){const r=t[n];if(n=kb(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Bt(r)?r.map(i=>i&&Lu(i)):[r&&Lu(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function fw(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Bt(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const hw=Symbol(""),xd=Symbol(""),Mc=Symbol(""),ap=Symbol(""),Du=Symbol("");function fs(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ln(t,e,n,r,s,i=a=>a()){const a=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((o,u)=>{const c=f=>{f===!1?u(Qr(4,{from:n,to:e})):f instanceof Error?u(f):Xb(f)?u(Qr(2,{from:e,to:f})):(a&&r.enterCallbacks[s]===a&&typeof f=="function"&&a.push(f),o())},l=i(()=>t.call(r&&r.instances[s],e,n,c));let d=Promise.resolve(l);t.length<3&&(d=d.then(c)),d.catch(f=>u(f))})}function eu(t,e,n,r,s=i=>i()){const i=[];for(const a of t)for(const o in a.components){let u=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(pw(u)){const l=(u.__vccOpts||u)[e];l&&i.push(Ln(l,n,r,a,o,s))}else{let c=u();i.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${a.path}"`));const d=wb(l)?l.default:l;a.components[o]=d;const h=(d.__vccOpts||d)[e];return h&&Ln(h,n,r,a,o,s)()}))}}return i}function pw(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Od(t){const e=rn(Mc),n=rn(ap),r=xe(()=>{const u=Dr(t.to);return e.resolve(u)}),s=xe(()=>{const{matched:u}=r.value,{length:c}=u,l=u[c-1],d=n.matched;if(!l||!d.length)return-1;const f=d.findIndex(Yr.bind(null,l));if(f>-1)return f;const h=Pd(u[c-2]);return c>1&&Pd(l)===h&&d[d.length-1].path!==h?d.findIndex(Yr.bind(null,u[c-2])):f}),i=xe(()=>s.value>-1&&_w(n.params,r.value.params)),a=xe(()=>s.value>-1&&s.value===n.matched.length-1&&tp(n.params,r.value.params));function o(u={}){return yw(u)?e[Dr(t.replace)?"replace":"push"](Dr(t.to)).catch(ks):Promise.resolve()}return{route:r,href:xe(()=>r.value.href),isActive:i,isExactActive:a,navigate:o}}const mw=En({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Od,setup(t,{slots:e}){const n=ui(Od(t)),{options:r}=rn(Mc),s=xe(()=>({[Rd(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Rd(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:Ah("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),gw=mw;function yw(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function _w(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!Bt(s)||s.length!==r.length||r.some((i,a)=>i!==s[a]))return!1}return!0}function Pd(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Rd=(t,e,n)=>t??e??n,bw=En({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=rn(Du),s=xe(()=>t.route||r.value),i=rn(xd,0),a=xe(()=>{let c=Dr(i);const{matched:l}=s.value;let d;for(;(d=l[c])&&!d.components;)c++;return c}),o=xe(()=>s.value.matched[a.value]);Di(xd,xe(()=>a.value+1)),Di(hw,o),Di(Du,s);const u=Sc();return Ps(()=>[u.value,o.value,t.name],([c,l,d],[f,h,p])=>{l&&(l.instances[d]=c,h&&h!==l&&c&&c===f&&(l.leaveGuards.size||(l.leaveGuards=h.leaveGuards),l.updateGuards.size||(l.updateGuards=h.updateGuards))),c&&l&&(!h||!Yr(l,h)||!f)&&(l.enterCallbacks[d]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,l=t.name,d=o.value,f=d&&d.components[l];if(!f)return Cd(n.default,{Component:f,route:c});const h=d.props[l],p=h?h===!0?c.params:typeof h=="function"?h(c):h:null,_=Ah(f,ge({},p,e,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(d.instances[l]=null)},ref:u}));return Cd(n.default,{Component:_,route:c})||_}}});function Cd(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const ww=bw;function vw(t){const e=ow(t.routes,t),n=t.parseQuery||dw,r=t.stringifyQuery||Ad,s=t.history,i=fs(),a=fs(),o=fs(),u=sg(Rn);let c=Rn;Cr&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const l=Yo.bind(null,A=>""+A),d=Yo.bind(null,Nb),f=Yo.bind(null,Hs);function h(A,D){let N,q;return rp(A)?(N=e.getRecordMatcher(A),q=D):q=A,e.addRoute(q,N)}function p(A){const D=e.getRecordMatcher(A);D&&e.removeRoute(D)}function y(){return e.getRoutes().map(A=>A.record)}function _(A){return!!e.getRecordMatcher(A)}function w(A,D){if(D=ge({},D||u.value),typeof A=="string"){const g=Qo(n,A,D.path),b=e.resolve({path:g.path},D),x=s.createHref(g.fullPath);return ge(g,b,{params:f(b.params),hash:Hs(g.hash),redirectedFrom:void 0,href:x})}let N;if(A.path!=null)N=ge({},A,{path:Qo(n,A.path,D.path).path});else{const g=ge({},A.params);for(const b in g)g[b]==null&&delete g[b];N=ge({},A,{params:d(g)}),D.params=d(D.params)}const q=e.resolve(N,D),me=A.hash||"";q.params=l(f(q.params));const Oe=Lb(r,ge({},A,{hash:Tb(me),path:q.path})),m=s.createHref(Oe);return ge({fullPath:Oe,hash:me,query:r===Ad?fw(A.query):A.query||{}},q,{redirectedFrom:void 0,href:m})}function v(A){return typeof A=="string"?Qo(n,A,u.value.path):ge({},A)}function O(A,D){if(c!==A)return Qr(8,{from:D,to:A})}function U(A){return te(A)}function j(A){return U(ge(v(A),{replace:!0}))}function B(A){const D=A.matched[A.matched.length-1];if(D&&D.redirect){const{redirect:N}=D;let q=typeof N=="function"?N(A):N;return typeof q=="string"&&(q=q.includes("?")||q.includes("#")?q=v(q):{path:q},q.params={}),ge({query:A.query,hash:A.hash,params:q.path!=null?{}:A.params},q)}}function te(A,D){const N=c=w(A),q=u.value,me=A.state,Oe=A.force,m=A.replace===!0,g=B(N);if(g)return te(ge(v(g),{state:typeof g=="object"?ge({},me,g.state):me,force:Oe,replace:m}),D||N);const b=N;b.redirectedFrom=D;let x;return!Oe&&Mb(r,q,N)&&(x=Qr(16,{to:b,from:q}),zt(q,q,!0,!1)),(x?Promise.resolve(x):Se(b,q)).catch(E=>ln(E)?ln(E,2)?E:An(E):pe(E,b,q)).then(E=>{if(E){if(ln(E,2))return te(ge({replace:m},v(E.to),{state:typeof E.to=="object"?ge({},me,E.to.state):me,force:Oe}),D||b)}else E=pt(b,q,!0,m,me);return We(b,q,E),E})}function K(A,D){const N=O(A,D);return N?Promise.reject(N):Promise.resolve()}function z(A){const D=Sr.values().next().value;return D&&typeof D.runWithContext=="function"?D.runWithContext(A):A()}function Se(A,D){let N;const[q,me,Oe]=Ew(A,D);N=eu(q.reverse(),"beforeRouteLeave",A,D);for(const g of q)g.leaveGuards.forEach(b=>{N.push(Ln(b,A,D))});const m=K.bind(null,A,D);return N.push(m),Je(N).then(()=>{N=[];for(const g of i.list())N.push(Ln(g,A,D));return N.push(m),Je(N)}).then(()=>{N=eu(me,"beforeRouteUpdate",A,D);for(const g of me)g.updateGuards.forEach(b=>{N.push(Ln(b,A,D))});return N.push(m),Je(N)}).then(()=>{N=[];for(const g of Oe)if(g.beforeEnter)if(Bt(g.beforeEnter))for(const b of g.beforeEnter)N.push(Ln(b,A,D));else N.push(Ln(g.beforeEnter,A,D));return N.push(m),Je(N)}).then(()=>(A.matched.forEach(g=>g.enterCallbacks={}),N=eu(Oe,"beforeRouteEnter",A,D,z),N.push(m),Je(N))).then(()=>{N=[];for(const g of a.list())N.push(Ln(g,A,D));return N.push(m),Je(N)}).catch(g=>ln(g,8)?g:Promise.reject(g))}function We(A,D,N){o.list().forEach(q=>z(()=>q(A,D,N)))}function pt(A,D,N,q,me){const Oe=O(A,D);if(Oe)return Oe;const m=D===Rn,g=Cr?history.state:{};N&&(q||m?s.replace(A.fullPath,ge({scroll:m&&g&&g.scroll},me)):s.push(A.fullPath,me)),u.value=A,zt(A,D,N,m),An()}let wt;function Gn(){wt||(wt=s.listen((A,D,N)=>{if(!vi.listening)return;const q=w(A),me=B(q);if(me){te(ge(me,{replace:!0}),q).catch(ks);return}c=q;const Oe=u.value;Cr&&Vb(gd(Oe.fullPath,N.delta),Eo()),Se(q,Oe).catch(m=>ln(m,12)?m:ln(m,2)?(te(m.to,q).then(g=>{ln(g,20)&&!N.delta&&N.type===zs.pop&&s.go(-1,!1)}).catch(ks),Promise.reject()):(N.delta&&s.go(-N.delta,!1),pe(m,q,Oe))).then(m=>{m=m||pt(q,Oe,!1),m&&(N.delta&&!ln(m,8)?s.go(-N.delta,!1):N.type===zs.pop&&ln(m,20)&&s.go(-1,!1)),We(q,Oe,m)}).catch(ks)}))}let vt=fs(),he=fs(),_e;function pe(A,D,N){An(A);const q=he.list();return q.length?q.forEach(me=>me(A,D,N)):console.error(A),Promise.reject(A)}function cn(){return _e&&u.value!==Rn?Promise.resolve():new Promise((A,D)=>{vt.add([A,D])})}function An(A){return _e||(_e=!A,Gn(),vt.list().forEach(([D,N])=>A?N(A):D()),vt.reset()),A}function zt(A,D,N,q){const{scrollBehavior:me}=t;if(!Cr||!me)return Promise.resolve();const Oe=!N&&Zb(gd(A.fullPath,0))||(q||!N)&&history.state&&history.state.scroll||null;return xc().then(()=>me(A,D,Oe)).then(m=>m&&zb(m)).catch(m=>pe(m,A,D))}const it=A=>s.go(A);let Er;const Sr=new Set,vi={currentRoute:u,listening:!0,addRoute:h,removeRoute:p,hasRoute:_,getRoutes:y,resolve:w,options:t,push:U,replace:j,go:it,back:()=>it(-1),forward:()=>it(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:he.add,isReady:cn,install(A){const D=this;A.component("RouterLink",gw),A.component("RouterView",ww),A.config.globalProperties.$router=D,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>Dr(u)}),Cr&&!Er&&u.value===Rn&&(Er=!0,U(s.location).catch(me=>{}));const N={};for(const me in Rn)Object.defineProperty(N,me,{get:()=>u.value[me],enumerable:!0});A.provide(Mc,D),A.provide(ap,Vf(N)),A.provide(Du,u);const q=A.unmount;Sr.add(A),A.unmount=function(){Sr.delete(A),Sr.size<1&&(c=Rn,wt&&wt(),wt=null,u.value=Rn,Er=!1,_e=!1),q()}}};function Je(A){return A.reduce((D,N)=>D.then(()=>z(N)),Promise.resolve())}return vi}function Ew(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let a=0;a<i;a++){const o=e.matched[a];o&&(t.matched.find(c=>Yr(c,o))?r.push(o):n.push(o));const u=t.matched[a];u&&(e.matched.find(c=>Yr(c,u))||s.push(u))}return[n,r,s]}const Sw=En({setup(){const t=Kn(),e=xe(()=>t.requestsList);return{mainDataStore:t,requestsList:e}},data(){return{tagsList:go}},computed:{anotherRequestsList(){return this.requestsList.filter(t=>t.userId!=this.mainDataStore.userId)}},methods:{searchTagNameById(t){return this.tagsList.find(e=>e.id==t).name},requestDate(t){let e=t.getDate(),n=t.getMonth(),r=t.getFullYear(),s=t.getHours(),i=t.getMinutes();return s<10&&(s=`0${s}`),i<10&&(i=`0${i}`),e==new Date().getDate()&&n==new Date().getMonth()&&r==new Date().getFullYear()?`cегодня в ${s}:${i}`:(e<10&&(e=`0${e}`),n<10?n=`0${n+1}`:n=`${n+1}`,`${e}.${n}.${r} ${s}:${i}`)}}}),Aw={class:"request-list"},xw={class:"name"},Ow={class:"time"},Pw={class:"tags-list"},Rw={class:"tag"};function Cw(t,e,n,r,s,i){const a=Hn("router-link");return ie(),ye("div",Aw,[(ie(!0),ye(je,null,mn(t.anotherRequestsList,o=>(ie(),Un(a,{class:"requestItem",to:`request/${o.id}`},{default:nn(()=>[Y("div",xw,Ne(o.name),1),Y("div",Ow,"Размещено "+Ne(t.requestDate(o.time)),1),Y("div",Pw,[(ie(!0),ye(je,null,mn(o.tags,u=>(ie(),ye("div",Rw,Ne(t.searchTagNameById(u)),1))),256))])]),_:2},1032,["to"]))),256))])}const Tw=vr(Sw,[["render",Cw],["__scopeId","data-v-607a620a"]]),kw=En({setup(){const t=Kn(),e=t.setErrorText,n=xe(()=>t.userId);return{mainDataStore:t,setErrorText:e,userId:n}},props:{requestId:Number},data(){return{comment:"",phone:"",name:""}},methods:{async sendRespond(){if(this.comment.length==0)this.setErrorText("Введите комментарий");else if(this.phone.length==0)this.setErrorText("Введите свой телефон");else if(this.name.length==0)this.setErrorText("Введите свое имя");else{let t=await Ee.post("https://viribusunitis.ru/api/responses",{RequestId:this.requestId,UserId:this.userId,Comment:this.comment,Phone:this.phone,UserName:this.name});console.log(t)}},closeModalWindow(){this.$emit("closeModalWindow")}}}),Dc=t=>(ci("data-v-037a133a"),t=t(),li(),t),Iw={class:"respondModalWindow"},Nw=Dc(()=>Y("div",{class:"fieldName"},"Комментарий:",-1)),$w=Dc(()=>Y("div",{class:"fieldName"},"Телефон для связи:",-1)),jw=Dc(()=>Y("div",{class:"fieldName"},"Ваше имя:",-1));function Lw(t,e,n,r,s,i){return ie(),ye("div",Iw,[Y("div",{class:"close",onClick:e[0]||(e[0]=(...a)=>t.closeModalWindow&&t.closeModalWindow(...a))},"Закрыть"),Nw,Br(Y("textarea",{class:"fieldInput","onUpdate:modelValue":e[1]||(e[1]=a=>t.comment=a),placeholder:"Напишите тут свой комментарий к ответу на просьбу"},null,512),[[qr,t.comment]]),$w,Br(Y("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.phone=a),placeholder:"Введите свой телефон для связи",class:"fieldName"},null,512),[[qr,t.phone]]),jw,Br(Y("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.name=a),placeholder:"Ввведите ваше имя",class:"fieldName"},null,512),[[qr,t.name]]),Y("div",{class:"sendRespond",onClick:e[4]||(e[4]=(...a)=>t.sendRespond&&t.sendRespond(...a))},"Отправить отклик")])}const Mw=vr(kw,[["render",Lw],["__scopeId","data-v-037a133a"]]),Dw=En({setup(){const t=Kn(),e=xe(()=>t.requestsList);return{mainDataStore:t,requestsList:e}},created(){this.$route.name=="myRequest"?this.mainDataStore.setNameOfPage("Мой запрос №"+this.$route.params.id):this.mainDataStore.setNameOfPage("Запрос №"+this.$route.params.id);let t=this.$route.params.id;this.request={...this.requestsList.find(e=>e.id==t)}},data(){return{request:null,tagsList:go,respondModalWindowIsShow:!1}},methods:{searchTagNameById(t){return this.tagsList.find(e=>e.id==t).name},sendedRespond(){this.respondModalWindowIsShow=!1},closeModalWindow(){this.respondModalWindowIsShow=!1},openModalWindow(){this.respondModalWindowIsShow=!0},requestDate(t){let e=t.getDate(),n=t.getMonth(),r=t.getFullYear(),s=t.getHours(),i=t.getMinutes();return s<10&&(s=`0${s}`),i<10&&(i=`0${i}`),e==new Date().getDate()&&n==new Date().getMonth()&&r==new Date().getFullYear()?`cегодня в ${s}:${i}`:(e<10&&(e=`0${e}`),n<10?n=`0${n+1}`:n=`${n+1}`,`${e}.${n}.${r} ${s}:${i}`)},async deleteRequest(){await Ee.delete(`https://viribusunitis.ru/api/requests/${this.request.id}`),this.mainDataStore.requestsList=this.mainDataStore.requestsList.filter(t=>t.id!=this.request.id),this.$router.push({replace:!0,path:"/myRequestsResponses"})}},computed:{backPageURL(){return this.$route.name=="myRequest"?"/myRequestsResponses":"/"}},components:{respondModalWindow:Mw}}),So="data:image/svg+xml,%3csvg%20width='28'%20height='28'%20viewBox='0%200%2028%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.4217%2021.8282C18.5311%2021.7197%2018.6179%2021.5907%2018.6771%2021.4485C18.7364%2021.3063%2018.7668%2021.1539%2018.7668%2020.9998C18.7668%2020.8458%2018.7364%2020.6933%2018.6771%2020.5512C18.6179%2020.409%2018.5311%2020.28%2018.4217%2020.1715L13.0784%2014.8282C12.9691%2014.7197%2012.8823%2014.5907%2012.8231%2014.4485C12.7638%2014.3063%2012.7333%2014.1539%2012.7333%2013.9998C12.7333%2013.8458%2012.7638%2013.6933%2012.8231%2013.5512C12.8823%2013.409%2012.9691%2013.28%2013.0784%2013.1715L18.4217%207.82817C18.5311%207.71971%2018.6179%207.59068%2018.6771%207.44851C18.7364%207.30634%2018.7668%207.15385%2018.7668%206.99984C18.7668%206.84582%2018.7364%206.69333%2018.6771%206.55116C18.6179%206.40899%2018.5311%206.27996%2018.4217%206.1715C18.2032%205.95421%2017.9075%205.83224%2017.5993%205.83224C17.291%205.83224%2016.9953%205.95421%2016.7768%206.1715L11.4218%2011.5265C10.7663%2012.1828%2010.3982%2013.0723%2010.3982%2013.9998C10.3982%2014.9273%2010.7663%2015.8169%2011.4218%2016.4732L16.7768%2021.8282C16.9953%2022.0455%2017.291%2022.1674%2017.5992%2022.1674C17.9075%2022.1674%2018.2032%2022.0455%2018.4217%2021.8282Z'%20fill='%23374957'/%3e%3c/svg%3e",Fw=t=>(ci("data-v-1fba4933"),t=t(),li(),t),Bw={class:"request"},Uw=Fw(()=>Y("img",{src:So},null,-1)),qw={key:0,class:"userFullName"},Hw={class:"name"},zw={class:"time"},Vw={class:"tags-list"},Zw={class:"tag"},Ww={class:"comment"};function Jw(t,e,n,r,s,i){const a=Hn("router-link"),o=Hn("respondModalWindow");return ie(),ye("div",Bw,[Ve(a,{class:"backButton",to:t.backPageURL},{default:nn(()=>[Uw]),_:1},8,["to"]),t.$route.name!="myRequest"?(ie(),ye("div",qw,"Заказчик: "+Ne(t.request.userName),1)):At("",!0),Y("div",Hw,"Название запроса: "+Ne(t.request.name),1),Y("div",zw,"Размещено "+Ne(t.requestDate(t.request.time)),1),Y("div",Vw,[(ie(!0),ye(je,null,mn(t.request.tags,u=>(ie(),ye("div",Zw,Ne(t.searchTagNameById(u)),1))),256))]),Y("div",Ww,"Описание запроса: "+Ne(t.request.comment),1),!t.respondModalWindowIsShow&&t.$route.name!="myRequest"?(ie(),ye("div",{key:1,class:"respondButton",onClick:e[0]||(e[0]=(...u)=>t.openModalWindow&&t.openModalWindow(...u))},"Откликнуться")):At("",!0),!t.respondModalWindowIsShow&&t.$route.name=="myRequest"?(ie(),ye("div",{key:2,class:"respondButton",onClick:e[1]||(e[1]=(...u)=>t.deleteRequest&&t.deleteRequest(...u))},"Удалить")):At("",!0),t.respondModalWindowIsShow?(ie(),Un(o,{key:3,onSendedRespond:t.sendedRespond,onCloseModalWindow:t.closeModalWindow,requestId:t.request.id},null,8,["onSendedRespond","onCloseModalWindow","requestId"])):At("",!0)])}const Td=vr(Dw,[["render",Jw],["__scopeId","data-v-1fba4933"]]),Kw=En({setup(){return{mainDataStore:Kn()}},data(){return{responseId:0,request:null}},created(){this.responseId=Number(this.$route.params.id),console.log(this.mainDataStore.myResponsesList.filter(t=>t.id==this.responseId))},methods:{deleteResponse(){Ee.delete(`https://viribusunitis.ru/api/responses/${this.responseId}`),this.mainDataStore.myResponsesList=this.mainDataStore.myResponsesList.filter(t=>t.id!=this.responseId),this.$router.push({replace:!0,path:"/myRequestsResponses"})}}}),Gw=t=>(ci("data-v-f4cfd53b"),t=t(),li(),t),Xw={key:0,class:"response"},Yw=Gw(()=>Y("img",{src:So},null,-1)),Qw={key:0,class:"userFullName"},ev={class:"name"},tv={class:"time"},nv={class:"tags-list"},rv={class:"tag"},sv={class:"comment"};function iv(t,e,n,r,s,i){const a=Hn("router-link");return t.request!=null?(ie(),ye("div",Xw,[Ve(a,{class:"backButton",to:"/myRequestsResponses"},{default:nn(()=>[Yw]),_:1}),t.$route.name!="myRequest"?(ie(),ye("div",Qw,"Заказчик: "+Ne(t.request.userName),1)):At("",!0),Y("div",ev,"Название запроса: "+Ne(t.request.name),1),Y("div",tv,"Размещено "+Ne(t.requestDate(t.request.time)),1),Y("div",nv,[(ie(!0),ye(je,null,mn(t.request.tags,o=>(ie(),ye("div",rv,Ne(t.searchTagNameById(o)),1))),256))]),Y("div",sv,"Описание запроса: "+Ne(t.request.comment),1),Y("div",{class:"respondButton",onClick:e[0]||(e[0]=(...o)=>t.deleteResponse&&t.deleteResponse(...o))},"Удалить")])):At("",!0)}const av=vr(Kw,[["render",iv],["__scopeId","data-v-f4cfd53b"]]);function kd(t,e=Fc){t=t.trim();const n=/```(json)?(.*)```/s.exec(t);return e(n?n[2]:t)}function Fc(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const n=[];let r=!1,s=!1;for(let i of t){if(r)i==='"'&&!s?r=!1:i===`
`&&!s?i="\\n":i==="\\"?s=!s:s=!1;else if(i==='"')r=!0,s=!1;else if(i==="{")n.push("}");else if(i==="[")n.push("]");else if(i==="}"||i==="]")if(n&&n[n.length-1]===i)n.pop();else return null;e+=i}r&&(e+='"');for(let i=n.length-1;i>=0;i-=1)e+=n[i];try{return JSON.parse(e)}catch{return null}}function Bc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ov=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const uv=Bc(ov);var op={exports:{}};const cv=/[\p{Lu}]/u,lv=/[\p{Ll}]/u,Id=/^[\p{Lu}](?![\p{Lu}])/gu,up=/([\p{Alpha}\p{N}_]|$)/u,cp=/[_.\- ]+/,dv=new RegExp("^"+cp.source),Nd=new RegExp(cp.source+up.source,"gu"),$d=new RegExp("\\d+"+up.source,"gu"),fv=(t,e,n)=>{let r=!1,s=!1,i=!1;for(let a=0;a<t.length;a++){const o=t[a];r&&cv.test(o)?(t=t.slice(0,a)+"-"+t.slice(a),r=!1,i=s,s=!0,a++):s&&i&&lv.test(o)?(t=t.slice(0,a-1)+"-"+t.slice(a-1),i=s,s=!1,r=!0):(r=e(o)===o&&n(o)!==o,i=s,s=n(o)===o&&e(o)!==o)}return t},hv=(t,e)=>(Id.lastIndex=0,t.replace(Id,n=>e(n))),pv=(t,e)=>(Nd.lastIndex=0,$d.lastIndex=0,t.replace(Nd,(n,r)=>e(r)).replace($d,n=>e(n))),lp=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(i=>i.trim()).filter(i=>i.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?i=>i.toLowerCase():i=>i.toLocaleLowerCase(e.locale),r=e.locale===!1?i=>i.toUpperCase():i=>i.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?r(t):n(t):(t!==n(t)&&(t=fv(t,n,r)),t=t.replace(dv,""),e.preserveConsecutiveUppercase?t=hv(t,n):t=n(t),e.pascalCase&&(t=r(t.charAt(0))+t.slice(1)),pv(t,r))};op.exports=lp;op.exports.default=lp;function mv(t,e){return(e==null?void 0:e[t])||uv(t)}function gv(t,e,n){const r={};for(const s in t)Object.hasOwn(t,s)&&(r[e(s,n)]=t[s]);return r}function jd(t){return Array.isArray(t)?[...t]:{...t}}function yv(t,e){const n=jd(t);for(const[r,s]of Object.entries(e)){const[i,...a]=r.split(".").reverse();let o=n;for(const u of a.reverse()){if(o[u]===void 0)break;o[u]=jd(o[u]),o=o[u]}o[i]!==void 0&&(o[i]={lc:1,type:"secret",id:[s]})}return n}function dp(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class mr{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,dp(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...n){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof mr||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},n={},r=Object.keys(this.lc_kwargs).reduce((s,i)=>(s[i]=i in this?this[i]:this.lc_kwargs[i],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(n,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));return Object.keys(n).forEach(s=>{let i=this,a=r;const[o,...u]=s.split(".").reverse();for(const c of u.reverse()){if(!(c in i)||i[c]===void 0)return;(!(c in a)||a[c]===void 0)&&(typeof i[c]=="object"&&i[c]!=null?a[c]={}:Array.isArray(i[c])&&(a[c]=[])),i=i[c],a=a[c]}o in i&&i[o]!==void 0&&(a[o]=a[o]||i[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:gv(Object.keys(n).length?yv(r,n):r,mv,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function is(t,e){return typeof t=="string"?typeof e=="string"?t+e:[{type:"text",text:t},...e]:Array.isArray(e)?[...t,...e]:[...t,{type:"text",text:e}]}class pi extends mr{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}constructor(e,n){typeof e=="string"&&(e={content:e,additional_kwargs:n,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}function ht(t,e){const n={...t};for(const[r,s]of Object.entries(e))if(n[r]==null)n[r]=s;else{if(s==null)continue;if(typeof n[r]!=typeof s||Array.isArray(n[r])!==Array.isArray(s))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof n[r]=="string")n[r]=n[r]+s;else if(!Array.isArray(n[r])&&typeof n[r]=="object")n[r]=ht(n[r],s);else if(Array.isArray(n[r]))n[r]=fp(n[r],s);else{if(n[r]===s)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return n}function fp(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const n=[...t];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const s=n.findIndex(i=>i.index===r.index);s!==-1?n[s]=ht(n[s],r):n.push(r)}else n.push(r);return n}}}class as extends pi{}function Uc(t){return typeof(t==null?void 0:t._getType)=="function"}function _v(t){return Uc(t)&&typeof t.concat=="function"}class qc extends as{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new qc({content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata),tool_call_id:this.tool_call_id})}}function bv(t){const e=[],n=[];for(const r of t)if(r.function){const s=r.function.name;try{const i=JSON.parse(r.function.arguments),a={name:s||"",args:i||{},id:r.id};e.push(a)}catch{n.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,n]}class hp extends pi{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,n){var s;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:n??{}};else{r=e;const i=(s=r.additional_kwargs)==null?void 0:s.tool_calls,a=r.tool_calls;i!=null&&i.length>0&&(a===void 0||a.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(i!=null&&a===void 0){const[o,u]=bv(i);r.tool_calls=o??[],r.invalid_tool_calls=u??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls)}static lc_name(){return"AIMessage"}_getType(){return"ai"}}function wv(t){return t._getType()==="ai"}class mi extends as{constructor(e){let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)n={...e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else{const r=[],s=[];for(const i of e.tool_call_chunks){let a={};try{if(a=Fc(i.args??"{}")??{},typeof a!="object"||Array.isArray(a))throw new Error("Malformed tool call chunk args.");r.push({name:i.name??"",args:a,id:i.id})}catch{s.push({name:i.name,args:i.args,id:i.id,error:"Malformed args."})}}n={...e,tool_calls:r,invalid_tool_calls:s}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.tool_call_chunks=(n==null?void 0:n.tool_call_chunks)??this.tool_call_chunks,this.tool_calls=(n==null?void 0:n.tool_calls)??this.tool_calls,this.invalid_tool_calls=(n==null?void 0:n.invalid_tool_calls)??this.invalid_tool_calls}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}concat(e){const n={content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata),tool_call_chunks:[]};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const r=fp(this.tool_call_chunks,e.tool_call_chunks);r!==void 0&&r.length>0&&(n.tool_call_chunks=r)}return new mi(n)}}class gi extends pi{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return gi}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}}class Ao extends as{static lc_name(){return"ChatMessageChunk"}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Ao({content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata),role:this.role})}}class xo extends as{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new xo({content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata),name:this.name??""})}}class es extends pi{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Oo extends as{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Oo({content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata)})}}class vv extends pi{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class Po extends as{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new Po({content:is(this.content,e.content),additional_kwargs:ht(this.additional_kwargs,e.additional_kwargs),response_metadata:ht(this.response_metadata,e.response_metadata)})}}function ms(t){if(typeof t=="string")return new es(t);if(Uc(t))return t;const[e,n]=t;if(e==="human"||e==="user")return new es({content:n});if(e==="ai"||e==="assistant")return new hp({content:n});if(e==="system")return new vv({content:n});throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}function pp(t,e="Human",n="AI"){const r=[];for(const s of t){let i;if(s._getType()==="human")i=e;else if(s._getType()==="ai")i=n;else if(s._getType()==="system")i="System";else if(s._getType()==="function")i="Function";else if(s._getType()==="tool")i="Tool";else if(s._getType()==="generic")i=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const a=s.name?`${s.name}, `:"";r.push(`${i}: ${a}${s.content}`)}return r.join(`
`)}function Ev(t){const e=t._getType();if(e==="human")return new Oo({...t});if(e==="ai")return new mi({...t});if(e==="system")return new Po({...t});if(e==="function")return new xo({...t});if(gi.isInstance(t))return new Ao({...t});throw new Error("Unknown message type.")}const Tr="4.38.2";let Ld=!1,Ns,mp,gp,Fu,yp,_p,bp,wp,vp;function Sv(t,e={auto:!1}){if(Ld)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Ns)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Ns}'\``);Ld=e.auto,Ns=t.kind,mp=t.fetch,t.Request,t.Response,t.Headers,gp=t.FormData,t.Blob,Fu=t.File,yp=t.ReadableStream,_p=t.getMultipartRequestOptions,bp=t.getDefaultAgent,wp=t.fileFromPath,vp=t.isFsReadStream}class Av{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function xv({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Av(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Ns||Sv(xv(),{auto:!0});let oe=class extends Error{},rt=class Bu extends oe{constructor(e,n,r,s){super(`${Bu.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const i=n;this.error=i,this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e)return new yi({cause:qu(n)});const i=n==null?void 0:n.error;return e===400?new Hc(e,i,r,s):e===401?new zc(e,i,r,s):e===403?new Vc(e,i,r,s):e===404?new Zc(e,i,r,s):e===409?new Wc(e,i,r,s):e===422?new Jc(e,i,r,s):e===429?new Kc(e,i,r,s):e>=500?new Gc(e,i,r,s):new Bu(e,i,r,s)}},lt=class extends rt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}},yi=class extends rt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}},Ro=class extends yi{constructor({message:e}={}){super({message:e??"Request timed out."})}},Hc=class extends rt{constructor(){super(...arguments),this.status=400}},zc=class extends rt{constructor(){super(...arguments),this.status=401}},Vc=class extends rt{constructor(){super(...arguments),this.status=403}},Zc=class extends rt{constructor(){super(...arguments),this.status=404}},Wc=class extends rt{constructor(){super(...arguments),this.status=409}},Jc=class extends rt{constructor(){super(...arguments),this.status=422}},Kc=class extends rt{constructor(){super(...arguments),this.status=429}},Gc=class extends rt{};const Ov=Object.freeze(Object.defineProperty({__proto__:null,APIConnectionError:yi,APIConnectionTimeoutError:Ro,APIError:rt,APIUserAbortError:lt,AuthenticationError:zc,BadRequestError:Hc,ConflictError:Wc,InternalServerError:Gc,NotFoundError:Zc,OpenAIError:oe,PermissionDeniedError:Vc,RateLimitError:Kc,UnprocessableEntityError:Jc},Symbol.toStringTag,{value:"Module"}));class en{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of Pv(e,n))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(o&&o.error)throw new rt(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(a.event=="error")throw new rt(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||n.abort()}}return new en(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const a=new gr,o=Ep(e);for await(const u of o)for(const c of a.decode(u))yield c;for(const u of a.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||n.abort()}}return new en(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),n.push(a)}return i.shift()}});return[new en(()=>s(e),this.controller),new en(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new yp({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await n.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Pv(t,e){if(!t.body)throw e.abort(),new oe("Attempted to iterate over a response with no body");const n=new Tv,r=new gr,s=Ep(t.body);for await(const i of Rv(s))for(const a of r.decode(i)){const o=n.decode(a);o&&(yield o)}for(const i of r.flush()){const a=n.decode(i);a&&(yield a)}}async function*Rv(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Cv(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Cv(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class Tv{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=kv(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}class gr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=gr.NEWLINE_CHARS.has(n[n.length-1]||"");let s=n.split(gr.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new oe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new oe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new oe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}gr.NEWLINE_CHARS=new Set([`
`,"\r"]);gr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function kv(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function Ep(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Sp=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Ap=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&xp(t),xp=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Iv=t=>Ap(t)||Sp(t)||vp(t);async function Op(t,e,n){var s;if(t=await t,n??(n=Ap(t)?{lastModified:t.lastModified,type:t.type}:{}),Sp(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new Fu([i],e,n)}const r=await Nv(t);if(e||(e=jv(t)??"unknown_file"),!n.type){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new Fu(r,e,n)}async function Nv(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(xp(t))e.push(await t.arrayBuffer());else if(Lv(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${$v(t)}`);return e}function $v(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function jv(t){var e;return tu(t.name)||tu(t.filename)||((e=tu(t.path))==null?void 0:e.split(/[\\/]/).pop())}const tu=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Lv=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Md=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Vs=async t=>{const e=await Mv(t.body);return _p(e,t)},Mv=async t=>{const e=new gp;return await Promise.all(Object.entries(t||{}).map(([n,r])=>Uu(e,n,r))),e},Uu=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Iv(n)){const r=await Op(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>Uu(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>Uu(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Hr={},Dv=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Fv=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ri;async function Pp(t){const{response:e}=t;if(t.options.stream)return zr("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):en.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const i=await e.json();return zr("response",e.status,e.url,e.headers,i),i}const s=await e.text();return zr("response",e.status,e.url,e.headers,s),s}class Co extends Promise{constructor(e,n=Pp){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Co(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Bv{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=nu("maxRetries",n),this.timeout=nu("timeout",r),this.httpAgent=s,this.fetch=i??mp}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Zv(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Gv()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(s=>({method:e,path:n,...s})))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){var p;const{method:n,path:r,query:s,headers:i={}}=e,a=Md(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(a),u=this.buildURL(r,s);"timeout"in e&&nu("timeout",e.timeout);const c=e.timeout??this.timeout,l=e.httpAgent??this.httpAgent??bp(u),d=c+1e3;typeof((p=l==null?void 0:l.options)==null?void 0:p.timeout)=="number"&&d>(l.options.timeout??0)&&(l.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:i,contentLength:o});return{req:{method:n,...a&&{body:a},headers:f,...l&&{agent:l},signal:e.signal??null},url:u,timeout:c}}buildHeaders({options:e,headers:n,contentLength:r}){const s={};r&&(s["content-length"]=r);const i=this.defaultHeaders(e);return Ud(s,i),Ud(s,n),Md(e.body)&&Ns!=="node"&&delete s["content-type"],this.validateHeaders(s,n),s}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return rt.generate(e,n,r,s)}request(e,n=null){return new Co(this.makeRequest(e,n))}async makeRequest(e,n){var l,d;const r=await e;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:s,url:i,timeout:a}=this.buildRequest(r);if(await this.prepareRequest(s,{url:i,options:r}),zr("request",i,r,s.headers),(l=r.signal)!=null&&l.aborted)throw new lt;const o=new AbortController,u=await this.fetchWithTimeout(i,s,a,o).catch(qu);if(u instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new lt;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new Ro:new yi({cause:u})}const c=qv(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const w=`retrying, ${n} attempts remaining`;return zr(`response (error; ${w})`,u.status,i,c),this.retryRequest(r,n,c)}const f=await u.text().catch(w=>qu(w).message),h=Wv(f),p=h?void 0:f;throw zr(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,i,c,p),this.makeStatusError(u.status,h,p,c)}return{response:u,options:r,controller:o}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new Uv(this,r,e)}buildURL(e,n){const r=Kv(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Cp(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new oe(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...a}=n||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,o)}return await _i(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Tr}`}}class Rp{constructor(e,n,r,s){Ri.set(this,void 0),Dv(this,Ri,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new oe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await Fv(this,Ri,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ri=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Uv extends Co{constructor(e,n,r){super(n,async s=>new r(e,s.response,await Pp(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const qv=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),Hv={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},bt=t=>typeof t=="object"&&t!==null&&!Cp(t)&&Object.keys(t).every(e=>Tp(Hv,e)),zv=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":Fd(Deno.build.os),"X-Stainless-Arch":Dd(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":Fd(process.platform),"X-Stainless-Arch":Dd(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=Vv();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Vv(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Dd=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Fd=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Bd;const Zv=()=>Bd??(Bd=zv()),Wv=t=>{try{return JSON.parse(t)}catch{return}},Jv=new RegExp("^(?:[a-z]+:)?//","i"),Kv=t=>Jv.test(t),_i=t=>new Promise(e=>setTimeout(e,t)),nu=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new oe(`${t} must be an integer`);if(e<0)throw new oe(`${t} must be a positive integer`);return e},qu=t=>t instanceof Error?t:new Error(t),Ci=t=>{var e,n,r,s;if(typeof process<"u")return((e=Hr==null?void 0:Hr[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};function Cp(t){if(!t)return!0;for(const e in t)return!1;return!0}function Tp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ud(t,e){for(const n in e){if(!Tp(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}function zr(t,...e){typeof process<"u"&&(Hr==null?void 0:Hr.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const Gv=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Xv=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function qd(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Xc extends Rp{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ht extends Rp{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class ve{constructor(e){this._client=e}}let da=class extends ve{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}};da||(da={});let fa=class extends ve{constructor(){super(...arguments),this.completions=new da(this._client)}};(function(t){t.Completions=da})(fa||(fa={}));class ha extends ve{create(e,n){return this._client.post("/audio/speech",{body:e,...n,__binaryResponse:!0})}}ha||(ha={});class pa extends ve{create(e,n){return this._client.post("/audio/transcriptions",Vs({body:e,...n}))}}pa||(pa={});class ma extends ve{create(e,n){return this._client.post("/audio/translations",Vs({body:e,...n}))}}ma||(ma={});class ga extends ve{constructor(){super(...arguments),this.transcriptions=new pa(this._client),this.translations=new ma(this._client),this.speech=new ha(this._client)}}(function(t){t.Transcriptions=pa,t.Translations=ma,t.Speech=ha})(ga||(ga={}));class ya extends ve{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return bt(e)?this.list({},e):this._client.getAPIList("/batches",Yc,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Yc extends Ht{}(function(t){t.BatchesPage=Yc})(ya||(ya={}));class _a extends ve{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return bt(e)?this.list({},e):this._client.getAPIList("/assistants",Qc,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Qc extends Ht{}(function(t){t.AssistantsPage=Qc})(_a||(_a={}));function Hd(t){return typeof t.parse=="function"}const Vr=t=>(t==null?void 0:t.role)==="assistant",kp=t=>(t==null?void 0:t.role)==="function",Ip=t=>(t==null?void 0:t.role)==="tool";var Rt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},se=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ke,Vi,Zi,gs,ys,Wi,_s,hn,bs,Ji,Ki,kr,Hu,ba,zu,Vu,Zu,Wu,Np,Ju;const zd=10;class $p{constructor(){Ke.add(this),this.controller=new AbortController,Vi.set(this,void 0),Zi.set(this,()=>{}),gs.set(this,()=>{}),ys.set(this,void 0),Wi.set(this,()=>{}),_s.set(this,()=>{}),hn.set(this,{}),this._chatCompletions=[],this.messages=[],bs.set(this,!1),Ji.set(this,!1),Ki.set(this,!1),kr.set(this,!1),Wu.set(this,e=>{if(Rt(this,Ji,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new lt),e instanceof lt)return Rt(this,Ki,!0,"f"),this._emit("abort",e);if(e instanceof oe)return this._emit("error",e);if(e instanceof Error){const n=new oe(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new oe(String(e)))}),Rt(this,Vi,new Promise((e,n)=>{Rt(this,Zi,e,"f"),Rt(this,gs,n,"f")}),"f"),Rt(this,ys,new Promise((e,n)=>{Rt(this,Wi,e,"f"),Rt(this,_s,n,"f")}),"f"),se(this,Vi,"f").catch(()=>{}),se(this,ys,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},se(this,Wu,"f"))},0)}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(kp(e)||Ip(e))&&e.content)this._emit("functionCallResult",e.content);else if(Vr(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Vr(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}_connected(){this.ended||(se(this,Zi,"f").call(this),this._emit("connect"))}get ended(){return se(this,bs,"f")}get errored(){return se(this,Ji,"f")}get aborted(){return se(this,Ki,"f")}abort(){this.controller.abort()}on(e,n){return(se(this,hn,"f")[e]||(se(this,hn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=se(this,hn,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(se(this,hn,"f")[e]||(se(this,hn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Rt(this,kr,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Rt(this,kr,!0,"f"),await se(this,ys,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new oe("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),se(this,Ke,"m",Hu).call(this)}async finalMessage(){return await this.done(),se(this,Ke,"m",ba).call(this)}async finalFunctionCall(){return await this.done(),se(this,Ke,"m",zu).call(this)}async finalFunctionCallResult(){return await this.done(),se(this,Ke,"m",Vu).call(this)}async totalUsage(){return await this.done(),se(this,Ke,"m",Zu).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...n){if(se(this,bs,"f"))return;e==="end"&&(Rt(this,bs,!0,"f"),se(this,Wi,"f").call(this));const r=se(this,hn,"f")[e];if(r&&(se(this,hn,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!se(this,kr,"f")&&!(r!=null&&r.length)&&Promise.reject(s),se(this,gs,"f").call(this,s),se(this,_s,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!se(this,kr,"f")&&!(r!=null&&r.length)&&Promise.reject(s),se(this,gs,"f").call(this,s),se(this,_s,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=se(this,Ke,"m",ba).call(this);n&&this._emit("finalMessage",n);const r=se(this,Ke,"m",Hu).call(this);r&&this._emit("finalContent",r);const s=se(this,Ke,"m",zu).call(this);s&&this._emit("finalFunctionCall",s);const i=se(this,Ke,"m",Vu).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",se(this,Ke,"m",Zu).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),se(this,Ke,"m",Np).call(this,n);const i=await e.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:a,...o}=n,u=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=zd}=r||{},l={};for(const h of n.functions)l[h.name||h.function.name]=h;const d=n.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of n.messages)this._addMessage(h,!1);for(let h=0;h<c;++h){const y=(f=(await this._createChatCompletion(e,{...o,function_call:i,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!y)throw new oe("missing message in ChatCompletion response");if(!y.function_call)return;const{name:_,arguments:w}=y.function_call,v=l[_];if(v){if(u&&u!==_){const B=`Invalid function_call: ${JSON.stringify(_)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,name:_,content:B});continue}}else{const B=`Invalid function_call: ${JSON.stringify(_)}. Available options are: ${d.map(te=>JSON.stringify(te.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:_,content:B});continue}let O;try{O=Hd(v)?await v.parse(w):w}catch(B){this._addMessage({role:s,name:_,content:B instanceof Error?B.message:String(B)});continue}const U=await v.function(O,this),j=se(this,Ke,"m",Ju).call(this,U);if(this._addMessage({role:s,name:_,content:j}),u)return}}async _runTools(e,n,r){var f,h;const s="tool",{tool_choice:i="auto",stream:a,...o}=n,u=typeof i!="string"&&((f=i==null?void 0:i.function)==null?void 0:f.name),{maxChatCompletions:c=zd}=r||{},l={};for(const p of n.tools)p.type==="function"&&(l[p.function.name||p.function.function.name]=p.function);const d="tools"in n?n.tools.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description}}:p):void 0;for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<c;++p){const _=(h=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:d,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!_)throw new oe("missing message in ChatCompletion response");if(!_.tool_calls)return;for(const w of _.tool_calls){if(w.type!=="function")continue;const v=w.id,{name:O,arguments:U}=w.function,j=l[O];if(j){if(u&&u!==O){const z=`Invalid tool_call: ${JSON.stringify(O)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,tool_call_id:v,content:z});continue}}else{const z=`Invalid tool_call: ${JSON.stringify(O)}. Available options are: ${d.map(Se=>JSON.stringify(Se.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:v,content:z});continue}let B;try{B=Hd(j)?await j.parse(U):U}catch(z){const Se=z instanceof Error?z.message:String(z);this._addMessage({role:s,tool_call_id:v,content:Se});continue}const te=await j.function(B,this),K=se(this,Ke,"m",Ju).call(this,te);if(this._addMessage({role:s,tool_call_id:v,content:K}),u)return}}}}Vi=new WeakMap,Zi=new WeakMap,gs=new WeakMap,ys=new WeakMap,Wi=new WeakMap,_s=new WeakMap,hn=new WeakMap,bs=new WeakMap,Ji=new WeakMap,Ki=new WeakMap,kr=new WeakMap,Wu=new WeakMap,Ke=new WeakSet,Hu=function(){return se(this,Ke,"m",ba).call(this).content??null},ba=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Vr(n))return{...n,content:n.content??null}}throw new oe("stream ended without producing a ChatCompletionMessage with role=assistant")},zu=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Vr(s)&&(s!=null&&s.function_call))return s.function_call;if(Vr(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},Vu=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(kp(n)&&n.content!=null||Ip(n)&&n.content!=null&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},Zu=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Np=function(e){if(e.n!=null&&e.n>1)throw new oe("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ju=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Zs extends $p{static runFunctions(e,n,r){const s=new Zs,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Zs,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e){super._addMessage(e),Vr(e)&&e.content&&this._emit("content",e.content)}}var Ct=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ru=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Wt,Cn,su,iu,Ti,Vd;class Ws extends $p{constructor(){super(...arguments),Wt.add(this),Cn.set(this,void 0)}get currentChatCompletionSnapshot(){return Ct(this,Cn,"f")}static fromReadableStream(e){const n=new Ws;return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Ws;return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ct(this,Wt,"m",su).call(this);const i=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)Ct(this,Wt,"m",iu).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new lt;return this._addChatCompletion(Ct(this,Wt,"m",Ti).call(this))}async _fromReadableStream(e,n){var a;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ct(this,Wt,"m",su).call(this),this._connected();const s=en.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(Ct(this,Wt,"m",Ti).call(this)),Ct(this,Wt,"m",iu).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new lt;return this._addChatCompletion(Ct(this,Wt,"m",Ti).call(this))}[(Cn=new WeakMap,Wt=new WeakSet,su=function(){this.ended||ru(this,Cn,void 0,"f")},iu=function(n){var a,o,u;if(this.ended)return;const r=Ct(this,Wt,"m",Vd).call(this,n);this._emit("chunk",n,r);const s=(o=(a=n.choices[0])==null?void 0:a.delta)==null?void 0:o.content,i=(u=r.choices[0])==null?void 0:u.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},Ti=function(){if(this.ended)throw new oe("stream has ended, this shouldn't happen");const n=Ct(this,Cn,"f");if(!n)throw new oe("request ended without sending any chunks");return ru(this,Cn,void 0,"f"),Yv(n)},Vd=function(n){var r,s,i;let a=Ct(this,Cn,"f");const{choices:o,...u}=n;a?Object.assign(a,u):a=ru(this,Cn,{...u,choices:[]},"f");for(const{delta:c,finish_reason:l,index:d,logprobs:f=null,...h}of n.choices){let p=a.choices[d];if(p||(p=a.choices[d]={finish_reason:l,index:d,message:{},logprobs:f,...h}),f)if(!p.logprobs)p.logprobs=Object.assign({},f);else{const{content:U,...j}=f;Object.assign(p.logprobs,j),U&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...U))}if(l&&(p.finish_reason=l),Object.assign(p,h),!c)continue;const{content:y,function_call:_,role:w,tool_calls:v,...O}=c;if(Object.assign(p.message,O),y&&(p.message.content=(p.message.content||"")+y),w&&(p.message.role=w),_&&(p.message.function_call?(_.name&&(p.message.function_call.name=_.name),_.arguments&&((s=p.message.function_call).arguments??(s.arguments=""),p.message.function_call.arguments+=_.arguments)):p.message.function_call=_),v){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:U,id:j,type:B,function:te,...K}of v){const z=(i=p.message.tool_calls)[U]??(i[U]={});Object.assign(z,K),j&&(z.id=j),B&&(z.type=B),te&&(z.function??(z.function={arguments:""})),te!=null&&te.name&&(z.function.name=te.name),te!=null&&te.arguments&&(z.function.arguments+=te.arguments)}}}return a},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>n.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new en(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Yv(t){const{id:e,choices:n,created:r,model:s,system_fingerprint:i,...a}=t;return{...a,id:e,choices:n.map(({message:o,finish_reason:u,index:c,logprobs:l,...d})=>{if(!u)throw new oe(`missing finish_reason for choice ${c}`);const{content:f=null,function_call:h,tool_calls:p,...y}=o,_=o.role;if(!_)throw new oe(`missing role for choice ${c}`);if(h){const{arguments:w,name:v}=h;if(w==null)throw new oe(`missing function_call.arguments for choice ${c}`);if(!v)throw new oe(`missing function_call.name for choice ${c}`);return{...d,message:{content:f,function_call:{arguments:w,name:v},role:_},finish_reason:u,index:c,logprobs:l}}return p?{...d,index:c,finish_reason:u,logprobs:l,message:{...y,role:_,content:f,tool_calls:p.map((w,v)=>{const{function:O,type:U,id:j,...B}=w,{arguments:te,name:K,...z}=O||{};if(j==null)throw new oe(`missing choices[${c}].tool_calls[${v}].id
${ki(t)}`);if(U==null)throw new oe(`missing choices[${c}].tool_calls[${v}].type
${ki(t)}`);if(K==null)throw new oe(`missing choices[${c}].tool_calls[${v}].function.name
${ki(t)}`);if(te==null)throw new oe(`missing choices[${c}].tool_calls[${v}].function.arguments
${ki(t)}`);return{...B,id:j,type:U,function:{...z,name:K,arguments:te}}})}}:{...d,message:{...y,content:f,role:_},finish_reason:u,index:c,logprobs:l}}),created:r,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function ki(t){return JSON.stringify(t)}class Zr extends Ws{static fromReadableStream(e){const n=new Zr;return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Zr,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Zr,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let jp=class extends ve{runFunctions(e,n){return e.stream?Zr.runFunctions(this._client.chat.completions,e,n):Zs.runFunctions(this._client.chat.completions,e,n)}runTools(e,n){return e.stream?Zr.runTools(this._client.chat.completions,e,n):Zs.runTools(this._client.chat.completions,e,n)}stream(e,n){return Ws.createChatCompletion(this._client.chat.completions,e,n)}};class wa extends ve{constructor(){super(...arguments),this.completions=new jp(this._client)}}(function(t){t.Completions=jp})(wa||(wa={}));var Tt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ce=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Gi,Xi,ws,vs,Yi,Es,pn,Ss,Qi,ea,Ir,Ku;class Qv{constructor(){this.controller=new AbortController,Gi.set(this,void 0),Xi.set(this,()=>{}),ws.set(this,()=>{}),vs.set(this,void 0),Yi.set(this,()=>{}),Es.set(this,()=>{}),pn.set(this,{}),Ss.set(this,!1),Qi.set(this,!1),ea.set(this,!1),Ir.set(this,!1),Ku.set(this,e=>{if(Tt(this,Qi,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new lt),e instanceof lt)return Tt(this,ea,!0,"f"),this._emit("abort",e);if(e instanceof oe)return this._emit("error",e);if(e instanceof Error){const n=new oe(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new oe(String(e)))}),Tt(this,Gi,new Promise((e,n)=>{Tt(this,Xi,e,"f"),Tt(this,ws,n,"f")}),"f"),Tt(this,vs,new Promise((e,n)=>{Tt(this,Yi,e,"f"),Tt(this,Es,n,"f")}),"f"),Ce(this,Gi,"f").catch(()=>{}),Ce(this,vs,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},Ce(this,Ku,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(Ce(this,Xi,"f").call(this),this._emit("connect"))}get ended(){return Ce(this,Ss,"f")}get errored(){return Ce(this,Qi,"f")}get aborted(){return Ce(this,ea,"f")}abort(){this.controller.abort()}on(e,n){return(Ce(this,pn,"f")[e]||(Ce(this,pn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=Ce(this,pn,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(Ce(this,pn,"f")[e]||(Ce(this,pn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Tt(this,Ir,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Tt(this,Ir,!0,"f"),await Ce(this,vs,"f")}_emit(e,...n){if(Ce(this,Ss,"f"))return;e==="end"&&(Tt(this,Ss,!0,"f"),Ce(this,Yi,"f").call(this));const r=Ce(this,pn,"f")[e];if(r&&(Ce(this,pn,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!Ce(this,Ir,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Ce(this,ws,"f").call(this,s),Ce(this,Es,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!Ce(this,Ir,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Ce(this,ws,"f").call(this,s),Ce(this,Es,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}async _createThreadAssistantStream(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i=await e.createAndRun({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,n,r,s,i){const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o=await e.submitToolOutputs(n,r,{...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(o)}async _createAssistantStream(e,n,r,s){const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a=await e.create(n,{...r,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(a)}}Gi=new WeakMap,Xi=new WeakMap,ws=new WeakMap,vs=new WeakMap,Yi=new WeakMap,Es=new WeakMap,pn=new WeakMap,Ss=new WeakMap,Qi=new WeakMap,ea=new WeakMap,Ir=new WeakMap,Ku=new WeakMap;var H=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},gt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},qe,Gu,Jt,ta,Nt,ir,$r,tr,va,yt,na,ra,$s,As,xs,Zd,Wd,Jd,Kd,Gd,Xd,Yd;class jt extends Qv{constructor(){super(...arguments),qe.add(this),Gu.set(this,[]),Jt.set(this,{}),ta.set(this,{}),Nt.set(this,void 0),ir.set(this,void 0),$r.set(this,void 0),tr.set(this,void 0),va.set(this,void 0),yt.set(this,void 0),na.set(this,void 0),ra.set(this,void 0),$s.set(this,void 0)}[(Gu=new WeakMap,Jt=new WeakMap,ta=new WeakMap,Nt=new WeakMap,ir=new WeakMap,$r=new WeakMap,tr=new WeakMap,va=new WeakMap,yt=new WeakMap,na=new WeakMap,ra=new WeakMap,$s=new WeakMap,qe=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>n.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new jt;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=en.fromReadableStream(e,this.controller);for await(const a of s)H(this,qe,"m",As).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new lt;return this._addRun(H(this,qe,"m",xs).call(this))}toReadableStream(){return new en(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const a=new jt;return a._run(()=>a._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,n,r,s,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},u=await e.submitToolOutputs(n,r,o,{...i,signal:this.controller.signal});this._connected();for await(const l of u)H(this,qe,"m",As).call(this,l);if((c=u.controller.signal)!=null&&c.aborted)throw new lt;return this._addRun(H(this,qe,"m",xs).call(this))}static createThreadAssistantStream(e,n,r){const s=new jt;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new jt;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return H(this,na,"f")}currentRun(){return H(this,ra,"f")}currentMessageSnapshot(){return H(this,Nt,"f")}currentRunStepSnapshot(){return H(this,$s,"f")}async finalRunSteps(){return await this.done(),Object.values(H(this,Jt,"f"))}async finalMessages(){return await this.done(),Object.values(H(this,ta,"f"))}async finalRun(){if(await this.done(),!H(this,ir,"f"))throw Error("Final run was not received.");return H(this,ir,"f")}async _createThreadAssistantStream(e,n,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},a=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const u of a)H(this,qe,"m",As).call(this,u);if((o=a.controller.signal)!=null&&o.aborted)throw new lt;return this._addRun(H(this,qe,"m",xs).call(this))}async _createAssistantStream(e,n,r,s){var u;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(n,a,{...s,signal:this.controller.signal});this._connected();for await(const c of o)H(this,qe,"m",As).call(this,c);if((u=o.controller.signal)!=null&&u.aborted)throw new lt;return this._addRun(H(this,qe,"m",xs).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(qd(i)&&qd(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}}As=function(e){if(!this.ended)switch(gt(this,na,e,"f"),H(this,qe,"m",Jd).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":H(this,qe,"m",Yd).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":H(this,qe,"m",Wd).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":H(this,qe,"m",Zd).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},xs=function(){if(this.ended)throw new oe("stream has ended, this shouldn't happen");if(!H(this,ir,"f"))throw Error("Final run has not been received");return H(this,ir,"f")},Zd=function(e){const[n,r]=H(this,qe,"m",Gd).call(this,e,H(this,Nt,"f"));gt(this,Nt,n,"f"),H(this,ta,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=n.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=H(this,$r,"f")){if(H(this,tr,"f"))switch(H(this,tr,"f").type){case"text":this._emit("textDone",H(this,tr,"f").text,H(this,Nt,"f"));break;case"image_file":this._emit("imageFileDone",H(this,tr,"f").image_file,H(this,Nt,"f"));break}gt(this,$r,s.index,"f")}gt(this,tr,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(H(this,$r,"f")!==void 0){const s=e.data.content[H(this,$r,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,H(this,Nt,"f"));break;case"text":this._emit("textDone",s.text,H(this,Nt,"f"));break}}H(this,Nt,"f")&&this._emit("messageDone",e.data),gt(this,Nt,void 0,"f")}},Wd=function(e){const n=H(this,qe,"m",Kd).call(this,e);switch(gt(this,$s,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==H(this,va,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(H(this,yt,"f")&&this._emit("toolCallDone",H(this,yt,"f")),gt(this,va,i.index,"f"),gt(this,yt,n.step_details.tool_calls[i.index],"f"),H(this,yt,"f")&&this._emit("toolCallCreated",H(this,yt,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":gt(this,$s,void 0,"f"),e.data.step_details.type=="tool_calls"&&H(this,yt,"f")&&(this._emit("toolCallDone",H(this,yt,"f")),gt(this,yt,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Jd=function(e){H(this,Gu,"f").push(e),this._emit("event",e)},Kd=function(e){switch(e.event){case"thread.run.step.created":return H(this,Jt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=H(this,Jt,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=jt.accumulateDelta(n,r.delta);H(this,Jt,"f")[e.data.id]=s}return H(this,Jt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":H(this,Jt,"f")[e.data.id]=e.data;break}if(H(this,Jt,"f")[e.data.id])return H(this,Jt,"f")[e.data.id];throw new Error("No snapshot available")},Gd=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let a=n.content[i.index];n.content[i.index]=H(this,qe,"m",Xd).call(this,i,a)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Xd=function(e,n){return jt.accumulateDelta(n,e)},Yd=function(e){switch(gt(this,ra,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":gt(this,ir,e.data,"f"),H(this,yt,"f")&&(this._emit("toolCallDone",H(this,yt,"f")),gt(this,yt,void 0,"f"));break}};class Ea extends ve{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return bt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,el,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class el extends Ht{}(function(t){t.MessagesPage=el})(Ea||(Ea={}));class Sa extends ve{retrieve(e,n,r,s){return this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n,r={},s){return bt(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,tl,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class tl extends Ht{}(function(t){t.RunStepsPage=tl})(Sa||(Sa={}));class Aa extends ve{constructor(){super(...arguments),this.steps=new Sa(this._client)}create(e,n,r){return this._client.post(`/threads/${e}/runs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return bt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,nl,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return jt.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(o=c)}}await _i(o);break;case"requires_action":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return jt.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return jt.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}}class nl extends Ht{}(function(t){t.RunsPage=nl,t.Steps=Sa,t.RunStepsPage=tl})(Aa||(Aa={}));class xa extends ve{constructor(){super(...arguments),this.runs=new Aa(this._client),this.messages=new Ea(this._client)}create(e={},n){return bt(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return jt.createThreadAssistantStream(e,this._client.beta.threads,n)}}(function(t){t.Runs=Aa,t.RunsPage=nl,t.Messages=Ea,t.MessagesPage=el})(xa||(xa={}));const e0=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Oa=class extends ve{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,n={},r){return bt(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,To,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(o=c)}}await _i(o);break;case"failed":case"completed":return a}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return await this.poll(e,s.id,r)}};class To extends Ht{}(function(t){t.VectorStoreFilesPage=To})(Oa||(Oa={}));class Pa extends ve{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return bt(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,To,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(o=c)}}await _i(o);break;case"failed":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n===null||n.length==0)throw new Error("No files provided to process.");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,n.length),o=this._client,u=n.values(),c=[...r];async function l(f){for(let h of f){const p=await o.files.create({file:h,purpose:"assistants"},s);c.push(p.id)}}const d=Array(a).fill(u).map(l);return await e0(d),await this.createAndPoll(e,{file_ids:c})}}Pa||(Pa={});class Ra extends ve{constructor(){super(...arguments),this.files=new Oa(this._client),this.fileBatches=new Pa(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return bt(e)?this.list({},e):this._client.getAPIList("/vector_stores",rl,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class rl extends Ht{}(function(t){t.VectorStoresPage=rl,t.Files=Oa,t.VectorStoreFilesPage=To,t.FileBatches=Pa})(Ra||(Ra={}));class Ca extends ve{constructor(){super(...arguments),this.vectorStores=new Ra(this._client),this.chat=new wa(this._client),this.assistants=new _a(this._client),this.threads=new xa(this._client)}}(function(t){t.VectorStores=Ra,t.VectorStoresPage=rl,t.Chat=wa,t.Assistants=_a,t.AssistantsPage=Qc,t.Threads=xa})(Ca||(Ca={}));class Ta extends ve{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}Ta||(Ta={});class ka extends ve{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}ka||(ka={});class Ia extends ve{create(e,n){return this._client.post("/files",Vs({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return bt(e)?this.list({},e):this._client.getAPIList("/files",sl,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n==null?void 0:n.headers}})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await _i(n),a=await this.retrieve(e),Date.now()-i>r)throw new Ro({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class sl extends Xc{}(function(t){t.FileObjectsPage=sl})(Ia||(Ia={}));class Na extends ve{list(e,n={},r){return bt(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,il,{query:n,...r})}}class il extends Ht{}(function(t){t.FineTuningJobCheckpointsPage=il})(Na||(Na={}));class $a extends ve{constructor(){super(...arguments),this.checkpoints=new Na(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return bt(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",al,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return bt(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,ol,{query:n,...r})}}class al extends Ht{}class ol extends Ht{}(function(t){t.FineTuningJobsPage=al,t.FineTuningJobEventsPage=ol,t.Checkpoints=Na,t.FineTuningJobCheckpointsPage=il})($a||($a={}));class ja extends ve{constructor(){super(...arguments),this.jobs=new $a(this._client)}}(function(t){t.Jobs=$a,t.FineTuningJobsPage=al,t.FineTuningJobEventsPage=ol})(ja||(ja={}));class La extends ve{createVariation(e,n){return this._client.post("/images/variations",Vs({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Vs({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}La||(La={});class Ma extends ve{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",ul,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class ul extends Xc{}(function(t){t.ModelsPage=ul})(Ma||(Ma={}));class Da extends ve{create(e,n){return this._client.post("/moderations",{body:e,...n})}}Da||(Da={});var Lp;let Be=class extends Bv{constructor({baseURL:e=Ci("OPENAI_BASE_URL"),apiKey:n=Ci("OPENAI_API_KEY"),organization:r=Ci("OPENAI_ORG_ID")??null,project:s=Ci("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new oe("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Xv())throw new oe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Ta(this),this.chat=new fa(this),this.embeddings=new ka(this),this.files=new Ia(this),this.images=new La(this),this.audio=new ga(this),this.moderations=new Da(this),this.models=new Ma(this),this.fineTuning=new ja(this),this.beta=new Ca(this),this.batches=new ya(this),this._options=a,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}};Lp=Be;Be.OpenAI=Lp;Be.OpenAIError=oe;Be.APIError=rt;Be.APIConnectionError=yi;Be.APIConnectionTimeoutError=Ro;Be.APIUserAbortError=lt;Be.NotFoundError=Zc;Be.ConflictError=Wc;Be.RateLimitError=Kc;Be.BadRequestError=Hc;Be.AuthenticationError=zc;Be.InternalServerError=Gc;Be.PermissionDeniedError=Vc;Be.UnprocessableEntityError=Jc;const{OpenAIError:Wx,APIError:Jx,APIConnectionError:Kx,APIConnectionTimeoutError:t0,APIUserAbortError:n0,NotFoundError:Gx,ConflictError:Xx,RateLimitError:Yx,BadRequestError:Qx,AuthenticationError:eO,InternalServerError:tO,PermissionDeniedError:nO,UnprocessableEntityError:rO}=Ov;(function(t){t.toFile=Op,t.fileFromPath=wp,t.Page=Xc,t.CursorPage=Ht,t.Completions=Ta,t.Chat=fa,t.Embeddings=ka,t.Files=Ia,t.FileObjectsPage=sl,t.Images=La,t.Audio=ga,t.Moderations=Da,t.Models=Ma,t.ModelsPage=ul,t.FineTuning=ja,t.Beta=Ca,t.Batches=ya,t.BatchesPage=Yc})(Be||(Be={}));const Qd="__run";class ko{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new ko({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Js extends ko{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Js({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}var au={};const r0=()=>typeof window<"u"&&typeof window.document<"u",s0=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",i0=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Mp=()=>typeof Deno<"u",a0=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Mp(),o0=()=>{let t;return r0()?t="browser":a0()?t="node":s0()?t="webworker":i0()?t="jsdom":Mp()?t="deno":t="other",t};let ou;async function u0(){return ou===void 0&&(ou={library:"langchain-js",runtime:o0()}),ou}function ut(t){try{return typeof process<"u"?au==null?void 0:au[t]:void 0}catch{return}}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var c0=typeof window=="object"?window:{},ne="0123456789abcdef".split(""),l0=[-2147483648,8388608,32768,128],kt=[24,16,8,0],Fe=[];function Ut(t){t?(Fe[0]=Fe[16]=Fe[1]=Fe[2]=Fe[3]=Fe[4]=Fe[5]=Fe[6]=Fe[7]=Fe[8]=Fe[9]=Fe[10]=Fe[11]=Fe[12]=Fe[13]=Fe[14]=Fe[15]=0,this.blocks=Fe):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Ut.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===c0.ArrayBuffer&&(t=new Uint8Array(t));for(var n,r=0,s,i=t.length||0,a=this.blocks;r<i;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(s=this.start;r<i&&s<64;++r)a[s>>2]|=t[r]<<kt[s++&3];else for(s=this.start;r<i&&s<64;++r)n=t.charCodeAt(r),n<128?a[s>>2]|=n<<kt[s++&3]:n<2048?(a[s>>2]|=(192|n>>6)<<kt[s++&3],a[s>>2]|=(128|n&63)<<kt[s++&3]):n<55296||n>=57344?(a[s>>2]|=(224|n>>12)<<kt[s++&3],a[s>>2]|=(128|n>>6&63)<<kt[s++&3],a[s>>2]|=(128|n&63)<<kt[s++&3]):(n=65536+((n&1023)<<10|t.charCodeAt(++r)&1023),a[s>>2]|=(240|n>>18)<<kt[s++&3],a[s>>2]|=(128|n>>12&63)<<kt[s++&3],a[s>>2]|=(128|n>>6&63)<<kt[s++&3],a[s>>2]|=(128|n&63)<<kt[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=a[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Ut.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=l0[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};Ut.prototype.hash=function(){var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4,i,a,o,u=this.blocks;for(a=16;a<80;++a)o=u[a-3]^u[a-8]^u[a-14]^u[a-16],u[a]=o<<1|o>>>31;for(a=0;a<20;a+=5)i=e&n|~e&r,o=t<<5|t>>>27,s=o+i+s+1518500249+u[a]<<0,e=e<<30|e>>>2,i=t&e|~t&n,o=s<<5|s>>>27,r=o+i+r+1518500249+u[a+1]<<0,t=t<<30|t>>>2,i=s&t|~s&e,o=r<<5|r>>>27,n=o+i+n+1518500249+u[a+2]<<0,s=s<<30|s>>>2,i=r&s|~r&t,o=n<<5|n>>>27,e=o+i+e+1518500249+u[a+3]<<0,r=r<<30|r>>>2,i=n&r|~n&s,o=e<<5|e>>>27,t=o+i+t+1518500249+u[a+4]<<0,n=n<<30|n>>>2;for(;a<40;a+=5)i=e^n^r,o=t<<5|t>>>27,s=o+i+s+1859775393+u[a]<<0,e=e<<30|e>>>2,i=t^e^n,o=s<<5|s>>>27,r=o+i+r+1859775393+u[a+1]<<0,t=t<<30|t>>>2,i=s^t^e,o=r<<5|r>>>27,n=o+i+n+1859775393+u[a+2]<<0,s=s<<30|s>>>2,i=r^s^t,o=n<<5|n>>>27,e=o+i+e+1859775393+u[a+3]<<0,r=r<<30|r>>>2,i=n^r^s,o=e<<5|e>>>27,t=o+i+t+1859775393+u[a+4]<<0,n=n<<30|n>>>2;for(;a<60;a+=5)i=e&n|e&r|n&r,o=t<<5|t>>>27,s=o+i+s-1894007588+u[a]<<0,e=e<<30|e>>>2,i=t&e|t&n|e&n,o=s<<5|s>>>27,r=o+i+r-1894007588+u[a+1]<<0,t=t<<30|t>>>2,i=s&t|s&e|t&e,o=r<<5|r>>>27,n=o+i+n-1894007588+u[a+2]<<0,s=s<<30|s>>>2,i=r&s|r&t|s&t,o=n<<5|n>>>27,e=o+i+e-1894007588+u[a+3]<<0,r=r<<30|r>>>2,i=n&r|n&s|r&s,o=e<<5|e>>>27,t=o+i+t-1894007588+u[a+4]<<0,n=n<<30|n>>>2;for(;a<80;a+=5)i=e^n^r,o=t<<5|t>>>27,s=o+i+s-899497514+u[a]<<0,e=e<<30|e>>>2,i=t^e^n,o=s<<5|s>>>27,r=o+i+r-899497514+u[a+1]<<0,t=t<<30|t>>>2,i=s^t^e,o=r<<5|r>>>27,n=o+i+n-899497514+u[a+2]<<0,s=s<<30|s>>>2,i=r^s^t,o=n<<5|n>>>27,e=o+i+e-899497514+u[a+3]<<0,r=r<<30|r>>>2,i=n^r^s,o=e<<5|e>>>27,t=o+i+t-899497514+u[a+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0};Ut.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4;return ne[t>>28&15]+ne[t>>24&15]+ne[t>>20&15]+ne[t>>16&15]+ne[t>>12&15]+ne[t>>8&15]+ne[t>>4&15]+ne[t&15]+ne[e>>28&15]+ne[e>>24&15]+ne[e>>20&15]+ne[e>>16&15]+ne[e>>12&15]+ne[e>>8&15]+ne[e>>4&15]+ne[e&15]+ne[n>>28&15]+ne[n>>24&15]+ne[n>>20&15]+ne[n>>16&15]+ne[n>>12&15]+ne[n>>8&15]+ne[n>>4&15]+ne[n&15]+ne[r>>28&15]+ne[r>>24&15]+ne[r>>20&15]+ne[r>>16&15]+ne[r>>12&15]+ne[r>>8&15]+ne[r>>4&15]+ne[r&15]+ne[s>>28&15]+ne[s>>24&15]+ne[s>>20&15]+ne[s>>16&15]+ne[s>>12&15]+ne[s>>8&15]+ne[s>>4&15]+ne[s&15]};Ut.prototype.toString=Ut.prototype.hex;Ut.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255]};Ut.prototype.array=Ut.prototype.digest;Ut.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};const d0=t=>new Ut(!0).update(t).hex(),ef=(...t)=>d0(t.join("_"));class f0{}const h0=new Map;class cl extends f0{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,n){return Promise.resolve(this.cache.get(ef(e,n))??null)}async update(e,n,r){this.cache.set(ef(e,n),r)}static global(){return new cl(h0)}}class Dp extends mr{}class p0 extends Dp{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new es(this.value)]}}class m0 extends Dp{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return pp(this.messages)}toChatMessages(){return this.messages}}var Io={exports:{}},Fp={};function Ot(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var g0=Ot;Ot.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Ot.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Ot.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0};Ot.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Ot.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};Ot.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};Ot.prototype.start=Ot.prototype.try;Ot.prototype.errors=function(){return this._errors};Ot.prototype.attempts=function(){return this._attempts};Ot.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var s=this._errors[r],i=s.message,a=(t[i]||0)+1;t[i]=a,a>=n&&(e=s,n=a)}return e};(function(t){var e=g0;t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in n)r[s]=n[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],a=0;a<r.retries;a++)i.push(this.createTimeout(a,r));return n&&n.forever&&!i.length&&i.push(this.createTimeout(a,r)),i.sort(function(o,u){return o-u}),i},t.createTimeout=function(n,r){var s=r.randomize?Math.random()+1:1,i=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return i=Math.min(i,r.maxTimeout),i},t.wrap=function(n,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var i in n)typeof n[i]=="function"&&s.push(i)}for(var a=0;a<s.length;a++){var o=s[a],u=n[o];n[o]=(function(l){var d=t.operation(r),f=Array.prototype.slice.call(arguments,1),h=f.pop();f.push(function(p){d.retry(p)||(p&&(arguments[0]=d.mainError()),h.apply(this,arguments))}),d.attempt(function(){l.apply(n,f)})}).bind(n,u),n[o].options=r}}})(Fp);var y0=Fp;const _0=y0,b0=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class Bp extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const w0=(t,e,n)=>{const r=n.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t},v0=t=>b0.includes(t),Up=(t,e)=>new Promise((n,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const s=_0.operation(e);s.attempt(async i=>{try{n(await t(i))}catch(a){if(!(a instanceof Error)){r(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof Bp)s.stop(),r(a.originalError);else if(a instanceof TypeError&&!v0(a.message))s.stop(),r(a);else{w0(a,i,e);try{await e.onFailedAttempt(a)}catch(o){r(o);return}s.retry(a)||r(s.mainError())}}})});Io.exports=Up;Io.exports.default=Up;Io.exports.AbortError=Bp;var E0=Io.exports;const Fa=Bc(E0);var qp={},Hp={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(u,c,l){this.fn=u,this.context=c,this.once=l||!1}function i(u,c,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var h=new s(l,d||u,f),p=n?n+c:c;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function a(u,c){--u._eventsCount===0?u._events=new r:delete u._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],l,d;if(this._eventsCount===0)return c;for(d in l=this._events)e.call(l,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},o.prototype.listeners=function(c){var l=n?n+c:c,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},o.prototype.listenerCount=function(c){var l=n?n+c:c,d=this._events[l];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,l,d,f,h,p){var y=n?n+c:c;if(!this._events[y])return!1;var _=this._events[y],w=arguments.length,v,O;if(_.fn){switch(_.once&&this.removeListener(c,_.fn,void 0,!0),w){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,l),!0;case 3:return _.fn.call(_.context,l,d),!0;case 4:return _.fn.call(_.context,l,d,f),!0;case 5:return _.fn.call(_.context,l,d,f,h),!0;case 6:return _.fn.call(_.context,l,d,f,h,p),!0}for(O=1,v=new Array(w-1);O<w;O++)v[O-1]=arguments[O];_.fn.apply(_.context,v)}else{var U=_.length,j;for(O=0;O<U;O++)switch(_[O].once&&this.removeListener(c,_[O].fn,void 0,!0),w){case 1:_[O].fn.call(_[O].context);break;case 2:_[O].fn.call(_[O].context,l);break;case 3:_[O].fn.call(_[O].context,l,d);break;case 4:_[O].fn.call(_[O].context,l,d,f);break;default:if(!v)for(j=1,v=new Array(w-1);j<w;j++)v[j-1]=arguments[j];_[O].fn.apply(_[O].context,v)}}return!0},o.prototype.on=function(c,l,d){return i(this,c,l,d,!1)},o.prototype.once=function(c,l,d){return i(this,c,l,d,!0)},o.prototype.removeListener=function(c,l,d,f){var h=n?n+c:c;if(!this._events[h])return this;if(!l)return a(this,h),this;var p=this._events[h];if(p.fn)p.fn===l&&(!f||p.once)&&(!d||p.context===d)&&a(this,h);else{for(var y=0,_=[],w=p.length;y<w;y++)(p[y].fn!==l||f&&!p[y].once||d&&p[y].context!==d)&&_.push(p[y]);_.length?this._events[h]=_.length===1?_[0]:_:a(this,h)}return this},o.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&a(this,l)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(Hp);var S0=Hp.exports,No={exports:{}},A0=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})));const x0=A0;class zp extends Error{constructor(e){super(e),this.name="TimeoutError"}}const Vp=(t,e,n)=>new Promise((r,s)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(t);return}const i=setTimeout(()=>{if(typeof n=="function"){try{r(n())}catch(u){s(u)}return}const a=typeof n=="string"?n:`Promise timed out after ${e} milliseconds`,o=n instanceof Error?n:new zp(a);typeof t.cancel=="function"&&t.cancel(),s(o)},e);x0(t.then(r,s),()=>{clearTimeout(i)})});No.exports=Vp;No.exports.default=Vp;No.exports.TimeoutError=zp;var O0=No.exports,ll={},dl={};Object.defineProperty(dl,"__esModule",{value:!0});function P0(t,e,n){let r=0,s=t.length;for(;s>0;){const i=s/2|0;let a=r+i;n(t[a],e)<=0?(r=++a,s-=i+1):s=i}return r}dl.default=P0;Object.defineProperty(ll,"__esModule",{value:!0});const R0=dl;class C0{constructor(){this._queue=[]}enqueue(e,n){n=Object.assign({priority:0},n);const r={priority:n.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(r);return}const s=R0.default(this._queue,r,(i,a)=>a.priority-i.priority);this._queue.splice(s,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this._queue.length}}ll.default=C0;Object.defineProperty(qp,"__esModule",{value:!0});const T0=S0,Zp=O0,k0=ll,Ii=()=>{},I0=new Zp.TimeoutError;class N0 extends T0{constructor(e){var n,r,s,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Ii,this._resolveIdle=Ii,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:k0.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(n=e.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Ii,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Ii,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-e;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,n={}){return new Promise((r,s)=>{const i=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&n.timeout===void 0?e():Zp.default(Promise.resolve(e()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&s(I0)});r(await a)}catch(a){s(a)}this._next()};this._queue.enqueue(i,n),this._tryToStartAnother(),this.emit("add")})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var _n=qp.default=N0;const $0=[400,401,402,403,404,405,406,407,409],j0=t=>{var n,r;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((n=t==null?void 0:t.response)==null?void 0:n.status)??(t==null?void 0:t.status);if(e&&$0.includes(+e))throw t;if(((r=t==null?void 0:t.error)==null?void 0:r.code)==="insufficient_quota"){const s=new Error(t==null?void 0:t.message);throw s.name="InsufficientQuotaError",s}};let fl=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??j0;const n="default"in _n?_n.default:_n;this.queue=new n({concurrency:this.maxConcurrency})}call(e,...n){return this.queue.add(()=>Fa(()=>e(...n).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((s,i)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}};var $o={};$o.byteLength=D0;$o.toByteArray=B0;$o.fromByteArray=H0;var Yt=[],Et=[],L0=typeof Uint8Array<"u"?Uint8Array:Array,uu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Or=0,M0=uu.length;Or<M0;++Or)Yt[Or]=uu[Or],Et[uu.charCodeAt(Or)]=Or;Et[45]=62;Et[95]=63;function Wp(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function D0(t){var e=Wp(t),n=e[0],r=e[1];return(n+r)*3/4-r}function F0(t,e,n){return(e+n)*3/4-n}function B0(t){var e,n=Wp(t),r=n[0],s=n[1],i=new L0(F0(t,r,s)),a=0,o=s>0?r-4:r,u;for(u=0;u<o;u+=4)e=Et[t.charCodeAt(u)]<<18|Et[t.charCodeAt(u+1)]<<12|Et[t.charCodeAt(u+2)]<<6|Et[t.charCodeAt(u+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=e&255;return s===2&&(e=Et[t.charCodeAt(u)]<<2|Et[t.charCodeAt(u+1)]>>4,i[a++]=e&255),s===1&&(e=Et[t.charCodeAt(u)]<<10|Et[t.charCodeAt(u+1)]<<4|Et[t.charCodeAt(u+2)]>>2,i[a++]=e>>8&255,i[a++]=e&255),i}function U0(t){return Yt[t>>18&63]+Yt[t>>12&63]+Yt[t>>6&63]+Yt[t&63]}function q0(t,e,n){for(var r,s=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(U0(r));return s.join("")}function H0(t){for(var e,n=t.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(q0(t,a,a+i>o?o:a+i));return r===1?(e=t[n-1],s.push(Yt[e>>2]+Yt[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],s.push(Yt[e>>10]+Yt[e>>4&63]+Yt[e<<2&63]+"=")),s.join("")}var z0=Object.defineProperty,V0=(t,e,n)=>e in t?z0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z0=(t,e,n)=>(V0(t,typeof e!="symbol"?e+"":e,n),n);function W0(t,e){let n=Array.from({length:t.length},(r,s)=>({start:s,end:s+1}));for(;n.length>1;){let r=null;for(let s=0;s<n.length-1;s++){const i=t.slice(n[s].start,n[s+1].end),a=e.get(i.join(","));a!=null&&(r==null||a<r[0])&&(r=[a,s])}if(r!=null){const s=r[1];n[s]={start:n[s].start,end:n[s+1].end},n.splice(s+1,1)}else break}return n}function J0(t,e){return t.length===1?[e.get(t.join(","))]:W0(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function K0(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Xu=class{constructor(t,e){xn(this,"specialTokens");xn(this,"inverseSpecialTokens");xn(this,"patStr");xn(this,"textEncoder",new TextEncoder);xn(this,"textDecoder",new TextDecoder("utf-8"));xn(this,"rankMap",new Map);xn(this,"textMap",new Map);this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[i,a,...o]=s.split(" "),u=Number.parseInt(a,10);return o.forEach((c,l)=>r[c]=u+l),r},{});for(const[r,s]of Object.entries(n)){const i=$o.toByteArray(r);this.rankMap.set(i.join(","),s),this.textMap.set(s,i)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,i])=>(r[i]=this.textEncoder.encode(s),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),s=Xu.specialTokenRegex(Object.keys(this.specialTokens)),i=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(n==="all"?Object.keys(this.specialTokens).filter(c=>!a.has(c)):n);if(o.size>0){const c=Xu.specialTokenRegex([...o]),l=t.match(c);if(l!=null)throw new Error(`The text contains a special token that is not allowed: ${l[0]}`)}let u=0;for(;;){let c=null,l=u;for(;s.lastIndex=l,c=s.exec(t),!(c==null||a.has(c[0]));)l=c.index+1;const d=(c==null?void 0:c.index)??t.length;for(const h of t.substring(u,d).matchAll(r)){const p=this.textEncoder.encode(h[0]),y=this.rankMap.get(p.join(","));if(y!=null){i.push(y);continue}i.push(...J0(p,this.rankMap))}if(c==null)break;let f=this.specialTokens[c[0]];i.push(f),u=c.index+c[0].length}return i}decode(t){const e=[];let n=0;for(let i=0;i<t.length;++i){const a=t[i],o=this.textMap.get(a)??this.inverseSpecialTokens[a];o!=null&&(e.push(o),n+=o.length)}const r=new Uint8Array(n);let s=0;for(const i of e)r.set(i,s),s+=i.length;return this.textDecoder.decode(r)}},Jp=Xu;Z0(Jp,"specialTokenRegex",t=>new RegExp(t.map(e=>K0(e)).join("|"),"g"));function G0(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":return"cl100k_base";default:throw new Error("Unknown model")}}const Ni={},X0=new fl({});async function Y0(t){return t in Ni||(Ni[t]=X0.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new Jp(e)).catch(e=>{throw delete Ni[t],e})),await Ni[t]}async function Q0(t){return Y0(G0(t))}var de;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return t.objectValues(a)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},t.find=(s,i)=>{for(const a of s)if(i(a))return a},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(de||(de={}));var Yu;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Yu||(Yu={}));const L=de.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Dn=t=>{switch(typeof t){case"undefined":return L.undefined;case"string":return L.string;case"number":return isNaN(t)?L.nan:L.number;case"boolean":return L.boolean;case"function":return L.function;case"bigint":return L.bigint;case"symbol":return L.symbol;case"object":return Array.isArray(t)?L.array:t===null?L.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?L.promise:typeof Map<"u"&&t instanceof Map?L.map:typeof Set<"u"&&t instanceof Set?L.set:typeof Date<"u"&&t instanceof Date?L.date:L.object;default:return L.unknown}},C=de.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eE=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Dt extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,u=0;for(;u<a.path.length;){const c=a.path[u];u===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,de.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Dt.create=t=>new Dt(t);const Ks=(t,e)=>{let n;switch(t.code){case C.invalid_type:t.received===L.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case C.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,de.jsonStringifyReplacer)}`;break;case C.unrecognized_keys:n=`Unrecognized key(s) in object: ${de.joinValues(t.keys,", ")}`;break;case C.invalid_union:n="Invalid input";break;case C.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${de.joinValues(t.options)}`;break;case C.invalid_enum_value:n=`Invalid enum value. Expected ${de.joinValues(t.options)}, received '${t.received}'`;break;case C.invalid_arguments:n="Invalid function arguments";break;case C.invalid_return_type:n="Invalid function return type";break;case C.invalid_date:n="Invalid date";break;case C.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:de.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case C.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case C.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case C.custom:n="Invalid input";break;case C.invalid_intersection_types:n="Intersection results could not be merged";break;case C.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case C.not_finite:n="Number must be finite";break;default:n=e.defaultError,de.assertNever(t)}return{message:n}};let Kp=Ks;function tE(t){Kp=t}function Ba(){return Kp}const Ua=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],a={...s,path:i};let o="";const u=r.filter(c=>!!c).slice().reverse();for(const c of u)o=c(a,{data:e,defaultError:o}).message;return{...s,path:i,message:s.message||o}},nE=[];function M(t,e){const n=Ua({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ba(),Ks].filter(r=>!!r)});t.common.issues.push(n)}class Qe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return X;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Qe.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return X;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const X=Object.freeze({status:"aborted"}),Gp=t=>({status:"dirty",value:t}),st=t=>({status:"valid",value:t}),Qu=t=>t.status==="aborted",ec=t=>t.status==="dirty",Gs=t=>t.status==="valid",qa=t=>typeof Promise<"u"&&t instanceof Promise;var Z;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Z||(Z={}));class an{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const tf=(t,e)=>{if(Gs(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Dt(t.common.issues);return this._error=n,this._error}}};function ee(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>a.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:r??o.defaultError}:{message:n??o.defaultError},description:s}}class re{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Dn(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Dn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Qe,ctx:{common:e.parent.common,data:e.data,parsedType:Dn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(qa(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Dn(e)},i=this._parseSync({data:e,path:s.path,parent:s});return tf(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Dn(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(qa(s)?s:Promise.resolve(s));return tf(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:C.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new qt({schema:this,typeName:R.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return bn.create(this,this._def)}nullable(){return br.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ft.create(this,this._def)}promise(){return ns.create(this,this._def)}or(e){return ei.create([this,e],this._def)}and(e){return ti.create(this,e,this._def)}transform(e){return new qt({...ee(this._def),schema:this,typeName:R.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new ai({...ee(this._def),innerType:this,defaultValue:n,typeName:R.ZodDefault})}brand(){return new Yp({typeName:R.ZodBranded,type:this,...ee(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Za({...ee(this._def),innerType:this,catchValue:n,typeName:R.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return bi.create(this,e)}readonly(){return Ja.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rE=/^c[^\s-]{8,}$/i,sE=/^[a-z][a-z0-9]*$/,iE=/^[0-9A-HJKMNP-TV-Z]{26}$/,aE=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oE=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,uE="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let cu;const cE=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,lE=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,dE=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function fE(t,e){return!!((e==="v4"||!e)&&cE.test(t)||(e==="v6"||!e)&&lE.test(t))}class Lt extends re{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==L.string){const i=this._getOrReturnCtx(e);return M(i,{code:C.invalid_type,expected:L.string,received:i.parsedType}),X}const r=new Qe;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?M(s,{code:C.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&M(s,{code:C.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")oE.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"email",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")cu||(cu=new RegExp(uE,"u")),cu.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"emoji",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")aE.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"uuid",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")rE.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")sE.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid2",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")iE.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ulid",code:C.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),M(s,{validation:"url",code:C.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"regex",code:C.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?dE(i).test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?fE(e.data,i.version)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ip",code:C.invalid_string,message:i.message}),r.dirty()):de.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:C.invalid_string,...Z.errToObj(r)})}_addCheck(e){return new Lt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Z.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Z.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Z.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Z.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Z.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Z.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Z.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Z.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...Z.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Z.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Z.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Z.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Z.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Z.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Z.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Z.errToObj(n)})}nonempty(e){return this.min(1,Z.errToObj(e))}trim(){return new Lt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Lt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Lt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Lt.create=t=>{var e;return new Lt({checks:[],typeName:R.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...ee(t)})};function hE(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class zn extends re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==L.number){const i=this._getOrReturnCtx(e);return M(i,{code:C.invalid_type,expected:L.number,received:i.parsedType}),X}let r;const s=new Qe;for(const i of this._def.checks)i.kind==="int"?de.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:C.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?hE(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_finite,message:i.message}),s.dirty()):de.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Z.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Z.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Z.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Z.toString(n))}setLimit(e,n,r,s){return new zn({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Z.toString(s)}]})}_addCheck(e){return new zn({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Z.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Z.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Z.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Z.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Z.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Z.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&de.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}zn.create=t=>new zn({checks:[],typeName:R.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ee(t)});class Vn extends re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==L.bigint){const i=this._getOrReturnCtx(e);return M(i,{code:C.invalid_type,expected:L.bigint,received:i.parsedType}),X}let r;const s=new Qe;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):de.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Z.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Z.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Z.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Z.toString(n))}setLimit(e,n,r,s){return new Vn({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Z.toString(s)}]})}_addCheck(e){return new Vn({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Z.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Z.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Vn.create=t=>{var e;return new Vn({checks:[],typeName:R.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...ee(t)})};class Xs extends re{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==L.boolean){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.boolean,received:r.parsedType}),X}return st(e.data)}}Xs.create=t=>new Xs({typeName:R.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ee(t)});class yr extends re{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==L.date){const i=this._getOrReturnCtx(e);return M(i,{code:C.invalid_type,expected:L.date,received:i.parsedType}),X}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return M(i,{code:C.invalid_date}),X}const r=new Qe;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):de.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new yr({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Z.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Z.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}yr.create=t=>new yr({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:R.ZodDate,...ee(t)});class Ha extends re{_parse(e){if(this._getType(e)!==L.symbol){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.symbol,received:r.parsedType}),X}return st(e.data)}}Ha.create=t=>new Ha({typeName:R.ZodSymbol,...ee(t)});class Ys extends re{_parse(e){if(this._getType(e)!==L.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.undefined,received:r.parsedType}),X}return st(e.data)}}Ys.create=t=>new Ys({typeName:R.ZodUndefined,...ee(t)});class Qs extends re{_parse(e){if(this._getType(e)!==L.null){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.null,received:r.parsedType}),X}return st(e.data)}}Qs.create=t=>new Qs({typeName:R.ZodNull,...ee(t)});class ts extends re{constructor(){super(...arguments),this._any=!0}_parse(e){return st(e.data)}}ts.create=t=>new ts({typeName:R.ZodAny,...ee(t)});class dr extends re{constructor(){super(...arguments),this._unknown=!0}_parse(e){return st(e.data)}}dr.create=t=>new dr({typeName:R.ZodUnknown,...ee(t)});class wn extends re{_parse(e){const n=this._getOrReturnCtx(e);return M(n,{code:C.invalid_type,expected:L.never,received:n.parsedType}),X}}wn.create=t=>new wn({typeName:R.ZodNever,...ee(t)});class za extends re{_parse(e){if(this._getType(e)!==L.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.void,received:r.parsedType}),X}return st(e.data)}}za.create=t=>new za({typeName:R.ZodVoid,...ee(t)});class Ft extends re{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==L.array)return M(n,{code:C.invalid_type,expected:L.array,received:n.parsedType}),X;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(M(n,{code:a?C.too_big:C.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(M(n,{code:C.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(M(n,{code:C.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new an(n,a,n.path,o)))).then(a=>Qe.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new an(n,a,n.path,o)));return Qe.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Ft({...this._def,minLength:{value:e,message:Z.toString(n)}})}max(e,n){return new Ft({...this._def,maxLength:{value:e,message:Z.toString(n)}})}length(e,n){return new Ft({...this._def,exactLength:{value:e,message:Z.toString(n)}})}nonempty(e){return this.min(1,e)}}Ft.create=(t,e)=>new Ft({type:t,minLength:null,maxLength:null,exactLength:null,typeName:R.ZodArray,...ee(e)});function Nr(t){if(t instanceof Ie){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=bn.create(Nr(r))}return new Ie({...t._def,shape:()=>e})}else return t instanceof Ft?new Ft({...t._def,type:Nr(t.element)}):t instanceof bn?bn.create(Nr(t.unwrap())):t instanceof br?br.create(Nr(t.unwrap())):t instanceof on?on.create(t.items.map(e=>Nr(e))):t}class Ie extends re{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=de.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==L.object){const c=this._getOrReturnCtx(e);return M(c,{code:C.invalid_type,expected:L.object,received:c.parsedType}),X}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof wn&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const u=[];for(const c of a){const l=i[c],d=s.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new an(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof wn){const c=this._def.unknownKeys;if(c==="passthrough")for(const l of o)u.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(c==="strict")o.length>0&&(M(s,{code:C.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const l of o){const d=s.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new an(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const l of u){const d=await l.key;c.push({key:d,value:await l.value,alwaysSet:l.alwaysSet})}return c}).then(c=>Qe.mergeObjectSync(r,c)):Qe.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return Z.errToObj,new Ie({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,a,o;const u=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=Z.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Ie({...this._def,unknownKeys:"strip"})}passthrough(){return new Ie({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ie({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ie({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:R.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ie({...this._def,catchall:e})}pick(e){const n={};return de.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ie({...this._def,shape:()=>n})}omit(e){const n={};return de.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Ie({...this._def,shape:()=>n})}deepPartial(){return Nr(this)}partial(e){const n={};return de.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new Ie({...this._def,shape:()=>n})}required(e){const n={};return de.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof bn;)i=i._def.innerType;n[r]=i}}),new Ie({...this._def,shape:()=>n})}keyof(){return Xp(de.objectKeys(this.shape))}}Ie.create=(t,e)=>new Ie({shape:()=>t,unknownKeys:"strip",catchall:wn.create(),typeName:R.ZodObject,...ee(e)});Ie.strictCreate=(t,e)=>new Ie({shape:()=>t,unknownKeys:"strict",catchall:wn.create(),typeName:R.ZodObject,...ee(e)});Ie.lazycreate=(t,e)=>new Ie({shape:t,unknownKeys:"strip",catchall:wn.create(),typeName:R.ZodObject,...ee(e)});class ei extends re{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Dt(o.ctx.common.issues));return M(n,{code:C.invalid_union,unionErrors:a}),X}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of r){const c={...n,common:{...n.common,issues:[]},parent:null},l=u._parseSync({data:n.data,path:n.path,parent:c});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new Dt(u));return M(n,{code:C.invalid_union,unionErrors:o}),X}}get options(){return this._def.options}}ei.create=(t,e)=>new ei({options:t,typeName:R.ZodUnion,...ee(e)});const sa=t=>t instanceof ri?sa(t.schema):t instanceof qt?sa(t.innerType()):t instanceof si?[t.value]:t instanceof Zn?t.options:t instanceof ii?Object.keys(t.enum):t instanceof ai?sa(t._def.innerType):t instanceof Ys?[void 0]:t instanceof Qs?[null]:null;class jo extends re{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==L.object)return M(n,{code:C.invalid_type,expected:L.object,received:n.parsedType}),X;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(M(n,{code:C.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),X)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const a=sa(i.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new jo({typeName:R.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...ee(r)})}}function tc(t,e){const n=Dn(t),r=Dn(e);if(t===e)return{valid:!0,data:t};if(n===L.object&&r===L.object){const s=de.objectKeys(e),i=de.objectKeys(t).filter(o=>s.indexOf(o)!==-1),a={...t,...e};for(const o of i){const u=tc(t[o],e[o]);if(!u.valid)return{valid:!1};a[o]=u.data}return{valid:!0,data:a}}else if(n===L.array&&r===L.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const a=t[i],o=e[i],u=tc(a,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return n===L.date&&r===L.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ti extends re{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(Qu(i)||Qu(a))return X;const o=tc(i.value,a.value);return o.valid?((ec(i)||ec(a))&&n.dirty(),{status:n.value,value:o.data}):(M(r,{code:C.invalid_intersection_types}),X)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ti.create=(t,e,n)=>new ti({left:t,right:e,typeName:R.ZodIntersection,...ee(n)});class on extends re{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.array)return M(r,{code:C.invalid_type,expected:L.array,received:r.parsedType}),X;if(r.data.length<this._def.items.length)return M(r,{code:C.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),X;!this._def.rest&&r.data.length>this._def.items.length&&(M(r,{code:C.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new an(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Qe.mergeArray(n,a)):Qe.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new on({...this._def,rest:e})}}on.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new on({items:t,typeName:R.ZodTuple,rest:null,...ee(e)})};class ni extends re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.object)return M(r,{code:C.invalid_type,expected:L.object,received:r.parsedType}),X;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new an(r,o,r.path,o)),value:a._parse(new an(r,r.data[o],r.path,o))});return r.common.async?Qe.mergeObjectAsync(n,s):Qe.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof re?new ni({keyType:e,valueType:n,typeName:R.ZodRecord,...ee(r)}):new ni({keyType:Lt.create(),valueType:e,typeName:R.ZodRecord,...ee(n)})}}class Va extends re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.map)return M(r,{code:C.invalid_type,expected:L.map,received:r.parsedType}),X;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,u],c)=>({key:s._parse(new an(r,o,r.path,[c,"key"])),value:i._parse(new an(r,u,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of a){const c=await u.key,l=await u.value;if(c.status==="aborted"||l.status==="aborted")return X;(c.status==="dirty"||l.status==="dirty")&&n.dirty(),o.set(c.value,l.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const u of a){const c=u.key,l=u.value;if(c.status==="aborted"||l.status==="aborted")return X;(c.status==="dirty"||l.status==="dirty")&&n.dirty(),o.set(c.value,l.value)}return{status:n.value,value:o}}}}Va.create=(t,e,n)=>new Va({valueType:e,keyType:t,typeName:R.ZodMap,...ee(n)});class _r extends re{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.set)return M(r,{code:C.invalid_type,expected:L.set,received:r.parsedType}),X;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(M(r,{code:C.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(M(r,{code:C.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(u){const c=new Set;for(const l of u){if(l.status==="aborted")return X;l.status==="dirty"&&n.dirty(),c.add(l.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((u,c)=>i._parse(new an(r,u,r.path,c)));return r.common.async?Promise.all(o).then(u=>a(u)):a(o)}min(e,n){return new _r({...this._def,minSize:{value:e,message:Z.toString(n)}})}max(e,n){return new _r({...this._def,maxSize:{value:e,message:Z.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}_r.create=(t,e)=>new _r({valueType:t,minSize:null,maxSize:null,typeName:R.ZodSet,...ee(e)});class Wr extends re{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==L.function)return M(n,{code:C.invalid_type,expected:L.function,received:n.parsedType}),X;function r(o,u){return Ua({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Ba(),Ks].filter(c=>!!c),issueData:{code:C.invalid_arguments,argumentsError:u}})}function s(o,u){return Ua({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Ba(),Ks].filter(c=>!!c),issueData:{code:C.invalid_return_type,returnTypeError:u}})}const i={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof ns){const o=this;return st(async function(...u){const c=new Dt([]),l=await o._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(r(u,h)),c}),d=await Reflect.apply(a,this,l);return await o._def.returns._def.type.parseAsync(d,i).catch(h=>{throw c.addIssue(s(d,h)),c})})}else{const o=this;return st(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Dt([r(u,c.error)]);const l=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(l,i);if(!d.success)throw new Dt([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Wr({...this._def,args:on.create(e).rest(dr.create())})}returns(e){return new Wr({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Wr({args:e||on.create([]).rest(dr.create()),returns:n||dr.create(),typeName:R.ZodFunction,...ee(r)})}}class ri extends re{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}ri.create=(t,e)=>new ri({getter:t,typeName:R.ZodLazy,...ee(e)});class si extends re{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return M(n,{received:n.data,code:C.invalid_literal,expected:this._def.value}),X}return{status:"valid",value:e.data}}get value(){return this._def.value}}si.create=(t,e)=>new si({value:t,typeName:R.ZodLiteral,...ee(e)});function Xp(t,e){return new Zn({values:t,typeName:R.ZodEnum,...ee(e)})}class Zn extends re{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return M(n,{expected:de.joinValues(r),received:n.parsedType,code:C.invalid_type}),X}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return M(n,{received:n.data,code:C.invalid_enum_value,options:r}),X}return st(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Zn.create(e)}exclude(e){return Zn.create(this.options.filter(n=>!e.includes(n)))}}Zn.create=Xp;class ii extends re{_parse(e){const n=de.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==L.string&&r.parsedType!==L.number){const s=de.objectValues(n);return M(r,{expected:de.joinValues(s),received:r.parsedType,code:C.invalid_type}),X}if(n.indexOf(e.data)===-1){const s=de.objectValues(n);return M(r,{received:r.data,code:C.invalid_enum_value,options:s}),X}return st(e.data)}get enum(){return this._def.values}}ii.create=(t,e)=>new ii({values:t,typeName:R.ZodNativeEnum,...ee(e)});class ns extends re{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==L.promise&&n.common.async===!1)return M(n,{code:C.invalid_type,expected:L.promise,received:n.parsedType}),X;const r=n.parsedType===L.promise?n.data:Promise.resolve(n.data);return st(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}ns.create=(t,e)=>new ns({type:t,typeName:R.ZodPromise,...ee(e)});class qt extends re{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===R.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{M(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(a).then(o=>this._def.schema._parseAsync({data:o,path:r.path,parent:r})):this._def.schema._parseSync({data:a,path:r.path,parent:r})}if(s.type==="refinement"){const a=o=>{const u=s.refinement(o,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?X:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?X:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Gs(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Gs(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):a);de.assertNever(s)}}qt.create=(t,e,n)=>new qt({schema:t,typeName:R.ZodEffects,effect:e,...ee(n)});qt.createWithPreprocess=(t,e,n)=>new qt({schema:e,effect:{type:"preprocess",transform:t},typeName:R.ZodEffects,...ee(n)});class bn extends re{_parse(e){return this._getType(e)===L.undefined?st(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}bn.create=(t,e)=>new bn({innerType:t,typeName:R.ZodOptional,...ee(e)});class br extends re{_parse(e){return this._getType(e)===L.null?st(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}br.create=(t,e)=>new br({innerType:t,typeName:R.ZodNullable,...ee(e)});class ai extends re{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===L.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}ai.create=(t,e)=>new ai({innerType:t,typeName:R.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ee(e)});class Za extends re{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return qa(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Dt(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Dt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Za.create=(t,e)=>new Za({innerType:t,typeName:R.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ee(e)});class Wa extends re{_parse(e){if(this._getType(e)!==L.nan){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.nan,received:r.parsedType}),X}return{status:"valid",value:e.data}}}Wa.create=t=>new Wa({typeName:R.ZodNaN,...ee(t)});const pE=Symbol("zod_brand");class Yp extends re{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class bi extends re{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?X:i.status==="dirty"?(n.dirty(),Gp(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?X:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new bi({in:e,out:n,typeName:R.ZodPipeline})}}class Ja extends re{_parse(e){const n=this._def.innerType._parse(e);return Gs(n)&&(n.value=Object.freeze(n.value)),n}}Ja.create=(t,e)=>new Ja({innerType:t,typeName:R.ZodReadonly,...ee(e)});const Qp=(t,e={},n)=>t?ts.create().superRefine((r,s)=>{var i,a;if(!t(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(a=(i=o.fatal)!==null&&i!==void 0?i:n)!==null&&a!==void 0?a:!0,c=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...c,fatal:u})}}):ts.create(),mE={object:Ie.lazycreate};var R;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(R||(R={}));const gE=(t,e={message:`Input not instance of ${t.name}`})=>Qp(n=>n instanceof t,e),em=Lt.create,tm=zn.create,yE=Wa.create,_E=Vn.create,nm=Xs.create,bE=yr.create,wE=Ha.create,vE=Ys.create,EE=Qs.create,SE=ts.create,AE=dr.create,xE=wn.create,OE=za.create,PE=Ft.create,RE=Ie.create,CE=Ie.strictCreate,TE=ei.create,kE=jo.create,IE=ti.create,NE=on.create,$E=ni.create,jE=Va.create,LE=_r.create,ME=Wr.create,DE=ri.create,FE=si.create,BE=Zn.create,UE=ii.create,qE=ns.create,nf=qt.create,HE=bn.create,zE=br.create,VE=qt.createWithPreprocess,ZE=bi.create,WE=()=>em().optional(),JE=()=>tm().optional(),KE=()=>nm().optional(),GE={string:t=>Lt.create({...t,coerce:!0}),number:t=>zn.create({...t,coerce:!0}),boolean:t=>Xs.create({...t,coerce:!0}),bigint:t=>Vn.create({...t,coerce:!0}),date:t=>yr.create({...t,coerce:!0})},XE=X;var Ka=Object.freeze({__proto__:null,defaultErrorMap:Ks,setErrorMap:tE,getErrorMap:Ba,makeIssue:Ua,EMPTY_PATH:nE,addIssueToContext:M,ParseStatus:Qe,INVALID:X,DIRTY:Gp,OK:st,isAborted:Qu,isDirty:ec,isValid:Gs,isAsync:qa,get util(){return de},get objectUtil(){return Yu},ZodParsedType:L,getParsedType:Dn,ZodType:re,ZodString:Lt,ZodNumber:zn,ZodBigInt:Vn,ZodBoolean:Xs,ZodDate:yr,ZodSymbol:Ha,ZodUndefined:Ys,ZodNull:Qs,ZodAny:ts,ZodUnknown:dr,ZodNever:wn,ZodVoid:za,ZodArray:Ft,ZodObject:Ie,ZodUnion:ei,ZodDiscriminatedUnion:jo,ZodIntersection:ti,ZodTuple:on,ZodRecord:ni,ZodMap:Va,ZodSet:_r,ZodFunction:Wr,ZodLazy:ri,ZodLiteral:si,ZodEnum:Zn,ZodNativeEnum:ii,ZodPromise:ns,ZodEffects:qt,ZodTransformer:qt,ZodOptional:bn,ZodNullable:br,ZodDefault:ai,ZodCatch:Za,ZodNaN:Wa,BRAND:pE,ZodBranded:Yp,ZodPipeline:bi,ZodReadonly:Ja,custom:Qp,Schema:re,ZodSchema:re,late:mE,get ZodFirstPartyTypeKind(){return R},coerce:GE,any:SE,array:PE,bigint:_E,boolean:nm,date:bE,discriminatedUnion:kE,effect:nf,enum:BE,function:ME,instanceof:gE,intersection:IE,lazy:DE,literal:FE,map:jE,nan:yE,nativeEnum:UE,never:xE,null:EE,nullable:zE,number:tm,object:RE,oboolean:KE,onumber:JE,optional:HE,ostring:WE,pipeline:ZE,preprocess:VE,promise:qE,record:$E,set:LE,strictObject:CE,string:em,symbol:wE,transformer:nf,tuple:NE,undefined:vE,union:TE,unknown:AE,void:OE,NEVER:XE,ZodIssueCode:C,quotelessJson:eE,ZodError:Dt});let $i;const YE=new Uint8Array(16);function QE(){if(!$i&&($i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $i(YE)}const eS=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function rm(t){return typeof t=="string"&&eS.test(t)}const Ue=[];for(let t=0;t<256;++t)Ue.push((t+256).toString(16).slice(1));function tS(t,e=0){return Ue[t[e+0]]+Ue[t[e+1]]+Ue[t[e+2]]+Ue[t[e+3]]+"-"+Ue[t[e+4]]+Ue[t[e+5]]+"-"+Ue[t[e+6]]+Ue[t[e+7]]+"-"+Ue[t[e+8]]+Ue[t[e+9]]+"-"+Ue[t[e+10]]+Ue[t[e+11]]+Ue[t[e+12]]+Ue[t[e+13]]+Ue[t[e+14]]+Ue[t[e+15]]}const nS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),rf={randomUUID:nS};function Gt(t,e,n){if(rf.randomUUID&&!e&&!t)return rf.randomUUID();t=t||{};const r=t.random||(t.rng||QE)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return tS(r)}class rS{}class wi extends rS{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,dp(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:ut("LANGCHAIN_CALLBACKS_BACKGROUND")!=="true"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.awaitHandlers=e._awaitHandler??this.awaitHandlers)}copy(){return new this.constructor(this)}toJSON(){return mr.prototype.toJSON.call(this)}toJSONNotImplemented(){return mr.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends wi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Gt()}),Object.assign(this,e)}}return new n}}var hl={exports:{}};hl.exports;(function(t){const n=(i=0)=>a=>`\x1B[${38+i};5;${a}m`,r=(i=0)=>(a,o,u)=>`\x1B[${38+i};2;${a};${o};${u}m`;function s(){const i=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,u]of Object.entries(a)){for(const[c,l]of Object.entries(u))a[c]={open:`\x1B[${l[0]}m`,close:`\x1B[${l[1]}m`},u[c]=a[c],i.set(l[0],l[1]);Object.defineProperty(a,o,{value:u,enumerable:!1})}return Object.defineProperty(a,"codes",{value:i,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=r(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,u,c)=>o===u&&u===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:c}=u.groups;c.length===3&&(c=c.split("").map(d=>d+d).join(""));const l=Number.parseInt(c,16);return[l>>16&255,l>>8&255,l&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:s})})(hl);var sS=hl.exports;const sm=Bc(sS);function lu(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function iS(t){return t.replace(/[-:.]/g,"")}function aS(t,e){return iS(`${new Date(t).toISOString().slice(0,-1)}000Z`)+e}class Lo extends wi{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,n){e.child_runs.push(n)}async _startTrace(e){var s;const n=aS(e.start_time,e.id),r={...e};if(r.parent_run_id!==void 0){const i=this.runMap.get(r.parent_run_id);i&&(this._addChildRun(i,r),i.child_execution_order=Math.max(i.child_execution_order,r.child_execution_order),r.trace_id=i.trace_id,i.dotted_order!==void 0&&(r.dotted_order=[i.dotted_order,n].join(".")))}else r.trace_id=r.id,r.dotted_order=n;this.runMap.set(r.id,r),await((s=this.onRunCreate)==null?void 0:s.call(this,r))}async _endTrace(e){var r;const n=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const n=e!==void 0&&this.runMap.get(e);return n?n.child_execution_order+1:1}async handleLLMStart(e,n,r,s,i,a,o,u){var h;const c=this._getExecutionOrder(s),l=Date.now(),d=o?{...i,metadata:o}:i,f={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{prompts:n},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:d??{},tags:a||[]};return await this._startTrace(f),await((h=this.onLLMStart)==null?void 0:h.call(this,f)),f}async handleChatModelStart(e,n,r,s,i,a,o,u){var h;const c=this._getExecutionOrder(s),l=Date.now(),d=o?{...i,metadata:o}:i,f={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{messages:n},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:d??{},tags:a||[]};return await this._startTrace(f),await((h=this.onLLMStart)==null?void 0:h.call(this,f)),f}async handleLLMEnd(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onLLMEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleLLMError(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onLLMError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleChainStart(e,n,r,s,i,a,o,u){var f;const c=this._getExecutionOrder(s),l=Date.now(),d={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:n,execution_order:c,child_execution_order:c,run_type:o??"chain",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return await this._startTrace(d),await((f=this.onChainStart)==null?void 0:f.call(this,d)),d}async handleChainEnd(e,n,r,s,i){var o;const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.outputs=lu(e,"output"),a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(a.inputs=lu(i.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,a)),await this._endTrace(a),a}async handleChainError(e,n,r,s,i){var o;const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.error=this.stringifyError(e),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(a.inputs=lu(i.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,a)),await this._endTrace(a),a}async handleToolStart(e,n,r,s,i,a,o){var d;const u=this._getExecutionOrder(s),c=Date.now(),l={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{input:n},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return await this._startTrace(l),await((d=this.onToolStart)==null?void 0:d.call(this,l)),l}async handleToolEnd(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onToolEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleToolError(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onToolError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,r))}async handleAgentEnd(e,n){var s;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,r)))}async handleRetrieverStart(e,n,r,s,i,a,o){var d;const u=this._getExecutionOrder(s),c=Date.now(),l={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{query:n},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return await this._startTrace(l),await((d=this.onRetrieverStart)==null?void 0:d.call(this,l)),l}async handleRetrieverEnd(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleText(e,n){var s;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,r)))}async handleLLMNewToken(e,n,r,s,i,a){var u;const o=this.runMap.get(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:a==null?void 0:a.chunk}}),await((u=this.onLLMNewToken)==null?void 0:u.call(this,o,e,{chunk:a==null?void 0:a.chunk})),o}}function et(t,e){return`${t.open}${e}${t.close}`}function It(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function Tn(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:at}=sm;class sf extends Lo{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)n.push(s),r=s;else break}return n}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,i,a)=>{const o=`${s.execution_order}:${s.run_type}:${s.name}`;return i===a.length-1?et(sm.bold,o):o}).join(" > ");return et(at.grey,r)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.green,"[chain/start]")} [${n}] Entering Chain run with input: ${It(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.cyan,"[chain/end]")} [${n}] [${Tn(e)}] Exiting Chain run with output: ${It(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.red,"[chain/error]")} [${n}] [${Tn(e)}] Chain run errored with error: ${It(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${et(at.green,"[llm/start]")} [${n}] Entering LLM run with input: ${It(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.cyan,"[llm/end]")} [${n}] [${Tn(e)}] Exiting LLM run with output: ${It(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.red,"[llm/error]")} [${n}] [${Tn(e)}] LLM run errored with error: ${It(e.error,"[error]")}`)}onToolStart(e){var r;const n=this.getBreadcrumbs(e);console.log(`${et(at.green,"[tool/start]")} [${n}] Entering Tool run with input: "${(r=e.inputs.input)==null?void 0:r.trim()}"`)}onToolEnd(e){var r,s;const n=this.getBreadcrumbs(e);console.log(`${et(at.cyan,"[tool/end]")} [${n}] [${Tn(e)}] Exiting Tool run with output: "${(s=(r=e.outputs)==null?void 0:r.output)==null?void 0:s.trim()}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.red,"[tool/error]")} [${n}] [${Tn(e)}] Tool run errored with error: ${It(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${It(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.cyan,"[retriever/end]")} [${n}] [${Tn(e)}] Exiting Retriever run with output: ${It(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${et(at.red,"[retriever/error]")} [${n}] [${Tn(e)}] Retriever run errored with error: ${It(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${et(at.blue,"[agent/action]")} [${r}] Agent selected action: ${It(n.actions[n.actions.length-1],"[action]")}`)}}const oS=[400,401,403,404,405,406,407,408],uS=[409];class af{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const n="default"in _n?_n.default:_n;this.queue=new n({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...n){const r=this.onFailedResponseHook;return this.queue.add(()=>Fa(()=>e(...n).catch(s=>{throw s instanceof Error?s:new Error(s)}),{async onFailedAttempt(s){if(s.message.startsWith("Cancel")||s.message.startsWith("TimeoutError")||s.message.startsWith("AbortError")||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const i=s==null?void 0:s.response,a=i==null?void 0:i.status;if(a){if(oS.includes(+a))throw s;if(uS.includes(+a))return;r&&await r(i)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((s,i)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}}function of(t){return typeof(t==null?void 0:t._getType)=="function"}function uf(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}var js={};let dn;const cS=()=>typeof window<"u"&&typeof window.document<"u",lS=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",dS=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),im=()=>typeof Deno<"u",fS=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!im(),hS=()=>dn||(cS()?dn="browser":fS()?dn="node":lS()?dn="webworker":dS()?dn="jsdom":im()?dn="deno":dn="other",dn);let du;async function pS(){if(du===void 0){const t=hS(),e=yS();du={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:am,...e}}return du}function mS(){const t=gS()||{},e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[r,s]of Object.entries(t))r.startsWith("LANGCHAIN_")&&typeof s=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[r]=s);return e}function gS(){try{return typeof process<"u"&&js?Object.entries(js).reduce((t,[e,n])=>(t[e]=String(n),t),{}):void 0}catch{return}}function nr(t){try{return typeof process<"u"?js==null?void 0:js[t]:void 0}catch{return}}let fu;function yS(){if(fu!==void 0)return fu;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=nr(n);r!==void 0&&(e[n]=r)}return fu=e,e}async function cf(t){const e=await pS(),n=mS();return t.map(r=>{const s=r.extra??{},i=s.metadata;return r.extra={...s,runtime:{...e,...s==null?void 0:s.runtime},metadata:{...n,...n.revision_id||r.revision_id?{revision_id:r.revision_id??n.revision_id}:{},...i}},r})}const _S=()=>{const t=nr("LANGCHAIN_TRACING_SAMPLING_RATE");if(t===void 0)return;const e=parseFloat(t);if(e<0||e>1)throw new Error(`LANGCHAIN_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},bS=t=>{const n=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"},kn=async(t,e)=>{const n=await t.text();if(!t.ok)throw new Error(`Failed to ${e}: ${t.status} ${t.statusText} ${n}`)};async function wS(t){const e=[];for await(const n of t)e.push(n);return e}function hu(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}function Te(t){if(!rm(t))throw new Error(`Invalid UUID: ${t}`)}const vS=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(n=>setTimeout(n,e)),!0}return!1};class ES{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]})}get size(){return this.items.length}push(e){return new Promise(n=>{this.items.push([e,n])})}pop(e){if(e<1)throw new Error("Number of items to pop off may not be less than 1.");const n=[];for(;n.length<e&&this.items.length;){const r=this.items.shift();if(r)n.push(r);else break}return[n.map(r=>r[0]),()=>n.forEach(r=>r[1]())]}}const SS=20971520;class pl{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sampledPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"batchEndpointSupported",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new ES}),Object.defineProperty(this,"pendingAutoBatchedRunLimit",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=pl.getDefaultClientConfig();this.tracingSampleRate=_S(),this.apiUrl=hu(e.apiUrl??n.apiUrl)??"",this.apiKey=hu(e.apiKey??n.apiKey),this.webUrl=hu(e.webUrl??n.webUrl),this.timeout_ms=e.timeout_ms??12e3,this.caller=new af(e.callerOptions??{}),this.batchIngestCaller=new af({...e.callerOptions??{},onFailedResponseHook:vS}),this.hideInputs=e.hideInputs??n.hideInputs,this.hideOutputs=e.hideOutputs??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.pendingAutoBatchedRunLimit=e.pendingAutoBatchedRunLimit??this.pendingAutoBatchedRunLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=nr("LANGCHAIN_API_KEY"),n=nr("LANGCHAIN_ENDPOINT")??"https://api.smith.langchain.com",r=nr("LANGCHAIN_HIDE_INPUTS")==="true",s=nr("LANGCHAIN_HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:bS(this.apiUrl)?(this.webUrl="http://localhost","http://localhost"):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com","https://dev.smith.langchain.com"):(this.webUrl="https://smith.langchain.com","https://smith.langchain.com")}get headers(){const e={"User-Agent":`langsmith-js/${am}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=(n==null?void 0:n.toString())??"",s=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(fetch,s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status} ${i.statusText}`);return i}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams){let r=Number(n.get("offset"))||0;const s=Number(n.get("limit"))||100;for(;;){n.set("offset",String(r)),n.set("limit",String(s));const i=`${this.apiUrl}${e}?${n}`,a=await this.caller.call(fetch,i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!a.ok)throw new Error(`Failed to fetch ${e}: ${a.status} ${a.statusText}`);const o=await a.json();if(o.length===0||(yield o,o.length<s))break;r+=o.length}}async*_getCursorPaginatedList(e,n=null,r="POST",s="runs"){const i=n?{...n}:{};for(;;){const o=await(await this.caller.call(fetch,`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(i)})).json();if(!o||!o[s])break;yield o[s];const u=o.cursors;if(!u||!u.next)break;i.cursor=u.next}}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const s of e)this.sampledPostUuids.has(s.id)&&(r.push(s),this.sampledPostUuids.delete(s.id));return r}else{const r=[];for(const s of e)Math.random()<this.tracingSampleRate&&(r.push(s),this.sampledPostUuids.add(s.id));return r}}async drainAutoBatchQueue(){for(;this.autoBatchQueue.size>=0;){const[e,n]=this.autoBatchQueue.pop(this.pendingAutoBatchedRunLimit);if(!e.length){n();return}try{await this.batchIngestRuns({runCreates:e.filter(r=>r.action==="create").map(r=>r.item),runUpdates:e.filter(r=>r.action==="update").map(r=>r.item)})}finally{n()}}}async processRunOperation(e,n){const r=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0;const s=this.autoBatchQueue.push(e);return(n||this.autoBatchQueue.size>this.pendingAutoBatchedRunLimit)&&await this.drainAutoBatchQueue(),this.autoBatchQueue.size>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue().catch(console.error)},r?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),s}async _getServerInfo(){const e=await fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!e.ok)throw await e.text(),new Error("Failed to retrieve server info.");return e.json()}async batchEndpointIsSupported(){try{this.serverInfo=await this._getServerInfo()}catch{return!1}return!0}async createRun(e){if(!this._filterForSampling([e]).length)return;const n={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const s=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){this.processRunOperation({action:"create",item:s}).catch(console.error);return}const i=await cf([s]),a=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:n,body:JSON.stringify(i[0]),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(a,"create run")}async batchIngestRuns({runCreates:e,runUpdates:n}){var c,l;if(e===void 0&&n===void 0)return;let r=(e==null?void 0:e.map(d=>this.prepareRunCreateOrUpdateInputs(d)))??[],s=(n==null?void 0:n.map(d=>this.prepareRunCreateOrUpdateInputs(d)))??[];if(r.length>0&&s.length>0){const d=r.reduce((h,p)=>(p.id&&(h[p.id]=p),h),{}),f=[];for(const h of s)h.id!==void 0&&d[h.id]?d[h.id]={...d[h.id],...h}:f.push(h);r=Object.values(d),s=f}const i={post:this._filterForSampling(r),patch:this._filterForSampling(s,!0)};if(!i.post.length&&!i.patch.length)return;if(r=await cf(r),this.batchEndpointSupported===void 0&&(this.batchEndpointSupported=await this.batchEndpointIsSupported()),!this.batchEndpointSupported){this.autoBatchTracing=!1;for(const d of i.post)await this.createRun(d);for(const d of i.patch)d.id!==void 0&&await this.updateRun(d.id,d);return}const a=((l=(c=this.serverInfo)==null?void 0:c.batch_ingest_config)==null?void 0:l.size_limit_bytes)??SS,o={post:[],patch:[]};let u=0;for(const d of["post","patch"]){const f=d,h=i[f].reverse();let p=h.pop();for(;p!==void 0;){const y=JSON.stringify(p);u>0&&u+y.length>a&&(await this._postBatchIngestRuns(JSON.stringify(o)),u=0,o.post=[],o.patch=[]),u+=y.length,o[f].push(p),p=h.pop()}}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(JSON.stringify(o))}async _postBatchIngestRuns(e){const n={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(fetch,`${this.apiUrl}/runs/batch`,{method:"POST",headers:n,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(r,"batch create run")}async updateRun(e,n){Te(e),n.inputs&&(n.inputs=this.processInputs(n.inputs)),n.outputs&&(n.outputs=this.processOutputs(n.outputs));const r={...n,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(n.end_time!==void 0&&r.parent_run_id===void 0){await this.processRunOperation({action:"update",item:r},!0);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const s={...this.headers,"Content-Type":"application/json"},i=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(i,"update run")}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){Te(e);let r=await this._get(`/runs/${e}`);return n&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let s;n.session_id?s=n.session_id:r!=null&&r.projectName?s=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?s=r==null?void 0:r.projectId:s=(await this.readProject({projectName:nr("LANGCHAIN_PROJECT")||"default"})).id;const i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${s}/r/${n.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const n=await wS(this.listRuns({id:e.child_run_ids})),r={},s={};n.sort((i,a)=>((i==null?void 0:i.dotted_order)??"").localeCompare((a==null?void 0:a.dotted_order)??""));for(const i of n){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),s[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(s[i].child_runs=r[i]);return e}async*listRuns(e){const{projectId:n,projectName:r,parentRunId:s,traceId:i,referenceExampleId:a,startTime:o,executionOrder:u,isRoot:c,runType:l,error:d,id:f,query:h,filter:p,traceFilter:y,treeFilter:_,limit:w,select:v}=e;let O=[];if(n&&(O=Array.isArray(n)?n:[n]),r){const B=Array.isArray(r)?r:[r],te=await Promise.all(B.map(K=>this.readProject({projectName:K}).then(z=>z.id)));O.push(...te)}const U=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],j={session:O.length?O:null,run_type:l,reference_example:a,query:h,filter:p,trace_filter:y,tree_filter:_,execution_order:u,parent_run:s,start_time:o?o.toISOString():null,error:d,id:f,limit:w,trace:i,select:v||U,is_root:c};for await(const B of this._getCursorPaginatedList("/runs/query",j))yield*B}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||Gt()};Te(e);const i=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(i===null||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){Te(e);const n=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(n,"unshare run")}async readRunSharedLink(e){Te(e);const r=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const a of n)r.append("id",a);return Te(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),Te(e);const s=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};Te(e);const i=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async unshareDataset(e){Te(e);const n=await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(n,"unshare dataset")}async readSharedDataset(e){return Te(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:s=!1,projectExtra:i=null,referenceDatasetId:a=null}){const o=s?"?upsert=true":"",u=`${this.apiUrl}/sessions${o}`,c=i||{};r&&(c.metadata=r);const l={name:e,extra:c,description:n};a!==null&&(l.reference_dataset_id=a);const d=await this.caller.call(fetch,u,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),f=await d.json();if(!d.ok)throw new Error(`Failed to create session ${e}: ${d.status} ${d.statusText}`);return f}async updateProject(e,{name:n=null,description:r=null,metadata:s=null,projectExtra:i=null,endTime:a=null}){const o=`${this.apiUrl}/sessions/${e}`;let u=i;s&&(u={...u||{},metadata:s});const c={name:n,extra:u,description:r,end_time:a?new Date(a).toISOString():null},l=await this.caller.call(fetch,o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),d=await l.json();if(!l.ok)throw new Error(`Failed to update project ${e}: ${l.status} ${l.statusText}`);return d}async hasProject({projectId:e,projectName:n}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Te(e),r+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide projectName or projectId");const i=await this.caller.call(fetch,`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const a=await i.json();return i.ok?Array.isArray(a)?a.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let s="/sessions";const i=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Te(e),s+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&i.append("include_stats",r.toString());const a=await this._get(s,i);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);o=a[0]}else o=a;return o}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:s,referenceDatasetName:i,referenceFree:a}={}){const o=new URLSearchParams;if(e!==void 0)for(const u of e)o.append("id",u);if(n!==void 0&&o.append("name",n),r!==void 0&&o.append("name_contains",r),s!==void 0)o.append("reference_dataset",s);else if(i!==void 0){const u=await this.readDataset({datasetName:i});o.append("reference_dataset",u.id)}a!==void 0&&o.append("reference_free",a.toString());for await(const u of this._getPaginated("/sessions",o))yield*u}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,Te(r);const s=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(s,`delete session ${r} (${n})`)}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:s,description:i,dataType:a,name:o}){const u=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,n),r.forEach(f=>{c.append("input_keys",f)}),s.forEach(f=>{c.append("output_keys",f)}),i&&c.append("description",i),a&&c.append("data_type",a),o&&c.append("name",o);const l=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!l.ok){const f=await l.json();throw f.detail&&f.detail.includes("already exists")?new Error(`Dataset ${n} already exists`):new Error(`Failed to upload CSV: ${l.status} ${l.statusText}`)}return await l.json()}async createDataset(e,{description:n,dataType:r}={}){const s={name:e,description:n};r&&(s.data_type=r);const i=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!i.ok){const o=await i.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${i.status} ${i.statusText}`)}return await i.json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)Te(e),r+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,s);let a;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);a=i[0]}else a=i;return a}async diffDatasetVersions({datasetId:e,datasetName:n,fromVersion:r,toVersion:s}){let i=e;if(i===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:n})).id);const a=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,a)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:s,datasetNameContains:i}={}){const a="/datasets",o=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const u of r)o.append("id",u);s!==void 0&&o.append("name",s),i!==void 0&&o.append("name_contains",i);for await(const u of this._getPaginated(a,o))yield*u}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",s=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(s=(await this.readDataset({datasetName:n})).id),s!==void 0)Te(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!i.ok)throw new Error(`Failed to delete ${r}: ${i.status} ${i.statusText}`);await i.json()}async createExample(e,n,{datasetId:r,datasetName:s,createdAt:i,exampleId:a,metadata:o}){let u=r;if(u===void 0&&s===void 0)throw new Error("Must provide either datasetName or datasetId");if(u!==void 0&&s!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");u===void 0&&(u=(await this.readDataset({datasetName:s})).id);const c=i||new Date,l={dataset_id:u,inputs:e,outputs:n,created_at:c==null?void 0:c.toISOString(),id:a,metadata:o},d=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!d.ok)throw new Error(`Failed to create example: ${d.status} ${d.statusText}`);return await d.json()}async createExamples(e){const{inputs:n,outputs:r,metadata:s,sourceRunIds:i,exampleIds:a,datasetId:o,datasetName:u}=e;let c=o;if(c===void 0&&u===void 0)throw new Error("Must provide either datasetName or datasetId");if(c!==void 0&&u!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");c===void 0&&(c=(await this.readDataset({datasetName:u})).id);const l=n.map((h,p)=>({dataset_id:c,inputs:h,outputs:r?r[p]:void 0,metadata:s?s[p]:void 0,id:a?a[p]:void 0,source_run_id:i?i[p]:void 0})),d=await this.caller.call(fetch,`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!d.ok)throw new Error(`Failed to create examples: ${d.status} ${d.statusText}`);return await d.json()}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const s=e.map(a=>of(a)?uf(a):a),i=of(n)?uf(n):n;return this.createExample({input:s},{output:i},r)}async readExample(e){Te(e);const n=`/examples/${e}`;return await this._get(n)}async*listExamples({datasetId:e,datasetName:n,exampleIds:r,asOf:s,inlineS3Urls:i}={}){let a;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)a=e;else if(n!==void 0)a=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const o=new URLSearchParams({dataset:a}),u=s?typeof s=="string"?s:s==null?void 0:s.toISOString():void 0;u&&o.append("as_of",u);const c=i??!0;if(o.append("inline_s3_urls",c.toString()),r!==void 0)for(const l of r)o.append("id",l);for await(const l of this._getPaginated("/examples",o))yield*l}async deleteExample(e){Te(e);const n=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!r.ok)throw new Error(`Failed to delete ${n}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,n){Te(e);const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:s,referenceExample:i}={loadChildRuns:!1}){let a;if(typeof e=="string")a=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)a=e;else throw new Error(`Invalid run type: ${typeof e}`);a.reference_example_id!==null&&a.reference_example_id!==void 0&&(i=await this.readExample(a.reference_example_id));const o=await n.evaluateRun(a,i);let u=r??{};o.evaluatorInfo&&(u={...u,...o.evaluatorInfo});const c=o.targetRunId??a.id;return await this.createFeedback(c,o.key,{score:o==null?void 0:o.score,value:o==null?void 0:o.value,comment:o==null?void 0:o.comment,correction:o==null?void 0:o.correction,sourceInfo:u,feedbackSourceType:"model",sourceRunId:o==null?void 0:o.sourceRunId})}async createFeedback(e,n,{score:r,value:s,correction:i,comment:a,sourceInfo:o,feedbackSourceType:u="api",sourceRunId:c,feedbackId:l,feedbackConfig:d}){var _;const f={type:u??"api",metadata:o??{}};c!==void 0&&(f==null?void 0:f.metadata)!==void 0&&!f.metadata.__run&&(f.metadata.__run={run_id:c}),(f==null?void 0:f.metadata)!==void 0&&((_=f.metadata.__run)==null?void 0:_.run_id)!==void 0&&Te(f.metadata.__run.run_id);const h={id:l??Gt(),run_id:e,key:n,score:r,value:s,correction:i,comment:a,feedback_source:f,feedbackConfig:d},p=`${this.apiUrl}/feedback`,y=await this.caller.call(fetch,p,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await kn(y,"create feedback"),h}async updateFeedback(e,{score:n,value:r,correction:s,comment:i}){const a={};n!=null&&(a.score=n),r!=null&&(a.value=r),s!=null&&(a.correction=s),i!=null&&(a.comment=i),Te(e);const o=await this.caller.call(fetch,`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await kn(o,"update feedback")}async readFeedback(e){Te(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){Te(e);const n=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!r.ok)throw new Error(`Failed to delete ${n}: ${r.status} ${r.statusText}`);await r.json()}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(e&&s.append("run",e.join(",")),n)for(const i of n)s.append("key",i);if(r)for(const i of r)s.append("source",i);for await(const i of this._getPaginated("/feedback",s))yield*i}async createPresignedFeedbackToken(e,n,{expiration:r,feedbackConfig:s}={}){const i={run_id:e,feedback_key:n,feedback_config:s};return r?typeof r=="string"?i.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(i.expires_in=r):i.expires_in={hours:3},await(await this.caller.call(fetch,`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){Te(e);const n=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}}const am="0.1.18";class AS extends Lo{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:n,projectName:r,client:s}=e;this.projectName=r??ut("LANGCHAIN_PROJECT")??ut("LANGCHAIN_SESSION"),this.exampleId=n,this.client=s??new pl({})}async _convertToCreate(e,n=void 0){return{...e,extra:{...e.extra,runtime:await u0()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:n}}async persistRun(e){}async onRunCreate(e){const n=await this._convertToCreate(e,this.exampleId);await this.client.createRun(n)}async onRunUpdate(e){const n={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,n)}getRun(e){return this.runMap.get(e)}}async function xS(){return new AS}let pu;function OS(){const t="default"in _n?_n.default:_n;return new t({autoStart:!0,concurrency:1})}async function ze(t,e){e===!0?await t():(typeof pu>"u"&&(pu=OS()),pu.add(t))}class PS{setHandler(e){return this.setHandlers([e])}}class Mo{constructor(e,n,r,s,i,a,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;try{await((r=n.handleText)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleText: ${s}`)}},n.awaitHandlers)))}}class RS extends Mo{getChild(e){const n=new dt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch{console.error(`Error in handler ${n.constructor.name}, handleRetriever`)}},n.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleRetrieverError: ${s}`)}},n.awaitHandlers)))}}class lf extends Mo{async handleLLMNewToken(e,n,r,s,i,a){await Promise.all(this.handlers.map(o=>ze(async()=>{var u;if(!o.ignoreLLM)try{await((u=o.handleLLMNewToken)==null?void 0:u.call(o,e,n??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a))}catch(c){console.error(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${c}`)}},o.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleLLMError: ${s}`)}},n.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleLLMEnd: ${s}`)}},n.awaitHandlers)))}}class CS extends Mo{getChild(e){const n=new dt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleChainError(e,n,r,s,i){await Promise.all(this.handlers.map(a=>ze(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainError)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,i))}catch(u){console.error(`Error in handler ${a.constructor.name}, handleChainError: ${u}`)}},a.awaitHandlers)))}async handleChainEnd(e,n,r,s,i){await Promise.all(this.handlers.map(a=>ze(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,i))}catch(u){console.error(`Error in handler ${a.constructor.name}, handleChainEnd: ${u}`)}},a.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentAction)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleAgentAction: ${s}`)}},n.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleAgentEnd: ${s}`)}},n.awaitHandlers)))}}class TS extends Mo{getChild(e){const n=new dt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleToolError(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleToolError: ${s}`)}},n.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(n=>ze(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${n.constructor.name}, handleToolEnd: ${s}`)}},n.awaitHandlers)))}}class dt extends PS{constructor(e,n){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(n==null?void 0:n.handlers)??this.handlers,this.inheritableHandlers=(n==null?void 0:n.inheritableHandlers)??this.inheritableHandlers,this.tags=(n==null?void 0:n.tags)??this.tags,this.inheritableTags=(n==null?void 0:n.inheritableTags)??this.inheritableTags,this.metadata=(n==null?void 0:n.metadata)??this.metadata,this.inheritableMetadata=(n==null?void 0:n.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,n,r=void 0,s=void 0,i=void 0,a=void 0,o=void 0,u=void 0){return Promise.all(n.map(async(c,l)=>{const d=l===0&&r?r:Gt();return await Promise.all(this.handlers.map(f=>ze(async()=>{var h;if(!f.ignoreLLM)try{await((h=f.handleLLMStart)==null?void 0:h.call(f,e,[c],d,this._parentRunId,i,this.tags,this.metadata,u))}catch(p){console.error(`Error in handler ${f.constructor.name}, handleLLMStart: ${p}`)}},f.awaitHandlers))),new lf(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,n,r=void 0,s=void 0,i=void 0,a=void 0,o=void 0,u=void 0){return Promise.all(n.map(async(c,l)=>{const d=l===0&&r?r:Gt();return await Promise.all(this.handlers.map(f=>ze(async()=>{var h,p;if(!f.ignoreLLM)try{if(f.handleChatModelStart)await((h=f.handleChatModelStart)==null?void 0:h.call(f,e,[c],d,this._parentRunId,i,this.tags,this.metadata,u));else if(f.handleLLMStart){const y=pp(c);await((p=f.handleLLMStart)==null?void 0:p.call(f,e,[y],d,this._parentRunId,i,this.tags,this.metadata,u))}}catch(y){console.error(`Error in handler ${f.constructor.name}, handleLLMStart: ${y}`)}},f.awaitHandlers))),new lf(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,n,r=Gt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>ze(async()=>{var c;if(!u.ignoreChain)try{await((c=u.handleChainStart)==null?void 0:c.call(u,e,n,r,this._parentRunId,this.tags,this.metadata,s,o))}catch(l){console.error(`Error in handler ${u.constructor.name}, handleChainStart: ${l}`)}},u.awaitHandlers))),new CS(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,n,r=Gt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>ze(async()=>{var c;if(!u.ignoreAgent)try{await((c=u.handleToolStart)==null?void 0:c.call(u,e,n,r,this._parentRunId,this.tags,this.metadata,o))}catch(l){console.error(`Error in handler ${u.constructor.name}, handleToolStart: ${l}`)}},u.awaitHandlers))),new TS(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,n,r=Gt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>ze(async()=>{var c;if(!u.ignoreRetriever)try{await((c=u.handleRetrieverStart)==null?void 0:c.call(u,e,n,r,this._parentRunId,this.tags,this.metadata,o))}catch(l){console.error(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${l}`)}},u.awaitHandlers))),new RS(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,n=!0){this.handlers.push(e),n&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(n=>n!==e),this.inheritableHandlers=this.inheritableHandlers.filter(n=>n!==e)}setHandlers(e,n=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,n)}addTags(e,n=!0){this.removeTags(e),this.tags.push(...e),n&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(n=>!e.includes(n)),this.inheritableTags=this.inheritableTags.filter(n=>!e.includes(n))}addMetadata(e,n=!0){this.metadata={...this.metadata,...e},n&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const n of Object.keys(e))delete this.metadata[n],delete this.inheritableMetadata[n]}copy(e=[],n=!0){const r=new dt(this._parentRunId);for(const s of this.handlers){const i=this.inheritableHandlers.includes(s);r.addHandler(s,i)}for(const s of this.tags){const i=this.inheritableTags.includes(s);r.addTags([s],i)}for(const s of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},i)}for(const s of e)r.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===s.name)||r.addHandler(s,n);return r}static fromHandlers(e){class n extends wi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Gt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new n),r}static async configure(e,n,r,s,i,a,o){let u;(e||n)&&(Array.isArray(e)||!e?(u=new dt,u.setHandlers((e==null?void 0:e.map(Ga))??[],!0)):u=e,u=u.copy(Array.isArray(n)?n.map(Ga):n==null?void 0:n.handlers,!1));const c=ut("LANGCHAIN_VERBOSE")==="true"||(o==null?void 0:o.verbose),l=ut("LANGCHAIN_TRACING_V2")==="true",d=l||(ut("LANGCHAIN_TRACING")??!1);if(c||d){if(u||(u=new dt),c&&!u.handlers.some(f=>f.name===sf.prototype.name)){const f=new sf;u.addHandler(f,!0)}d&&!u.handlers.some(f=>f.name==="langchain_tracer")&&l&&u.addHandler(await xS(),!0)}return(r||s)&&u&&(u.addTags(r??[]),u.addTags(s??[],!1)),(i||a)&&u&&(u.addMetadata(i??{}),u.addMetadata(a??{},!1)),u}}function Ga(t){return"name"in t?t:wi.fromMethods(t)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const kS=Object.prototype.hasOwnProperty;function nc(t,e){return kS.call(t,e)}function rc(t){if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(t);let e=[];for(let n in t)nc(t,n)&&e.push(n);return e}function tn(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function sc(t){let e=0;const n=t.length;let r;for(;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Pr(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function IS(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function ic(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(ic(t[n]))return!0}else if(typeof t=="object"){const n=rc(t),r=n.length;for(var e=0;e<r;e++)if(ic(t[n[e]]))return!0}}return!1}function df(t,e){const n=[t];for(const r in e){const s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&n.push(`${r}: ${s}`)}return n.join(`
`)}class NS extends Error{constructor(e,n,r,s,i){super(df(e,{name:n,index:r,operation:s,tree:i})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.setPrototypeOf(this,new.target.prototype),this.message=df(e,{name:n,index:r,operation:s,tree:i})}}const $e=NS,jr={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){let r=ac(n,this.path);r&&(r=tn(r));const s=Ls(n,{op:"remove",path:this.from}).removed;return Ls(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(t,e,n){const r=ac(n,this.from);return Ls(n,{op:"add",path:this.path,value:tn(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Ya(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}};var $S={add:function(t,e,n){return sc(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:jr.move,copy:jr.copy,test:jr.test,_get:jr._get};function ac(t,e){if(e=="")return t;var n={op:"_get",path:e};return Ls(t,n),n.value}function Ls(t,e,n=!1,r=!0,s=!0,i=0){if(n&&(typeof n=="function"?n(e,0,t,e.path):oc(e,0)),e.path===""){let a={newDocument:t};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=t,a;if(e.op==="move"||e.op==="copy")return a.newDocument=ac(t,e.from),e.op==="move"&&(a.removed=t),a;if(e.op==="test"){if(a.test=Ya(t,e.value),a.test===!1)throw new $e("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return a.newDocument=t,a}else{if(e.op==="remove")return a.removed=t,a.newDocument=null,a;if(e.op==="_get")return e.value=t,a;if(n)throw new $e("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,e,t);return a}}else{r||(t=tn(t));const o=(e.path||"").split("/");let u=t,c=1,l=o.length,d,f,h;for(typeof n=="function"?h=n:h=oc;;){if(f=o[c],f&&f.indexOf("~")!=-1&&(f=IS(f)),s&&(f=="__proto__"||f=="prototype"&&c>0&&o[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(u[f]===void 0?d=o.slice(0,c).join("/"):c==l-1&&(d=e.path),d!==void 0&&h(e,0,t,d)),c++,Array.isArray(u)){if(f==="-")f=u.length;else{if(n&&!sc(f))throw new $e("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,e,t);sc(f)&&(f=~~f)}if(c>=l){if(n&&e.op==="add"&&f>u.length)throw new $e("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,e,t);const p=$S[e.op].call(e,u,f,t);if(p.test===!1)throw new $e("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return p}}else if(c>=l){const p=jr[e.op].call(e,u,f,t);if(p.test===!1)throw new $e("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return p}if(u=u[f],n&&c<l&&(!u||typeof u!="object"))throw new $e("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,e,t)}}}function Xa(t,e,n,r=!0,s=!0){if(n&&!Array.isArray(e))throw new $e("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=tn(t));const i=new Array(e.length);for(let a=0,o=e.length;a<o;a++)i[a]=Ls(t,e[a],n,!0,s,a),t=i[a].newDocument;return i.newDocument=t,i}function oc(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new $e("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(jr[t.op]){if(typeof t.path!="string")throw new $e("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new $e('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new $e("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new $e("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&ic(t.value))throw new $e("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var s=t.path.split("/").length,i=r.split("/").length;if(s!==i+1&&s!==i)throw new $e("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new $e("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var a={op:"_get",path:t.from,value:void 0},o=jS([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new $e("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new $e("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function jS(t,e,n){try{if(!Array.isArray(t))throw new $e("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Xa(tn(e),tn(t),n||!0);else{n=n||oc;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(s){if(s instanceof $e)return s;throw s}}function Ya(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),s,i,a;if(n&&r){if(i=t.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!Ya(t[s],e[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(t);if(i=o.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!e.hasOwnProperty(o[s]))return!1;for(s=i;s--!==0;)if(a=o[s],!Ya(t[a],e[a]))return!1;return!0}return t!==t&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function om(t,e,n,r,s){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var i=rc(e),a=rc(t),o=!1,u=a.length-1;u>=0;u--){var c=a[u],l=t[c];if(nc(e,c)&&!(e[c]===void 0&&l!==void 0&&Array.isArray(e)===!1)){var d=e[c];typeof l=="object"&&l!=null&&typeof d=="object"&&d!=null&&Array.isArray(l)===Array.isArray(d)?om(l,d,n,r+"/"+Pr(c),s):l!==d&&(s&&n.push({op:"test",path:r+"/"+Pr(c),value:tn(l)}),n.push({op:"replace",path:r+"/"+Pr(c),value:tn(d)}))}else Array.isArray(t)===Array.isArray(e)?(s&&n.push({op:"test",path:r+"/"+Pr(c),value:tn(l)}),n.push({op:"remove",path:r+"/"+Pr(c)}),o=!0):(s&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!o&&i.length==a.length))for(var u=0;u<i.length;u++){var c=i[u];!nc(t,c)&&e[c]!==void 0&&n.push({op:"add",path:r+"/"+Pr(c),value:tn(e[c])})}}}function LS(t,e,n=!1){var r=[];return om(t,e,r,"",n),r}class vn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw e}[Symbol.asyncIterator](){return this}static fromReadableStream(e){const n=e.getReader();return new vn({start(r){return s();function s(){return n.read().then(({done:i,value:a})=>{if(i){r.close();return}return r.enqueue(a),s()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(e){return new vn({async pull(n){const{value:r,done:s}=await e.next();s&&n.close(),n.enqueue(r)},async cancel(n){await e.return(n)}})}}function um(t,e=2){const n=Array.from({length:e},()=>[]);return n.map(async function*(s){for(;;)if(s.length===0){const i=await t.next();for(const a of n)a.push(i)}else{if(s[0].done)return;yield s.shift().value}})}function fr(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const n={...t};for(const[r,s]of Object.entries(e))r in n&&!Array.isArray(n[r])?n[r]=fr(n[r],s):n[r]=s;return n}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class os{constructor(e,n){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e,this.setup=new Promise((r,s)=>{this.firstResult=e.next(),n?this.firstResult.then(n).then(r,s):this.firstResult.then(i=>r(void 0),s)})}async next(...e){return this.firstResultUsed?this.generator.next(...e):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}}async function MS(t,e,n,...r){const s=new os(e,n),i=await s.setup;return{output:t(s,i,...r),setup:i}}class Mn{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const n=this.ops.concat(e.ops),r=Xa({},n);return new oi({ops:n,state:r[r.length-1].newDocument})}}class oi extends Mn{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const n=this.ops.concat(e.ops),r=Xa(this.state,e.ops);return new oi({ops:n,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const n=Xa({},e.ops);return new oi({ops:e.ops,state:n[n.length-1].newDocument})}}async function ff(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=t;if(["retriever","llm","prompt"].includes(t.run_type))return n;if(!(Object.keys(n).length===1&&(n==null?void 0:n.input)===""))return n.input}async function hf(t,e){const{outputs:n}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?n:n!==void 0&&Object.keys(n).length===1&&(n==null?void 0:n.output)!==void 0?n.output:n}function DS(t){return t!==void 0&&t.message!==void 0}class pf extends Lo{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=vn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||n.find(s=>{var i;return(i=this.includeTags)==null?void 0:i.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&n.every(s=>{var i;return!((i=this.excludeTags)!=null&&i.includes(s))})),r}async*tapOutputIterable(e,n){for await(const r of n){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new Mn({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var s;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Mn({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const n=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=n===1?e.name:`${e.name}:${n}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await ff(e,this._schemaFormat)),await this.writer.write(new Mn({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const n=this.keyMapByRunId[e.id];if(n===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${n}/inputs`,value:await ff(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${n}/final_output`,value:await hf(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${n}/end_time`,value:new Date(e.end_time).toISOString()});const s=new Mn({ops:r});await this.writer.write(s)}finally{if(e.id===this.rootId){const n=new Mn({ops:[{op:"replace",path:"/final_output",value:await hf(e,this._schemaFormat)}]});await this.writer.write(n),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,n,r){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const i=e.inputs.messages!==void 0;let a;i?DS(r==null?void 0:r.chunk)?a=r==null?void 0:r.chunk:a=new mi(n):a=n;const o=new Mn({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:n},{op:"add",path:`/logs/${s}/streamed_output/-`,value:a}]});await this.writer.write(o)}}class FS{getStore(){}run(e,n){n()}}class BS{constructor(){Object.defineProperty(this,"asyncLocalStorage",{enumerable:!0,configurable:!0,writable:!0,value:new FS}),Object.defineProperty(this,"hasBeenInitialized",{enumerable:!0,configurable:!0,writable:!0,value:!1})}getInstance(){return this.asyncLocalStorage}initializeGlobalInstance(e){this.hasBeenInitialized||(this.hasBeenInitialized=!0,this.asyncLocalStorage=e)}}const uc=new BS,mu=25;async function hr(t){return dt.configure(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function mf(...t){const e={};for(const n of t.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")e[r]={...e[r],...n[r]};else if(r==="tags"){const s=e[r]??[];e[r]=[...new Set(s.concat(n[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...n[r]};else if(r==="callbacks"){const s=e.callbacks,i=n.callbacks;if(Array.isArray(i))if(!s)e.callbacks=i;else if(Array.isArray(s))e.callbacks=s.concat(i);else{const a=s.copy();for(const o of i)a.addHandler(Ga(o),!0);e.callbacks=a}else if(i)if(!s)e.callbacks=i;else if(Array.isArray(s)){const a=i.copy();for(const o of s)a.addHandler(Ga(o),!0);e.callbacks=a}else e.callbacks=new dt(i._parentRunId,{handlers:s.handlers.concat(i.handlers),inheritableHandlers:s.inheritableHandlers.concat(i.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(i.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(i.inheritableTags))),metadata:{...s.metadata,...i.metadata}})}else{const s=r;e[s]=n[s]??e[s]}return e}const US=new Set(["string","number","boolean"]);function ke(t){var r;const e=t??uc.getInstance().getStore();let n={tags:[],metadata:{},callbacks:void 0,recursionLimit:25,runId:void 0};if(e&&(n={...n,...e}),e!=null&&e.configurable)for(const s of Object.keys(e.configurable))US.has(typeof e.configurable[s])&&!((r=n.metadata)!=null&&r[s])&&(n.metadata||(n.metadata={}),n.metadata[s]=e.configurable[s]);return n}function ct(t={},{callbacks:e,maxConcurrency:n,recursionLimit:r,runName:s,configurable:i,runId:a}={}){const o=ke(t);return e!==void 0&&(delete o.runName,o.callbacks=e),r!==void 0&&(o.recursionLimit=r),n!==void 0&&(o.maxConcurrency=n),s!==void 0&&(o.runName=s),i!==void 0&&(o.configurable={...o.configurable,...i}),a!==void 0&&delete o.runId,o}class cm extends Lo{constructor({config:e,onStart:n,onEnd:r,onError:s}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=n,this.argOnEnd=r,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&(this.argOnStart.length===1?await this.argOnStart(e):this.argOnStart.length===2&&await this.argOnStart(e,this.config)))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&(this.argOnError.length===1?await this.argOnError(e):this.argOnError.length===2&&await this.argOnError(e,this.config)):this.argOnEnd&&(this.argOnEnd.length===1?await this.argOnEnd(e):this.argOnEnd.length===2&&await this.argOnEnd(e,this.config)))}}function lm(t){return t?t.lc_runnable:!1}class qS{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,n){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const s=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(n)),this.includeTags!==void 0&&(r=r||s.some(i=>{var a;return(a=this.includeTags)==null?void 0:a.includes(i)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(n)),this.excludeTags!==void 0&&(r=r&&s.every(i=>{var a;return!((a=this.excludeTags)!=null&&a.includes(i))})),r}}function dm(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function we(t,e,n,r,s){t[e]=n,dm(t,e,r,s)}const HS=Symbol("Let zodToJsonSchema decide on which parser to use"),gf={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",emailStrategy:"format:email"},zS=t=>typeof t=="string"?{...gf,name:t}:{...gf,...t};function VS(){return{}}function ZS(t,e){var r,s;const n={type:"array"};return((s=(r=t.type)==null?void 0:r._def)==null?void 0:s.typeName)!==R.ZodAny&&(n.items=fe(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&we(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&we(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(we(n,"minItems",t.exactLength.value,t.exactLength.message,e),we(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function WS(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?we(n,"minimum",r.value,r.message,e):we(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),we(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?we(n,"maximum",r.value,r.message,e):we(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),we(n,"maximum",r.value,r.message,e));break;case"multipleOf":we(n,"multipleOf",r.value,r.message,e);break}return n}function JS(){return{type:"boolean"}}function KS(t,e){return fe(t.type._def,e)}const GS=(t,e)=>fe(t.innerType._def,e);function fm(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>fm(t,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return XS(t,e)}}const XS=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":we(n,"minimum",r.value,r.message,e);break;case"max":we(n,"maximum",r.value,r.message,e);break}return n};function YS(t,e){return{...fe(t.innerType._def,e),default:t.defaultValue()}}function QS(t,e){return e.effectStrategy==="input"?fe(t.schema._def,e):{}}function eA(t){return{type:"string",enum:t.values}}const tA=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function nA(t,e){const n=[fe(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),fe(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(tA(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...u}=i;a=u}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function rA(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}const hs={cuid:"^[cC][^\\s-]{8,}$",cuid2:"^[a-z][a-z0-9]*$",ulid:"^[0-9A-HJKMNP-TV-Z]{26}$",email:"^(?!\\.)(?!.*\\.\\.)([a-zA-Z0-9_+-\\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\\-]*\\.)+[a-zA-Z]{2,}$",emoji:"^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",uuid:"^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$",ipv4:"^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$",ipv6:"^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$"};function hm(t,e){const n={type:"string"};function r(s){return e.patternStrategy==="escape"?sA(s):s}if(t.checks)for(const s of t.checks)switch(s.kind){case"min":we(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e);break;case"max":we(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Qn(n,"email",s.message,e);break;case"format:idn-email":Qn(n,"idn-email",s.message,e);break;case"pattern:zod":fn(n,hs.email,s.message,e);break}break;case"url":Qn(n,"uri",s.message,e);break;case"uuid":Qn(n,"uuid",s.message,e);break;case"regex":fn(n,s.regex.source,s.message,e);break;case"cuid":fn(n,hs.cuid,s.message,e);break;case"cuid2":fn(n,hs.cuid2,s.message,e);break;case"startsWith":fn(n,"^"+r(s.value),s.message,e);break;case"endsWith":fn(n,r(s.value)+"$",s.message,e);break;case"datetime":Qn(n,"date-time",s.message,e);break;case"length":we(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e),we(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"includes":{fn(n,r(s.value),s.message,e);break}case"ip":{s.version!=="v6"&&Qn(n,"ipv4",s.message,e),s.version!=="v4"&&Qn(n,"ipv6",s.message,e);break}case"emoji":fn(n,hs.emoji,s.message,e);break;case"ulid":{fn(n,hs.ulid,s.message,e);break}}return n}const sA=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Qn=(t,e,n,r)=>{var s;t.format||(s=t.anyOf)!=null&&s.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):we(t,"format",e,n,r)},fn=(t,e,n,r)=>{var s;t.pattern||(s=t.allOf)!=null&&s.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:e,...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):we(t,"pattern",e,n,r)};function pm(t,e){var r,s,i,a;if(e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===R.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((o,u)=>({...o,[u]:fe(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:fe(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(((s=t.keyType)==null?void 0:s._def.typeName)===R.ZodString&&((i=t.keyType._def.checks)!=null&&i.length)){const o=Object.entries(hm(t.keyType._def,e)).reduce((u,[c,l])=>c==="type"?u:{...u,[c]:l},{});return{...n,propertyNames:o}}else if(((a=t.keyType)==null?void 0:a._def.typeName)===R.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};return n}function iA(t,e){if(e.mapStrategy==="record")return pm(t,e);const n=fe(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=fe(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function aA(t){const e=t.values,r=Object.keys(t.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function oA(){return{not:{}}}function uA(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Qa={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function cA(t,e){if(e.target==="openApi3")return yf(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Qa&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=Qa[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return yf(t,e)}const yf=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,s)=>fe(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function lA(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Qa[t.innerType._def.typeName],nullable:!0}:{type:[Qa[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=fe(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=fe(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function dA(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",dm(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?we(n,"minimum",r.value,r.message,e):we(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),we(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?we(n,"maximum",r.value,r.message,e):we(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),we(n,"maximum",r.value,r.message,e));break;case"multipleOf":we(n,"multipleOf",r.value,r.message,e);break}return n}function fA(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":fe(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":fe(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function hA(t,e){const n={type:"object",...Object.entries(t.shape()).reduce((r,[s,i])=>{if(i===void 0||i._def===void 0)return r;const a=fe(i._def,{...e,currentPath:[...e.currentPath,"properties",s],propertyPath:[...e.currentPath,"properties",s]});return a===void 0?r:{properties:{...r.properties,[s]:a},required:i.isOptional()?r.required:[...r.required,s]}},{properties:{},required:[]}),additionalProperties:fA(t,e)};return n.required.length||delete n.required,n}const pA=(t,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return fe(t.innerType._def,e);const n=fe(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},mA=(t,e)=>{if(e.pipeStrategy==="input")return fe(t.in._def,e);if(e.pipeStrategy==="output")return fe(t.out._def,e);const n=fe(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=fe(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function gA(t,e){return fe(t.type._def,e)}function yA(t,e){const r={type:"array",uniqueItems:!0,items:fe(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&we(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&we(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function _A(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>fe(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:fe(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>fe(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function bA(){return{not:{}}}function wA(){return{}}const vA=(t,e)=>fe(t.innerType._def,e);function fe(t,e,n=!1){var a;const r=e.seen.get(t);if(e.override){const o=(a=e.override)==null?void 0:a.call(e,t,e,r,n);if(o!==HS)return o}if(r&&!n){const o=EA(r,e);if(o!==void 0)return o}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const i=AA(t,t.typeName,e);return i&&xA(t,e,i),s.jsonSchema=i,i}const EA=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:SA(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},SA=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},AA=(t,e,n)=>{switch(e){case R.ZodString:return hm(t,n);case R.ZodNumber:return dA(t,n);case R.ZodObject:return hA(t,n);case R.ZodBigInt:return WS(t,n);case R.ZodBoolean:return JS();case R.ZodDate:return fm(t,n);case R.ZodUndefined:return bA();case R.ZodNull:return uA(n);case R.ZodArray:return ZS(t,n);case R.ZodUnion:case R.ZodDiscriminatedUnion:return cA(t,n);case R.ZodIntersection:return nA(t,n);case R.ZodTuple:return _A(t,n);case R.ZodRecord:return pm(t,n);case R.ZodLiteral:return rA(t,n);case R.ZodEnum:return eA(t);case R.ZodNativeEnum:return aA(t);case R.ZodNullable:return lA(t,n);case R.ZodOptional:return pA(t,n);case R.ZodMap:return iA(t,n);case R.ZodSet:return yA(t,n);case R.ZodLazy:return fe(t.getter()._def,n);case R.ZodPromise:return gA(t,n);case R.ZodNaN:case R.ZodNever:return oA();case R.ZodEffects:return QS(t,n);case R.ZodAny:return VS();case R.ZodUnknown:return wA();case R.ZodDefault:return YS(t,n);case R.ZodBranded:return KS(t,n);case R.ZodReadonly:return vA(t,n);case R.ZodCatch:return GS(t,n);case R.ZodPipeline:return mA(t,n);case R.ZodFunction:case R.ZodVoid:case R.ZodSymbol:return;default:return(r=>{})()}},xA=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),OA=t=>{const e=zS(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}},Do=(t,e)=>{const n=OA(e),r=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((o,[u,c])=>({...o,[u]:fe(c._def,{...n,currentPath:[...n.basePath,n.definitionPath,u]},!0)??{}}),{}):void 0,s=typeof e=="string"?e:e==null?void 0:e.name,i=fe(t._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),a};function PA(t){return lm(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...Do(t.data.schema),title:t.data.name}}}class mm{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})}toJSON(){const e={};return Object.values(this.nodes).forEach((n,r)=>{e[n.id]=rm(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:e[n.id],...PA(n)})),edges:this.edges.map(n=>n.data?{source:e[n.source],target:e[n.target],data:n.data}:{source:e[n.source],target:e[n.target]})}}addNode(e,n){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const r=n||Gt(),s={id:r,data:e};return this.nodes[r]=s,s}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(n=>n.source!==e.id&&n.target!==e.id)}addEdge(e,n,r){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const s={source:e.id,target:n.id,data:r};return this.edges.push(s),s}firstNode(){const e=new Set(this.edges.map(r=>r.target)),n=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||n.push(r)}),n[0]}lastNode(){const e=new Set(this.edges.map(r=>r.source)),n=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||n.push(r)}),n[0]}extend(e){Object.entries(e.nodes).forEach(([n,r])=>{this.nodes[n]=r}),this.edges=[...this.edges,...e.edges]}trimFirstNode(){const e=this.firstNode();if(e){const n=this.edges.filter(r=>r.source===e.id);(Object.keys(this.nodes).length===1||n.length===1)&&this.removeNode(e)}}trimLastNode(){const e=this.lastNode();if(e){const n=this.edges.filter(r=>r.target===e.id);(Object.keys(this.nodes).length===1||n.length===1)&&this.removeNode(e)}}}function Ge(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class Ye extends mr{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const n=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${n}${e}`:n}bind(e){return new Jr({bound:this,kwargs:e,config:{}})}map(){return new eo({bound:this})}withRetry(e){return new RA({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Jr({bound:this,config:e,kwargs:{}})}withFallbacks(e){return new CA({runnable:this,fallbacks:e.fallbacks})}_getOptionsList(e,n=0){if(Array.isArray(e)&&e.length!==n)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${n} inputs`);if(Array.isArray(e))return e.map(ke);if(n>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:n},(s,i)=>ke(i===0?e:r))}return Array.from({length:n},()=>ke(e))}async batch(e,n,r){var u;const s=this._getOptionsList(n??{},e.length),i=((u=s[0])==null?void 0:u.maxConcurrency)??(r==null?void 0:r.maxConcurrency),a=new fl({maxConcurrency:i,onFailedAttempt:c=>{throw c}}),o=e.map((c,l)=>a.call(async()=>{try{return await this.invoke(c,s[l])}catch(d){if(r!=null&&r.returnExceptions)return d;throw d}}));return Promise.all(o)}async*_streamIterator(e,n){yield this.invoke(e,n)}async stream(e,n){const r=new os(this._streamIterator(e,ke(n)));return await r.setup,vn.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let n;e===void 0?n=ke(e):n=ke({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,[n,r]}async _callWithConfig(e,n,r){const s=ke(r),i=await hr(s),a=await(i==null?void 0:i.handleChainStart(this.toJSON(),Ge(n,"input"),s.runId,s==null?void 0:s.runType,void 0,void 0,(s==null?void 0:s.runName)??this.getName()));delete s.runId;let o;try{o=await e.call(this,n,s,a)}catch(u){throw await(a==null?void 0:a.handleChainError(u)),u}return await(a==null?void 0:a.handleChainEnd(Ge(o,"output"))),o}async _batchWithConfig(e,n,r,s){const i=this._getOptionsList(r??{},n.length),a=await Promise.all(i.map(hr)),o=await Promise.all(a.map(async(c,l)=>{const d=await(c==null?void 0:c.handleChainStart(this.toJSON(),Ge(n[l],"input"),i[l].runId,i[l].runType,void 0,void 0,i[l].runName??this.getName()));return delete i[l].runId,d}));let u;try{u=await e.call(this,n,i,o,s)}catch(c){throw await Promise.all(o.map(l=>l==null?void 0:l.handleChainError(c))),c}return await Promise.all(o.map(c=>c==null?void 0:c.handleChainEnd(Ge(u,"output")))),u}async*_transformStreamWithConfig(e,n,r){let s,i=!0,a,o=!0;const u=ke(r),c=await hr(u);async function*l(){for await(const f of e){if(i)if(s===void 0)s=f;else try{s=fr(s,f)}catch{s=void 0,i=!1}yield f}}let d;try{const f=await MS(n.bind(this),l(),async()=>c==null?void 0:c.handleChainStart(this.toJSON(),{input:""},u.runId,u.runType,void 0,void 0,u.runName??this.getName()),u);delete u.runId,d=f.setup;const h=_=>_.name==="log_stream_tracer",p=d==null?void 0:d.handlers.find(h);let y=f.output;p!==void 0&&d!==void 0&&(y=await p.tapOutputIterable(d.runId,f.output));for await(const _ of y)if(yield _,o)if(a===void 0)a=_;else try{a=fr(a,_)}catch{a=void 0,o=!1}}catch(f){throw await(d==null?void 0:d.handleChainError(f,void 0,void 0,void 0,{inputs:Ge(s,"input")})),f}await(d==null?void 0:d.handleChainEnd(a??{},void 0,void 0,void 0,{inputs:Ge(s,"input")}))}getGraph(e){const n=new mm,r=n.addNode({name:`${this.getName()}Input`,schema:Ka.any()}),s=n.addNode(this),i=n.addNode({name:`${this.getName()}Output`,schema:Ka.any()});return n.addEdge(r,s),n.addEdge(s,i),n}pipe(e){return new ar({first:this,last:or(e)})}pick(e){return this.pipe(new TA(e))}assign(e){return this.pipe(new gm(new us({steps:e})))}async*transform(e,n){let r;for await(const s of e)r===void 0?r=s:r=fr(r,s);yield*this._streamIterator(r,ke(n))}async*streamLog(e,n,r){const s=new pf({...r,autoClose:!1,_schemaFormat:"original"}),i=ke(n);yield*this._streamLog(e,s,i)}async*_streamLog(e,n,r){const{callbacks:s}=r;if(s===void 0)r.callbacks=[n];else if(Array.isArray(s))r.callbacks=s.concat([n]);else{const u=s.copy();u.inheritableHandlers.push(n),r.callbacks=u}const i=this.stream(e,r);async function a(){try{const u=await i;for await(const c of u){const l=new Mn({ops:[{op:"add",path:"/streamed_output/-",value:c}]});await n.writer.write(l)}}finally{await n.writer.close()}}const o=a();try{for await(const u of n)yield u}finally{await o}}async*streamEvents(e,n,r){if(n.version!=="v1")throw new Error('Only version "v1" of the events schema is currently supported.');let s,i=!1;const a=ke(n),o=a.tags??[],u=a.metadata??{},c=a.runName??this.getName(),l=new pf({...r,autoClose:!1,_schemaFormat:"streaming_events"}),d=new qS({...r}),f=this._streamLog(e,l,a);for await(const p of f){if(s?s=s.concat(p):s=oi.fromRunLogPatch(p),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!i){i=!0;const v={...s.state},O={run_id:v.id,event:`on_${v.type}_start`,name:c,tags:o,metadata:u,data:{input:e}};d.includeEvent(O,v.type)&&(yield O)}const y=p.ops.filter(v=>v.path.startsWith("/logs/")).map(v=>v.path.split("/")[2]),_=[...new Set(y)];for(const v of _){let O,U={};const j=s.state.logs[v];if(j.end_time===void 0?j.streamed_output.length>0?O="stream":O="start":O="end",O==="start")j.inputs!==void 0&&(U.input=j.inputs);else if(O==="end")j.inputs!==void 0&&(U.input=j.inputs),U.output=j.final_output;else if(O==="stream"){const B=j.streamed_output.length;if(B!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${B} instead. Encountered in: "${j.name}"`);U={chunk:j.streamed_output[0]},j.streamed_output=[]}yield{event:`on_${j.type}_${O}`,name:j.name,run_id:j.id,tags:j.tags,metadata:j.metadata,data:U}}const{state:w}=s;if(w.streamed_output.length>0){const v=w.streamed_output.length;if(v!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${v} instead. Encountered in: "${w.name}"`);const O={chunk:w.streamed_output[0]};w.streamed_output=[];const U={event:`on_${w.type}_stream`,run_id:w.id,tags:o,metadata:u,name:c,data:O};d.includeEvent(U,w.type)&&(yield U)}}const h=s==null?void 0:s.state;if(h!==void 0){const p={event:`on_${h.type}_end`,name:c,run_id:h.id,tags:o,metadata:u,data:{output:h.final_output}};d.includeEvent(p,h.type)&&(yield p)}}static isRunnable(e){return lm(e)}withListeners({onStart:e,onEnd:n,onError:r}){return new Jr({bound:this,config:{},configFactories:[s=>({callbacks:[new cm({config:s,onStart:e,onEnd:n,onError:r})]})]})}}class Jr extends Ye{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const n=mf(this.config,...e);return mf(n,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(n))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,n){return this.bound.invoke(e,await this._mergeConfig(ke(n),this.kwargs))}async batch(e,n,r){const s=Array.isArray(n)?await Promise.all(n.map(async i=>this._mergeConfig(ke(i),this.kwargs))):await this._mergeConfig(ke(n),this.kwargs);return this.bound.batch(e,s,r)}async*_streamIterator(e,n){yield*this.bound._streamIterator(e,await this._mergeConfig(ke(n),this.kwargs))}async stream(e,n){return this.bound.stream(e,await this._mergeConfig(ke(n),this.kwargs))}async*transform(e,n){yield*this.bound.transform(e,await this._mergeConfig(ke(n),this.kwargs))}async*streamEvents(e,n,r){yield*this.bound.streamEvents(e,{...await this._mergeConfig(ke(n),this.kwargs),version:n.version},r)}static isRunnableBinding(e){return e.bound&&Ye.isRunnable(e.bound)}withListeners({onStart:e,onEnd:n,onError:r}){return new Jr({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new cm({config:s,onStart:e,onEnd:n,onError:r})]})]})}}class eo extends Ye{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new eo({bound:this.bound.bind(e)})}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}async _invoke(e,n,r){return this.bound.batch(e,ct(n,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:n,onError:r}){return new eo({bound:this.bound.withListeners({onStart:e,onEnd:n,onError:r})})}}class RA extends Jr{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,n,r){const s=e>1?`retry:attempt:${e}`:void 0;return ct(n,{callbacks:r==null?void 0:r.getChild(s)})}async _invoke(e,n,r){return Fa(s=>super.invoke(e,this._patchConfigForRetry(s,n,r)),{onFailedAttempt:this.onFailedAttempt,retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}async _batch(e,n,r,s){const i={};try{await Fa(async a=>{const o=e.map((f,h)=>h).filter(f=>i[f.toString()]===void 0||i[f.toString()]instanceof Error),u=o.map(f=>e[f]),c=o.map(f=>this._patchConfigForRetry(a,n==null?void 0:n[f],r==null?void 0:r[f])),l=await super.batch(u,c,{...s,returnExceptions:!0});let d;for(let f=0;f<l.length;f+=1){const h=l[f],p=o[f];h instanceof Error&&d===void 0&&(d=h),i[p.toString()]=h}if(d)throw d;return l},{onFailedAttempt:this.onFailedAttempt,retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(a){if((s==null?void 0:s.returnExceptions)!==!0)throw a}return Object.keys(i).sort((a,o)=>parseInt(a,10)-parseInt(o,10)).map(a=>i[parseInt(a,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}}class ar extends Ye{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,n){const r=ke(n),s=await hr(r),i=await(s==null?void 0:s.handleChainStart(this.toJSON(),Ge(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let a=e,o;try{const u=[this.first,...this.middle];for(let c=0;c<u.length;c+=1)a=await u[c].invoke(a,ct(r,{callbacks:i==null?void 0:i.getChild(`seq:step:${c+1}`)}));o=await this.last.invoke(a,ct(r,{callbacks:i==null?void 0:i.getChild(`seq:step:${this.steps.length}`)}))}catch(u){throw await(i==null?void 0:i.handleChainError(u)),u}return await(i==null?void 0:i.handleChainEnd(Ge(o,"output"))),o}async batch(e,n,r){const s=this._getOptionsList(n??{},e.length),i=await Promise.all(s.map(hr)),a=await Promise.all(i.map(async(u,c)=>{const l=await(u==null?void 0:u.handleChainStart(this.toJSON(),Ge(e[c],"input"),s[c].runId,void 0,void 0,void 0,s[c].runName));return delete s[c].runId,l}));let o=e;try{for(let u=0;u<this.steps.length;u+=1)o=await this.steps[u].batch(o,a.map((l,d)=>{const f=l==null?void 0:l.getChild(`seq:step:${u+1}`);return ct(s[d],{callbacks:f})}),r)}catch(u){throw await Promise.all(a.map(c=>c==null?void 0:c.handleChainError(u))),u}return await Promise.all(a.map(u=>u==null?void 0:u.handleChainEnd(Ge(o,"output")))),o}async*_streamIterator(e,n){const r=await hr(n),{runId:s,...i}=n??{},a=await(r==null?void 0:r.handleChainStart(this.toJSON(),Ge(e,"input"),s,void 0,void 0,void 0,i==null?void 0:i.runName)),o=[this.first,...this.middle,this.last];let u=!0,c;async function*l(){yield e}try{let d=o[0].transform(l(),ct(i,{callbacks:a==null?void 0:a.getChild("seq:step:1")}));for(let f=1;f<o.length;f+=1)d=await o[f].transform(d,ct(i,{callbacks:a==null?void 0:a.getChild(`seq:step:${f+1}`)}));for await(const f of d)if(yield f,u)if(c===void 0)c=f;else try{c=fr(c,f)}catch{c=void 0,u=!1}}catch(d){throw await(a==null?void 0:a.handleChainError(d)),d}await(a==null?void 0:a.handleChainEnd(Ge(c,"output")))}getGraph(e){const n=new mm;let r=null;return this.steps.forEach((s,i)=>{const a=s.getGraph(e);i!==0&&a.trimFirstNode(),i!==this.steps.length-1&&a.trimLastNode(),n.extend(a);const o=a.firstNode();if(!o)throw new Error(`Runnable ${s} has no first node`);r&&n.addEdge(r,o),r=a.lastNode()}),n}pipe(e){return ar.isRunnableSequence(e)?new ar({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new ar({first:this.first,middle:[...this.middle,this.last],last:or(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Ye.isRunnable(e)}static from([e,...n],r){return new ar({first:or(e),middle:n.slice(0,-1).map(or),last:or(n[n.length-1]),name:r})}}class us extends Ye{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[n,r]of Object.entries(e.steps))this.steps[n]=or(r)}static from(e){return new us({steps:e})}async invoke(e,n){const r=ke(n),s=await hr(r),i=await(s==null?void 0:s.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const a={};try{await Promise.all(Object.entries(this.steps).map(async([o,u])=>{a[o]=await u.invoke(e,ct(r,{callbacks:i==null?void 0:i.getChild(`map:key:${o}`)}))}))}catch(o){throw await(i==null?void 0:i.handleChainError(o)),o}return await(i==null?void 0:i.handleChainEnd(a)),a}async*_transform(e,n,r){const s={...this.steps},i=um(e,Object.keys(s).length),a=new Map(Object.entries(s).map(([o,u],c)=>{const l=u.transform(i[c],ct(r,{callbacks:n==null?void 0:n.getChild(`map:key:${o}`)}));return[o,l.next().then(d=>({key:o,gen:l,result:d}))]}));for(;a.size;){const{key:o,result:u,gen:c}=await Promise.race(a.values());a.delete(o),u.done||(yield{[o]:u.value},a.set(o,c.next().then(l=>({key:o,gen:c,result:l}))))}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=new os(this.transform(r(),n));return await s.setup,vn.fromAsyncGenerator(s)}}class ml extends Ye{static lc_name(){return"RunnableLambda"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.func=e.func}static from(e){return new ml({func:e})}async _invoke(e,n,r){return new Promise((s,i)=>{const a=ct(n,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??mu)-1});uc.getInstance().run(a,async()=>{try{let o=await this.func(e,{...a,config:a});if(o&&Ye.isRunnable(o)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");o=await o.invoke(e,{...a,recursionLimit:(a.recursionLimit??mu)-1})}s(o)}catch(o){i(o)}})})}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}async*_transform(e,n,r){let s;for await(const a of e)if(s===void 0)s=a;else try{s=fr(s,a)}catch{s=a}const i=await new Promise((a,o)=>{uc.getInstance().run(r,async()=>{try{const u=await this.func(s,{...r,config:r});a(u)}catch(u){o(u)}})});if(i&&Ye.isRunnable(i)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const a=await i.stream(s,ct(r,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??mu)-1}));for await(const o of a)yield o}else yield i}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=new os(this.transform(r(),n));return await s.setup,vn.fromAsyncGenerator(s)}}class CA extends Ye{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){const r=await dt.configure(n==null?void 0:n.callbacks,void 0,n==null?void 0:n.tags,void 0,n==null?void 0:n.metadata),{runId:s,...i}=n??{},a=await(r==null?void 0:r.handleChainStart(this.toJSON(),Ge(e,"input"),s,void 0,void 0,void 0,i==null?void 0:i.runName));let o;for(const u of this.runnables())try{const c=await u.invoke(e,ct(i,{callbacks:a==null?void 0:a.getChild()}));return await(a==null?void 0:a.handleChainEnd(Ge(c,"output"))),c}catch(c){o===void 0&&(o=c)}throw o===void 0?new Error("No error stored at end of fallback."):(await(a==null?void 0:a.handleChainError(o)),o)}async batch(e,n,r){if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(n??{},e.length),i=await Promise.all(s.map(u=>dt.configure(u==null?void 0:u.callbacks,void 0,u==null?void 0:u.tags,void 0,u==null?void 0:u.metadata))),a=await Promise.all(i.map(async(u,c)=>{const l=await(u==null?void 0:u.handleChainStart(this.toJSON(),Ge(e[c],"input"),s[c].runId,void 0,void 0,void 0,s[c].runName));return delete s[c].runId,l}));let o;for(const u of this.runnables())try{const c=await u.batch(e,a.map((l,d)=>ct(s[d],{callbacks:l==null?void 0:l.getChild()})),r);return await Promise.all(a.map((l,d)=>l==null?void 0:l.handleChainEnd(Ge(c[d],"output")))),c}catch(c){o===void 0&&(o=c)}throw o?(await Promise.all(a.map(u=>u==null?void 0:u.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function or(t){if(typeof t=="function")return new ml({func:t});if(Ye.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=or(r);return new us({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class gm extends Ye{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof us&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,n){const r=await this.mapper.invoke(e,n);return{...e,...r}}async*_transform(e,n,r){const s=this.mapper.getStepsKeys(),[i,a]=um(e),o=this.mapper.transform(a,ct(r,{callbacks:n==null?void 0:n.getChild()})),u=o.next();for await(const c of i){if(typeof c!="object"||Array.isArray(c))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof c}`);const l=Object.fromEntries(Object.entries(c).filter(([d])=>!s.includes(d)));Object.keys(l).length>0&&(yield l)}yield(await u).value;for await(const c of o)yield c}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=new os(this.transform(r(),n));return await s.setup,vn.fromAsyncGenerator(s)}}class TA extends Ye{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const n=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return n.length===0?void 0:Object.fromEntries(n)}}async invoke(e,n){return this._callWithConfig(this._pick.bind(this),e,n)}async*_transform(e){for await(const n of e){const r=await this._pick(n);r!==void 0&&(yield r)}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=new os(this.transform(r(),n));return await s.setup,vn.fromAsyncGenerator(s)}}const kA=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t,IA=()=>!1;class NA extends Ye{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??IA(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class $A extends NA{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:n,...r}){super({callbacks:e??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=cl.global():this.cache=void 0,this.caller=new fl(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let n=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await Q0("modelName"in this?kA(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(e){return typeof e=="string"?new p0(e):Array.isArray(e)?new m0(e.map(ms)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall(e){const n={...this._identifyingParams(),...e,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([i,a])=>a!==void 0).map(([i,a])=>`${i}:${JSON.stringify(a)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class rr extends $A{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptions(e){const[n,r]=super._separateRunnableConfigFromCallOptions(e);return r!=null&&r.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout)),[n,r]}async invoke(e,n){const r=rr._convertInputToPromptValue(e);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,n,r){throw new Error("Not implemented.")}async*_streamIterator(e,n){if(this._streamResponseChunks===rr.prototype._streamResponseChunks)yield this.invoke(e,n);else{const s=rr._convertInputToPromptValue(e).toChatMessages(),[i,a]=this._separateRunnableConfigFromCallOptions(n),o=await dt.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),u={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1},c=await(o==null?void 0:o.handleChatModelStart(this.toJSON(),[s],i.runId,void 0,u,void 0,void 0,i.runName));let l;try{for await(const d of this._streamResponseChunks(s,a,c==null?void 0:c[0]))d.message.response_metadata={...d.generationInfo,...d.message.response_metadata},yield d.message,l?l=l.concat(d):l=d}catch(d){throw await Promise.all((c??[]).map(f=>f==null?void 0:f.handleLLMError(d))),d}await Promise.all((c??[]).map(d=>d==null?void 0:d.handleLLMEnd({generations:[[l]]})))}}async _generateUncached(e,n,r){var f;const s=e.map(h=>h.map(ms)),i=await dt.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),a={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},o=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),s,r.runId,void 0,a,void 0,void 0,r.runName)),u=await Promise.allSettled(s.map((h,p)=>this._generate(h,{...n,promptIndex:p},o==null?void 0:o[p]))),c=[],l=[];await Promise.all(u.map(async(h,p)=>{var y,_;if(h.status==="fulfilled"){const w=h.value;for(const v of w.generations)v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};return w.generations.length===1&&(w.generations[0].message.response_metadata={...w.llmOutput,...w.generations[0].message.response_metadata}),c[p]=w.generations,l[p]=w.llmOutput,(y=o==null?void 0:o[p])==null?void 0:y.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return await((_=o==null?void 0:o[p])==null?void 0:_.handleLLMError(h.reason)),Promise.reject(h.reason)}));const d={generations:c,llmOutput:l.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...l):void 0};return Object.defineProperty(d,Qd,{value:o?{runIds:o==null?void 0:o.map(h=>h.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:e,cache:n,llmStringKey:r,parsedOptions:s,handledOptions:i}){const a=e.map(y=>y.map(ms)),o=await dt.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),u={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1,cached:!0},c=await(o==null?void 0:o.handleChatModelStart(this.toJSON(),a,i.runId,void 0,u,void 0,void 0,i.runName)),l=[],f=(await Promise.allSettled(a.map(async(y,_)=>{const w=rr._convertInputToPromptValue(y).toString(),v=await n.lookup(w,r);return v==null&&l.push(_),v}))).map((y,_)=>({result:y,runManager:c==null?void 0:c[_]})).filter(({result:y})=>y.status==="fulfilled"&&y.value!=null||y.status==="rejected"),h=[];await Promise.all(f.map(async({result:y,runManager:_},w)=>{if(y.status==="fulfilled"){const v=y.value;return h[w]=v,v.length&&await(_==null?void 0:_.handleLLMNewToken(v[0].text)),_==null?void 0:_.handleLLMEnd({generations:[v]})}else return await(_==null?void 0:_.handleLLMError(y.reason)),Promise.reject(y.reason)}));const p={generations:h,missingPromptIndices:l};return Object.defineProperty(p,Qd,{value:c?{runIds:c==null?void 0:c.map(y=>y.runId)}:void 0,configurable:!0}),p}async generate(e,n,r){let s;Array.isArray(n)?s={stop:n}:s=n;const i=e.map(h=>h.map(ms)),[a,o]=this._separateRunnableConfigFromCallOptions(s);if(a.callbacks=a.callbacks??r,!this.cache)return this._generateUncached(i,o,a);const{cache:u}=this,c=this._getSerializedCacheKeyParametersForCall(o),{generations:l,missingPromptIndices:d}=await this._generateCached({messages:i,cache:u,llmStringKey:c,parsedOptions:o,handledOptions:a});let f={};if(d.length>0){const h=await this._generateUncached(d.map(p=>i[p]),o,a);await Promise.all(h.generations.map(async(p,y)=>{const _=d[y];l[_]=p;const w=rr._convertInputToPromptValue(i[_]).toString();return u.update(w,c,p)})),f=h.llmOutput??{}}return{generations:l,llmOutput:f}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,n,r){const s=e.map(i=>i.toChatMessages());return this.generate(s,n,r)}async call(e,n,r){return(await this.generate([e.map(ms)],n,r)).generations[0][0].message}async callPrompt(e,n,r){const s=e.toChatMessages();return this.call(s,n,r)}async predictMessages(e,n,r){return this.call(e,n,r)}async predict(e,n,r){const s=new es(e),i=await this.call([s],n,r);if(typeof i.content!="string")throw new Error("Cannot use predict when output is not a string.");return i.content}}function jA(t){return{name:t.name,description:t.description,parameters:Do(t.schema)}}function _f(t){return LA(t)?{type:"function",function:jA(t)}:t}function LA(t){return t!==void 0&&Array.isArray(t.lc_namespace)}class bf extends Ye{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,n){const r=ke(n);return this.func&&await this.func(e,r),this._callWithConfig(s=>Promise.resolve(s),e,r)}async*transform(e,n){const r=ke(n);let s,i=!0;for await(const a of this._transformStreamWithConfig(e,o=>o,r))if(yield a,i)if(s===void 0)s=a;else try{s=fr(s,a)}catch{s=void 0,i=!1}this.func&&s!==void 0&&await this.func(s,r)}static assign(e){return new gm(new us({steps:e}))}}class gl extends Ye{parseResultWithPrompt(e,n,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,n){return typeof e=="string"?this._callWithConfig(async(r,s)=>this.parseResult([{text:r}],s==null?void 0:s.callbacks),e,{...n,runType:"parser"}):this._callWithConfig(async(r,s)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],s==null?void 0:s.callbacks),e,{...n,runType:"parser"})}}class ym extends gl{parseResult(e,n){return this.parse(e[0].text,n)}async parseWithPrompt(e,n,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class yl extends Error{constructor(e,n,r,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=s,s&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function cc(t,e){const n=typeof t;if(n!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(!cc(t[s],e[s]))return!1;return!0}if(n==="object"){if(!t||!e)return t===e;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const a of r)if(!cc(t[a],e[a]))return!1;return!0}return t===e}class MA extends ym{async*_transform(e){for await(const n of e)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(e,n){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...n,runType:"parser"})}}class DA extends MA{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let n,r;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let i;if(_v(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");i=new Js({message:s,text:s.content})}else if(Uc(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");i=new Js({message:Ev(s),text:s.content})}else i=new ko({text:s});r===void 0?r=i:r=r.concat(i);const a=await this.parsePartialResult([r]);a!=null&&!cc(a,n)&&(this.diff?yield this._diff(n,a):yield a,n=a)}}}class FA extends ym{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const n=Ka.object(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,Ka.string().describe(s)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Do(this.schema))}
\`\`\`
`}async parse(e){try{const n=e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim();return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new yl(`Failed to parse. Text: "${e}". Error: ${n}`,e)}}}class BA extends DA{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,n){if(n)return e?LS(e,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(e){return kd(e[0].text)}async parse(e){return kd(e,JSON.parse)}getFormatInstructions(){return""}}function _m(t,e){if(t.function===void 0)return;let n;if(e!=null&&e.partial)try{n=Fc(t.function.arguments??"{}")}catch{return}else try{n=JSON.parse(t.function.arguments)}catch(s){throw new yl([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:t.function.name,args:n};return e!=null&&e.returnId&&(r.id=t.id),r}function UA(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function qA(t,e){var n,r;return{name:(n=t.function)==null?void 0:n.name,args:(r=t.function)==null?void 0:r.arguments,id:t.id,error:e}}class HA extends gl{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}async parseResult(e){const n=e[0].message.additional_kwargs.tool_calls;if(!n)throw new Error(`No tools_call in message ${JSON.stringify(e)}`);const r=JSON.parse(JSON.stringify(n)),s=[];for(const i of r){const a=_m(i,{partial:!0});if(a!==void 0){const o={type:a.name,args:a.args,id:a.id};Object.defineProperty(o,"name",{get(){return this.type}}),Object.defineProperty(o,"arguments",{get(){return this.args}}),s.push(o)}}return s}}class wf extends gl{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"initialParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.initialParser=new HA(e),this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const n=await this.zodSchema.safeParseAsync(e);if(n.success)return n.data;throw new yl(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(e,null,2))}async parseResult(e){const r=(await this.initialParser.parseResult(e)).filter(a=>a.type===this.keyName);let s=r;return this.returnId||(s=r.map(a=>a.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(a=>this._validateResult(a)))}}function zA(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:i}=t;if(r&&s&&e)return`${s}/${e}`;if(r){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${e}`}return i}function VA(t){let e;return t.constructor.name===t0.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===n0.name?(e=new Error(t.message),e.name="AbortError"):e=t,e}function ZA(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function WA(t){const e=["namespace functions {",""];for(const n of t)n.description&&e.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(e.push(`type ${n.name} = (_: {`),e.push(bm(n.parameters,0)),e.push("}) => any;")):e.push(`type ${n.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function bm(t,e){var r;const n=[];for(const[s,i]of Object.entries(t.properties??{}))i.description&&e<2&&n.push(`// ${i.description}`),(r=t.required)!=null&&r.includes(s)?n.push(`${s}: ${to(i,e)},`):n.push(`${s}?: ${to(i,e)},`);return n.map(s=>" ".repeat(e)+s).join(`
`)}function to(t,e){if(ZA(t))return t.anyOf.map(n=>to(n,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",bm(t,e+2),"}"].join(`
`);case"array":return t.items?`${to(t.items,e)}[]`:"any[]";default:return""}}function JA(t){return t.role!=="system"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function wm(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!gi.isInstance(t))throw new Error("Invalid generic chat message");return JA(t)}default:throw new Error(`Unknown message type: ${e}`)}}function KA(t){const e=t.tool_calls;switch(t.role){case"assistant":{const n=[],r=[];for(const s of e??[])try{n.push(_m(s,{returnId:!0}))}catch(i){r.push(qA(s,i.message))}return new hp({content:t.content||"",tool_calls:n,invalid_tool_calls:r,additional_kwargs:{function_call:t.function_call,tool_calls:e}})}default:return new gi(t.content||"",t.role??"unknown")}}function GA(t,e){var i,a;const n=t.role??e,r=t.content??"";let s;if(t.function_call?s={function_call:t.function_call}:t.tool_calls?s={tool_calls:t.tool_calls}:s={},n==="user")return new Oo({content:r});if(n==="assistant"){const o=[];if(Array.isArray(t.tool_calls))for(const u of t.tool_calls)o.push({name:(i=u.function)==null?void 0:i.name,args:(a=u.function)==null?void 0:a.arguments,id:u.id,index:u.index});return new mi({content:r,tool_call_chunks:o,additional_kwargs:s})}else return n==="system"?new Po({content:r}):n==="function"?new xo({content:r,additional_kwargs:s,name:t.name}):n==="tool"?new qc({content:r,additional_kwargs:s,tool_call_id:t.tool_call_id}):new Ao({content:r,role:n})}function vf(t){return t.map(e=>{var r;const n={role:wm(e),content:e.content};return e.name!=null&&(n.name=e.name),e.additional_kwargs.function_call!=null&&(n.function_call=e.additional_kwargs.function_call),wv(e)&&((r=e.tool_calls)!=null&&r.length)?n.tool_calls=e.tool_calls.map(UA):(e.additional_kwargs.tool_calls!=null&&(n.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(n.tool_call_id=e.tool_call_id)),n})}class XA extends rr{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,n){var r,s,i,a,o,u,c,l;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??ut("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??ut("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.apiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??ut("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??ut("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??ut("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??ut("AZURE_OPENAI_BASE_PATH"),this.organization=((r=e==null?void 0:e.configuration)==null?void 0:r.organization)??ut("OPENAI_ORGANIZATION"),this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this==null?void 0:this.stop,this.user=e==null?void 0:e.user,this.streaming=(e==null?void 0:e.streaming)??!1,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??""}this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((s=e==null?void 0:e.configuration)==null?void 0:s.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((o=(a=e==null?void 0:e.configuration)==null?void 0:a.baseOptions)==null?void 0:o.headers),defaultQuery:((u=n==null?void 0:n.baseOptions)==null?void 0:u.params)??((l=(c=e==null?void 0:e.configuration)==null?void 0:c.baseOptions)==null?void 0:l.params),...n,...e==null?void 0:e.configuration}}bindTools(e,n){return this.bind({tools:e.map(_f),...n})}invocationParams(e){function n(s){return s!==void 0&&s.every(i=>Array.isArray(i.lc_namespace))}return{model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:n(e==null?void 0:e.tools)?e==null?void 0:e.tools.map(_f):e==null?void 0:e.tools,tool_choice:e==null?void 0:e.tool_choice,response_format:e==null?void 0:e.response_format,seed:e==null?void 0:e.seed,...this.modelKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,n,r){var u;const s=vf(e),i={...this.invocationParams(n),messages:s,stream:!0};let a;const o=await this.completionWithRetry(i,n);for await(const c of o){const l=c==null?void 0:c.choices[0];if(!l)continue;const{delta:d}=l;if(!d)continue;const f=GA(d,a);a=d.role??a;const h={prompt:n.promptIndex??0,completion:l.index??0};if(typeof f.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const p={...h};l.finish_reason!==void 0&&(p.finish_reason=l.finish_reason),this.logprobs&&(p.logprobs=l.logprobs);const y=new Js({message:f,text:f.content,generationInfo:p});yield y,r==null||r.handleLLMNewToken(y.text??"",h,void 0,void 0,void 0,{chunk:y})}if((u=n.signal)!=null&&u.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,n,r){var o,u;const s={},i=this.invocationParams(n),a=vf(e);if(i.stream){const c=this._streamResponseChunks(e,n,r),l={};for await(const _ of c){_.message.response_metadata={..._.generationInfo,..._.message.response_metadata};const w=((o=_.generationInfo)==null?void 0:o.completion)??0;l[w]===void 0?l[w]=_:l[w]=l[w].concat(_)}const d=Object.entries(l).sort(([_],[w])=>parseInt(_,10)-parseInt(w,10)).map(([_,w])=>w),{functions:f,function_call:h}=this.invocationParams(n),p=await this.getEstimatedTokenCountFromPrompt(e,f,h),y=await this.getNumTokensFromGenerations(d);return s.promptTokens=p,s.completionTokens=y,s.totalTokens=p+y,{generations:d,llmOutput:{estimatedTokenUsage:s}}}else{const c=await this.completionWithRetry({...i,stream:!1,messages:a},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}),{completion_tokens:l,prompt_tokens:d,total_tokens:f}=(c==null?void 0:c.usage)??{};l&&(s.completionTokens=(s.completionTokens??0)+l),d&&(s.promptTokens=(s.promptTokens??0)+d),f&&(s.totalTokens=(s.totalTokens??0)+f);const h=[];for(const p of(c==null?void 0:c.choices)??[]){const _={text:((u=p.message)==null?void 0:u.content)??"",message:KA(p.message??{role:"assistant"})};_.generationInfo={...p.finish_reason?{finish_reason:p.finish_reason}:{},...p.logprobs?{logprobs:p.logprobs}:{}},h.push(_)}return{generations:h,llmOutput:{tokenUsage:s}}}}async getEstimatedTokenCountFromPrompt(e,n,r){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(n&&r!=="auto"){const i=WA(n);s+=await this.getNumTokens(i),s+=9}return n&&e.find(i=>i._getType()==="system")&&(s-=4),r==="none"?s+=1:typeof r=="object"&&(s+=await this.getNumTokens(r.name)+4),s}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>{var s;return(s=r.message.additional_kwargs)!=null&&s.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)}))).reduce((r,s)=>r+s,0)}async getNumTokensFromMessages(e){let n=0,r=0,s=0;this.model==="gpt-3.5-turbo-0301"?(r=4,s=-1):(r=3,s=1);const i=await Promise.all(e.map(async a=>{var f,h,p,y,_,w;const o=await this.getNumTokens(a.content),u=await this.getNumTokens(wm(a)),c=a.name!==void 0?s+await this.getNumTokens(a.name):0;let l=o+r+u+c;const d=a;if(d._getType()==="function"&&(l-=2),(f=d.additional_kwargs)!=null&&f.function_call&&(l+=3),(h=d==null?void 0:d.additional_kwargs.function_call)!=null&&h.name&&(l+=await this.getNumTokens((p=d.additional_kwargs.function_call)==null?void 0:p.name)),(y=d.additional_kwargs.function_call)!=null&&y.arguments)try{l+=await this.getNumTokens(JSON.stringify(JSON.parse((_=d.additional_kwargs.function_call)==null?void 0:_.arguments)))}catch(v){console.error("Error parsing function arguments",v,JSON.stringify(d.additional_kwargs.function_call)),l+=await this.getNumTokens((w=d.additional_kwargs.function_call)==null?void 0:w.arguments)}return n+=l,l}));return n+=3,{totalCount:n,countPerMessage:i}}async completionWithRetry(e,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(s){throw VA(s)}})}_getClientOptions(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},s=zA(r),i={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};i.baseURL||delete i.baseURL,this.client=new Be(i)}const n={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,n){let r,s,i,a;YA(e)?(r=e.schema,s=e.name,i=e.method,a=e.includeRaw):(r=e,s=n==null?void 0:n.name,i=n==null?void 0:n.method,a=n==null?void 0:n.includeRaw);let o,u;if(i==="jsonMode")o=this.bind({response_format:{type:"json_object"}}),Ef(r)?u=FA.fromZodSchema(r):u=new BA;else{let f=s??"extract";if(Ef(r)){const h=Do(r);o=this.bind({tools:[{type:"function",function:{name:f,description:h.description,parameters:h}}],tool_choice:{type:"function",function:{name:f}}}),u=new wf({returnSingle:!0,keyName:f,zodSchema:r})}else{let h;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(h=r,f=r.name):(f=r.title??f,h={name:f,description:r.description??"",parameters:r}),o=this.bind({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:f}}}),u=new wf({returnSingle:!0,keyName:f})}}if(!a)return o.pipe(u);const c=bf.assign({parsed:(f,h)=>u.invoke(f.raw,h)}),l=bf.assign({parsed:()=>null}),d=c.withFallbacks({fallbacks:[l]});return ar.from([{raw:o},d])}}function Ef(t){return typeof(t==null?void 0:t.parse)=="function"}function YA(t){return t!==void 0&&typeof t.schema=="object"}class QA extends XA{static lc_name(){return"ChatTogetherAI"}_llmType(){return"togetherAI"}get lc_secrets(){return{togetherAIApiKey:"TOGETHER_AI_API_KEY",apiKey:"TOGETHER_AI_API_KEY"}}constructor(e){const n=(e==null?void 0:e.apiKey)||(e==null?void 0:e.togetherAIApiKey)||ut("TOGETHER_AI_API_KEY");if(!n)throw new Error('TogetherAI API key not found. Please set the TOGETHER_AI_API_KEY environment variable or provide the key into "togetherAIApiKey"');super({...e,model:(e==null?void 0:e.model)||"mistralai/Mixtral-8x7B-Instruct-v0.1",apiKey:n,configuration:{baseURL:"https://api.together.xyz/v1/"}}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}toJSON(){const e=super.toJSON();return"kwargs"in e&&typeof e.kwargs=="object"&&e.kwargs!=null&&(delete e.kwargs.openai_api_key,delete e.kwargs.configuration),e}async completionWithRetry(e,n){return delete e.frequency_penalty,delete e.presence_penalty,delete e.logit_bias,delete e.functions,e.stream===!0?super.completionWithRetry(e,n):super.completionWithRetry(e,n)}}const ex=En({setup(){const t=Kn(),e=t.setErrorText,n=xe(()=>t.userId),r=xe(()=>t.token),s=xe(()=>t.email),i=t.setVerificationText,a=t.removeVerificationText;return{mainDataStore:t,setErrorText:e,userId:n,token:r,email:s,setVerificationText:i,removeVerificationText:a}},data(){return{name:"",userName:"",comment:"",tagsList:go,LLM:new QA({modelName:"meta-llama/Llama-3-8b-chat-hf",apiKey:"a6300585f5f374fd31ee27db2d01ca30feb7ffa324f5950633bdce4e805ac434",maxTokens:200,temperature:0})}},created(){},methods:{async checkString(t,e){let n=await this.LLM.call([new es(t),new es(`Напиши есть ли в сообщении выше смысл на тему

     ${e}.Ответь просто "да" или "нет"

    `)]);return console.log(n.content),!n.content.includes("Да")},async sendRequest(){if(this.name.length==0)this.setErrorText("Введите название задания");else if(this.userName.length==0)this.setErrorText("Введите свое имя");else if(this.comment.length==0)this.setErrorText("Введите описание задания");else{this.setVerificationText("Идет модерация запроса");let t=this.checkString(this.comment,"ругательства или нецензурная лексика"),e=this.checkString(this.comment,"жестокость");if(!t||!e)this.setErrorText("Ваш запрос не прошел модерацию");else{let n=this.tagsList.filter(s=>s.highlighted==!0).map(s=>s.id),r=await Ee.post("https://viribusunitis.ru/api/requests",{Name:this.name,Description:this.comment,UserId:this.userId,Tags:n,Email:this.email,UserName:this.userName});console.log(r),this.$router.push({replace:!0,path:"/"})}}},selectTag(t){let e=this.tagsList.findIndex(n=>n.id===t);this.tagsList[e].highlighted!=!0?this.tagsList.splice(e,1,{id:t,name:this.tagsList[e].name,highlighted:!0}):this.tagsList.splice(e,1,{id:t,name:this.tagsList[e].name,highlighted:!1})}}}),tx=t=>(ci("data-v-e357e180"),t=t(),li(),t),nx={class:"create-response"},rx=tx(()=>Y("img",{src:So},null,-1)),sx={class:"tags-list"},ix=["onClick"];function ax(t,e,n,r,s,i){const a=Hn("router-link");return ie(),ye("div",nx,[Ve(a,{class:"backButton",to:"/"},{default:nn(()=>[rx]),_:1}),Br(Y("textarea",{class:"name",placeholder:"Название","onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o)},null,512),[[qr,t.name]]),Br(Y("textarea",{placeholder:"Имя пользователя","onUpdate:modelValue":e[1]||(e[1]=o=>t.userName=o)},null,512),[[qr,t.userName]]),Br(Y("textarea",{class:"comment",placeholder:"Подробное описание и инструкции для исполнителей","onUpdate:modelValue":e[2]||(e[2]=o=>t.comment=o)},null,512),[[qr,t.comment]]),Y("div",sx,[(ie(!0),ye(je,null,mn(t.tagsList,o=>(ie(),ye("div",{class:Kr(["tag",{selectedTag:o.highlighted==!0}]),onClick:u=>t.selectTag(o.id)},Ne(o.name),11,ix))),256))]),Y("div",{class:"requestButton",onClick:e[3]||(e[3]=(...o)=>t.sendRequest&&t.sendRequest(...o))},"Отправить просьбу")])}const ox=vr(ex,[["render",ax],["__scopeId","data-v-e357e180"]]),ux=En({setup(){const t=Kn(),e=xe(()=>t.requestsList),n=xe(()=>t.myResponsesList),r=xe(()=>t.userId);return{myResponsesList:n,mainDataStore:t,requestsList:e,userId:r}},data(){return{tagsList:go,responsesList:[{}],requestsListShow:!0}},computed:{myRequestsList(){return this.requestsList.filter(t=>t.userId==this.userId)}},methods:{setRequestsListStatus(t){this.requestsListShow=t},searchTagNameById(t){return this.tagsList.find(e=>e.id==t).name},requestDate(t){let e=t.getDate(),n=t.getMonth(),r=t.getFullYear(),s=t.getHours(),i=t.getMinutes();return s<10&&(s=`0${s}`),i<10&&(i=`0${i}`),e==new Date().getDate()&&n==new Date().getMonth()&&r==new Date().getFullYear()?`cегодня в ${s}:${i}`:(e<10&&(e=`0${e}`),n<10?n=`0${n+1}`:n=`${n+1}`,`${e}.${n}.${r} ${s}:${i}`)}}}),cx=t=>(ci("data-v-c4e34020"),t=t(),li(),t),lx=cx(()=>Y("img",{src:So},null,-1)),dx={class:"choose-block"},fx={class:"list-container"},hx={key:0,class:"request-list"},px={class:"name"},mx={class:"time"},gx={class:"tags-list"},yx={class:"tag"},_x={key:1,class:"response-list"},bx={class:"name"},wx={class:"time"},vx={class:"tags-list"},Ex={class:"tag"};function Sx(t,e,n,r,s,i){const a=Hn("router-link");return ie(),ye("div",null,[Ve(a,{class:"backButton",to:"/"},{default:nn(()=>[lx]),_:1}),Y("div",dx,[Y("div",{class:Kr({active:t.requestsListShow==!0}),onClick:e[0]||(e[0]=o=>t.setRequestsListStatus(!0))},"Мои запросы",2),Y("div",{class:Kr({active:t.requestsListShow==!1}),onClick:e[1]||(e[1]=o=>t.setRequestsListStatus(!1))},"Мои отклики",2)]),Y("div",fx,[t.requestsListShow==!0?(ie(),ye("div",hx,[(ie(!0),ye(je,null,mn(t.myRequestsList,o=>(ie(),Un(a,{class:"requestItem",to:`/myRequestsResponses/request/${o.id}`},{default:nn(()=>[Y("div",px,Ne(o.name),1),Y("div",mx,"Размещено "+Ne(t.requestDate(o.time)),1),Y("div",gx,[(ie(!0),ye(je,null,mn(o.tags,u=>(ie(),ye("div",yx,Ne(t.searchTagNameById(u)),1))),256))])]),_:2},1032,["to"]))),256))])):At("",!0),t.requestsListShow==!1?(ie(),ye("div",_x,[(ie(!0),ye(je,null,mn(t.myResponsesList,o=>(ie(),Un(a,{class:"requestItem",to:`/myRequestsResponses/response/${o.id}`},{default:nn(()=>[Y("div",bx,Ne(o.request.name),1),Y("div",wx,"Размещено "+Ne(t.requestDate(o.request.time)),1),Y("div",vx,[(ie(!0),ye(je,null,mn(o.request.tags,u=>(ie(),ye("div",Ex,Ne(t.searchTagNameById(u)),1))),256))])]),_:2},1032,["to"]))),256))])):At("",!0)])])}const Ax=vr(ux,[["render",Sx],["__scopeId","data-v-c4e34020"]]),vm=vw({history:Gb("/"),routes:[{path:"/request/:id",name:"request",component:Td,meta:{nameOfPage:"Запрос"}},{path:"/requestsList",name:"requestsList",component:Tw,meta:{nameOfPage:"Список запросов"}},{path:"/",redirect:t=>({path:"/requestsList"})},{path:"/createRequest",name:"createRequest",component:ox,meta:{nameOfPage:"Создать запрос"}},{path:"/myRequestsResponses",name:" myRequestsResponses",component:Ax,meta:{nameOfPage:"Мои ответы и запросы"}},{path:"/myRequestsResponses/request/:id",name:"myRequest",component:Td,meta:{nameOfPage:"Мой запрос"}},{path:"/myRequestsResponses/response/:id",name:"myResponse",component:av,meta:{nameOfPage:"Мой отклик"}}]});vm.beforeEach((t,e)=>{if(t.matched.length===0)return{path:"/",replace:!0};let n=Kn();t.meta.pageName,n.setNameOfPage(t.meta.nameOfPage)});const _l=qy(bb);_l.use(Zy());_l.use(vm);_l.mount("#app");
